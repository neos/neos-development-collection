========================
2.0.0-beta1 (2015-05-13)
========================

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Base Distribution
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Adjust set-dependencies script to 2.0-beta1 release
-----------------------------------------------------------------------------------------

Related: NEOS-1243

* Commit: `84a45bc <https://git.typo3.org/Neos/Distributions/Base.git/commit/84a45bc06085daa6f6beb298abd7e174bc4c748a>`_

[TASK] Depend on Flow 3.0 beta
-----------------------------------------------------------------------------------------

Related: NEOS-1243

* Commit: `57086d2 <https://git.typo3.org/Neos/Distributions/Base.git/commit/57086d23bfa23374d8759f16dacee7174421d94e>`_

[TASK] Update dependencies in composer manifest
-----------------------------------------------------------------------------------------

This adjusts the dependencies to require:

* TYPO3.Neos.Seo as ~1.0
* TYPO3.Imagine, TYPO3.Twitter.Bootstrap, TYPO3.Form, TYPO3.Setup are
  required as ~2.0

Related: NEOS-1243

* Commit: `0af2516 <https://git.typo3.org/Neos/Distributions/Base.git/commit/0af251613d8cad519e83ec2f4e1b5ab8153a6450>`_

[TASK] Adjust dependencies for the 2.0 branch
-----------------------------------------------------------------------------------------

* Commit: `1bbccfc <https://git.typo3.org/Neos/Distributions/Base.git/commit/1bbccfce5b203c9c56b6ea337c0e043b075ce80c>`_

[TASK] Update PHPUnit and vfsStream dependencies
-----------------------------------------------------------------------------------------

This updates PHPUnit from 4.5 to 4.6 and vfsStream from 1.4 to 1.5.

* Commit: `6ba1a5a <https://git.typo3.org/Neos/Distributions/Base.git/commit/6ba1a5a74b23df84344392a8feea0262022e7c56>`_

[TASK] Update composer manifest for 2.0.*@dev release
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/typo3-neos-branch/5/

* Commit: `d433a07 <https://git.typo3.org/Neos/Distributions/Base.git/commit/d433a0725777d3febe85a2d9e8e521ebc15c4724>`_

[TASK] Add @dev stability flag for FE Login package
-----------------------------------------------------------------------------------------

This change sets the ``@dev`` stability flag for the
``Flowpack.Neos.FrontendLogin`` in order to satisfy the minimum-
stability setting.

Related: NEOS-433

* Commit: `ffb65b0 <https://git.typo3.org/Neos/Distributions/Base.git/commit/ffb65b06aa9fdc6caa9f3d10fefc0f2e163b740d>`_

[BUGFIX] `composer.json` includes development versions in stable releases
-----------------------------------------------------------------------------------------

In `Idddd184af48f6d32b995e8d224a7e237aaee84bd` the requirements for
branch tip versions were introduced to easy development, however that
had a bad side effect causing the stable releases to pull unstable
versions of packages.

To fix this the release scripts are adjusted to work with dependencies
on development branch versions.

Fixes: NEOS-1216
Depends: I791174633d2b1b0fb7263504744901d87bbb1ec6

* Commit: `8bc94ce <https://git.typo3.org/Neos/Distributions/Base.git/commit/8bc94ce4f6e5cc6adb4103ea7a547ca74295c409>`_

[!!!][TASK] Move PhpCodesniffer installation to Build folder
-----------------------------------------------------------------------------------------

This change removes the development requirement to the PhpCodesniffer
and moves it to the Build folder like we do with Behat. This
prevents problems that the dependent packages need to be updated
in case of breaking changes in Flow while the packages are not even
running on Flow. This happened now by deprecating the excludeClasses
feature.

This change is marked breaking as the bin/phpcs symlink will be gone
or a dead link after upgrading. To fix this the following commands
have to be executed::

  rm -rf bin/phpcs
  cd Build/PhpCodesniffer/
  composer install

Related: FLOW-103

* Commit: `77edb95 <https://git.typo3.org/Neos/Distributions/Base.git/commit/77edb957980bc68ea9c64e3f5a049bf019286887>`_

[!!!][TASK] Pull in stable versions of 3rd party dependencies
-----------------------------------------------------------------------------------------

This change removes the minimum-stability setting in the manifest and
instead sets the @dev stability flag on our own packages. This makes
sure only stable releases of 3rd party dependencies are pulled in.

This change is breaking as the Doctrine.Instantiator package will now
have different casing the name. For this reason the
Configuration/PackageState.php will have to be deleted manually.

* Commit: `3010024 <https://git.typo3.org/Neos/Distributions/Base.git/commit/30100249f6b95354861647267cd04edfc3844c6f>`_

[TASK] Update PHPUnit requirement to 4.5.*
-----------------------------------------------------------------------------------------

Updates PHPUnit to version 4.5.*

* Commit: `f6f6b5f <https://git.typo3.org/Neos/Distributions/Base.git/commit/f6f6b5faf23f2e6de0cfc9bf3b06c2646ed5f770>`_

[TASK] Add support metadata to composer.json
-----------------------------------------------------------------------------------------

* Commit: `ba4bb91 <https://git.typo3.org/Neos/Distributions/Base.git/commit/ba4bb91e31d38ef277cdb6989fda633c07d76c1e>`_

[TASK] Add date to changelog titles
-----------------------------------------------------------------------------------------

* Commit: `78e310c <https://git.typo3.org/Neos/Distributions/Base.git/commit/78e310c8de5a0f731b579c23a7e142fc7e525ecd>`_

[TASK] Update PhpUnit to 4.3 and vfsStream to 1.4
-----------------------------------------------------------------------------------------

* Commit: `20fc6e4 <https://git.typo3.org/Neos/Distributions/Base.git/commit/20fc6e46c970b4d2c0914251d8015b7cc15509df>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.Neos
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/TYPO3%20Neos%20Release/50/

* Commit: `91a7141 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/91a71418a421067e2c0c5af89e57b4c3545002f9>`_

[BUGFIX] NodeWrappingHandler should not rely on "site" in context
-----------------------------------------------------------------------------------------

The NodeWrappingHandler checked for existence of "node" in the TypoScript
context but then accessed "site" which might not be available. In fact
that is not needed and "node" is enough. This avoids errors in uncached
rendering where "site" might not be part of the context.

* Commit: `e033118 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e03311883eb28015cf05ee6ad1efdd308e51f498>`_

[TASK] Update contributor list
-----------------------------------------------------------------------------------------

Resolves: NEOS-1262

* Commit: `11b0989 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/11b09898b1a8ecb78df3d215d6cb6a1b5c492115>`_

[TASK] Update release notes for 2.0
-----------------------------------------------------------------------------------------

Resolves: NEOS-1154

* Commit: `f9efd61 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f9efd6166ba96fe65f7bbecaaef5cdc1344bf1a6>`_

[BUGFIX] Fix styling of exception messages
-----------------------------------------------------------------------------------------

A regression in `I08b3471460986af1ebb73d5bf3267a4aa2191254`
meant that styling of the exception messages was broken due
to a wrong nesting in the styles.

Fixes: NEOS-1244

* Commit: `bd1a3d2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/bd1a3d2843a4927156ed3d010e489afdb3f89b64>`_

[TASK] Adjust release notes for 2.0 beta 1 release
-----------------------------------------------------------------------------------------

* Commit: `28e4abe <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/28e4abe786677f31e313f687fba0e1fa6ca0a7be>`_

[BUGFIX] Changed Nodes need to be rendered before persisting
-----------------------------------------------------------------------------------------

For some reason objects seem to get NULLed in persistAll() why
exactly needs to be checked. But therefore A changed node needs first
to be rendered and then persisted if that is needed otherwise
referenced objects might not be fully available.

(cherry picked from commit cb412c768d6a8562a990667d0c7a5f930b3a9ac7)

* Commit: `05f8f5c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/05f8f5cb4a436b5852c6af04d8d1efca107dbc1a>`_

[BUGFIX] Incorrect labels for shortcut page help texts
-----------------------------------------------------------------------------------------

A regression was introduced causing a difference for the labels
for the shortcut page help texts between the template and the
label file. This changes synchronized them again and fixes the
incorrect labels in the label file.

Related: I0f48d2b5989d391e857d872284230a417ebb6149

* Commit: `1e50100 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1e50100551c8f5d7a883b3fceeec9ae1b10480bf>`_

[BUGFIX] Unit test should not overwrite $_SERVER
-----------------------------------------------------------------------------------------

Ovewrwriting $_SERVER can brake other tests as it is a global
variable. This fixes the test and therefor avoids breaking
other test.

* Commit: `6df8c15 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6df8c155b2ef272359dece5518966ae7e3b2d22e>`_

[TASK] Adjust required versions in composer manifest
-----------------------------------------------------------------------------------------

This adjusts the TYPO3.Setup and TYPO3.Twitter.Bootstrap dependencies to
~2.0.

Related: NEOS-1243

* Commit: `c9459f0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c9459f0d1c2022864d93712487f53238a2c28cf0>`_

[BUGFIX] Route caches need to be flushed on node update
-----------------------------------------------------------------------------------------

Changes done in ``Ic81c6595cb6594735206be8422cea5def01fbda7`` introduced
a regression preventing the route cache from being flushed before the
``nextUri`` for an updated Node was build. This resulted in errors if
changing the ``uriPathSegment`` of the current node.

* Commit: `97c5c9a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/97c5c9a808c5ac0fc8f55a223c94459828f6b86e>`_

[FEATURE] Configurable link target for external links & resource links
-----------------------------------------------------------------------------------------

This allows overriding or adding the specified link target to all
external links and resource links::

  prototype(TYPO3.Neos:ConvertUris) {
  	externalLinkTarget = '_blank'
  	resourceLinkTarget = ''
  }

Resolves: NEOS-1138

* Commit: `37951e5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/37951e589dd81b85094ac7a6ea69a686a870be32>`_

[BUGFIX] Prevent uncaught notice when not using content dimensions
-----------------------------------------------------------------------------------------

With `Ia5f57ac3e1ac1d878503f5a8f950c551e29a6840` a regression was
introduced causing an uncaught notice, when not using content dimensions.

* Commit: `1d15c2a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1d15c2ac986a4dffa1b11e7cefec39f3b0710939>`_

[BUGFIX] Handle arrays with one value for content class attributes
-----------------------------------------------------------------------------------------

This change prevents the processor that appends the node type name
as a class to content elements from breaking when the class attribute
is an array with only one value. The regression was introduced with the
change `Iebdf4aaef6f764441903740a0d5a36cef0323218`.

Fixes: NEOS-1259
Related: NEOS-513

* Commit: `f58707d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f58707dc3f5ed7b8a8bcf5d60a56b56444c2ca4b>`_

[TASK] More robust appending of `.neos-contentcollection` class
-----------------------------------------------------------------------------------------

If a content collection overrides the class attribute the class needed
in the backend interface isn't appended anymore. This leads to problems
since that class is used in the backend interface. To make it more
robust the class is appended using a processor instead, which can be
disabled if desired. However the class will still be appended when in
the backend, since there's a dependency on the class.

Fixes: NEOS-1218

* Commit: `fa0c334 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fa0c3341fbad8d12dffa05f37c1f4fd060923dad>`_

[TASK] Add changelog for TYPO3 Neos 1.2.6
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/TYPO3%20Neos%20Release/49/

* Commit: `e0dca83 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e0dca832da4ea060e66114e3ba3ef888c92f2985>`_

[BUGFIX] Take multi-dimensional node paths into account
-----------------------------------------------------------------------------------------

The ``RouteCacheAspect`` didn't correctly split the nodepath into
parts for multiple dimensions and so routing caches would fail
to be flushed when using multiple dimensions.

* Commit: `c2e6e63 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c2e6e63154994ab7f80cd2fa24034c7c50d49816>`_

[TASK] Adjust node type config to new super type configuration format
-----------------------------------------------------------------------------------------

Depends: I6b5c89f5c88339db99f4a81c5e6b74ec5e7ceee9

Related: NEOS-1253

* Commit: `37f860a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/37f860ab1783a29f22f783d033c5180aaa6b1a57>`_

[FEATURE] Allow settings a default asset collection for a site
-----------------------------------------------------------------------------------------

Makes it possible to select a default asset collection for a site.
When an asset is uploaded for a site the asset is automatically added
to that collection. Additionally when opening the media browser/module
the site's default collection is selected automatically.

Depends: I8b8d9a3a3589b72d9374a0ee97b3fe0dd617ea8d

Resolves: NEOS-1256
Related: NEOS-251

* Commit: `a3819b8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a3819b86d0a6bd2f74d95ae09a185a488c0a899f>`_

[TASK] Embed caches for nested ContentCollections
-----------------------------------------------------------------------------------------

Embed caches for nested ContentCollections, instead of
doing it for ContentCollections inside of Content.
In some use-cases root ContentCollections may be rendered
inside of Content, that's why it's better not to depend on it.

* Commit: `52ba18b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/52ba18b37b1bbb6f6fd662d0d5268c72a22bd646>`_

[!!!][TASK] Reload content without reloading the whole page
-----------------------------------------------------------------------------------------

The behavior of the node type property setting `reloadIfChanged`
to only reload the current element instead of reloading the whole
page. This makes the experience for the editors a lot smoother
especially on large pages or large elements, where the editor
would easily get confused by the position changing after reload.

This is breaking in case you rely on the whole page being reloaded
when a property of a single node is changed. To achieve the previous
behavior a new option called `reloadPageIfChanged` is introduced.

Resolves: NEOS-827
(cherry picked from commit b5b0230eeffb21abcd8125536396179ece1ce008)

* Commit: `202daa7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/202daa7445b717ea719366d728dbcae5da8bb6ec>`_

[BUGFIX] Flush content cache of source collection when moving content
-----------------------------------------------------------------------------------------

Fixes a node being duplicated when cutting from one content
collection and pasting into another one. This happens since
the content cache for the previous collection isn't cleared
when the node is moved.

Fixes: NEOS-1224

* Commit: `9f096d1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9f096d11369fe6963c372398f4ef0da0dbf5a106>`_

[TASK] Improve usability of drop zone in media browser/module
-----------------------------------------------------------------------------------------

- Enables clicking the dropzone to select files
- Removes unreliable hiding of drop zone
- Adds active/hover states to the drop zone when dragging

Depends: I9e90bf7aa02379614c0e104666c77bb5669a9716

Resolves: NEOS-1077

* Commit: `7a52f4d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7a52f4d6ae642beaba044b94ffaedb218749803c>`_

[TASK] Adjust to confirmation dialogs in media browser/module
-----------------------------------------------------------------------------------------

Adjusts styling to the confirmation dialogs and the
added delete button in the thumbnail view.

Depends: I30352c6c7ec25bd3c973119f97353bac6415d7ea

Related: NEOS-1066
Related: NEOS-1025

* Commit: `d0c094b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d0c094b839731a04d2ca1249933cd1f7987e7ba0>`_

[BUGFIX] Fetch external fonts via HTTPS
-----------------------------------------------------------------------------------------

Currently the Login and Error Views of Neos include Google fonts via
HTTP leading to ``Mixed Content`` errors when accessing the site over
HTTPS.

This patch adjusts ``Error.scss`` and ``Login.scss`` accordingly.

Note: We don't use protocol relative URLs by intention, because those
are deprecated for security reasons.

Fixes: NEOS-1100

* Commit: `c88fb76 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c88fb76fe21797db59906eafcf481a4934815dc0>`_

[BUGFIX] Always wrap content elements with root tag
-----------------------------------------------------------------------------------------

This change adjusts the ``ContentElementWrappingService`` to make sure
that a rendered content element always contains its own root HTML tag.

Background:
Currently if a content element only renders a ``ContentCollection``
directly (without wrapping div for example) the neos attributes are
added to the *existing* wrapping element of the ContentCollection, so
the resulting code (in backend) is::

 <div typeof="typo3:Some.Node:Type typo3:TYPO3.Neos:ContentCollection" ...

instead of::

 <div typeof="typo3:Some.Node:Type">
   <div typeof="typo3:TYPO3.Neos:ContentCollection" ...

Leading to errors when trying to publish and/or working with the
affected element.

This change adds an argument ``exclusiveAttributes`` to
``HtmlAugmenter::addAttributes()`` allowing for specifying attributes
that force a new root element if one of the attributes is already set
on the existing root element.

Fixes: NEOS-1223

* Commit: `d65c6aa <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d65c6aaeca301f4ad19676a8eddc7f2c7b3f7ee9>`_

[BUGFIX] Flush content caches when changes are discarded
-----------------------------------------------------------------------------------------

The signal that a workspace change to a node was flushed was
not watched. Probably because the Node also signaled it was removed
before some refactoring. Now the signal is connected and
discarding changes correctly flushes caches making the changes
visible.

Fixes: NEOS-1251

* Commit: `cff5901 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cff5901233e94fe1e753d513265e48a4e20a769a>`_

[TASK] Adapt to changed behavior of AssetConverter in Media
-----------------------------------------------------------------------------------------

The default behavior of the AssetConverter in the Media package has
changed to create new asset objects for each uploaded resource.
For Neos this is not what users would expect. The same Asset should
usually exist only once. Neos needs to set the appropriate
TypeConverter option on images to get this behavior now.

Depends: I5a319e2d027a870a9080fdcff353a1d1c4cb4d5e
(cherry picked from commit 9f007f64079aa3228de2d2a99f788c1937c32bdc)

* Commit: `9bd588c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9bd588ca8638e3c8677c96eb4fe396e73c46a899>`_

Revert "[TASK] Speed improvements for Page"
-----------------------------------------------------------------------------------------

This reverts commit 0bbce6a77bc0331e9f188af68de2c6a8a58e40d0.

The change lead to issues with some things being cached and not cleared
when needed like the CSRF token and some version numbers.

* Commit: `faba26f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/faba26f792b2a28f7dd309eeb45a49f038f50b7f>`_

[FEATURE] Expose notifications in External JavaScript API
-----------------------------------------------------------------------------------------

Enable external JavaScript to access the backend notification
module to display notifications in a standardized way.

Usage::

  window.Typo3Neos.Notification.ok('Success');

Related: NEOS-1020

* Commit: `6122107 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6122107dadc9f2f3d73785972e376d650c59f745>`_

[TASK] Remove empty foreach loops
-----------------------------------------------------------------------------------------

Those loops seem not to have any usecase and as such only
take resources.

* Commit: `97775f3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/97775f3bbdce6dfc9de5444a94891e9f2475c1e7>`_

[TASK] Show the image edit action when clicking on the inspector
-----------------------------------------------------------------------------------------

When a use click on an image, in the inspector, this change open the edit
action for the given image. Before this change we open the crop editor.

Depends: Ibeef9517d8d250f8dcb634db48e01aec2301bbad
Resolves: NEOS-1084

* Commit: `a72d473 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a72d473f851bdcb443b1ca461609076b7306fe99>`_

[TASK] Adjust documentation version to 2.0
-----------------------------------------------------------------------------------------

* Commit: `eaa59e8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/eaa59e8d5cc520e9115483be910938f90b5cabbe>`_

[BUGFIX] Correctly escape backslashes in HtmlAugmenter
-----------------------------------------------------------------------------------------

When the HtmlAugmenter works on an element that has a root element,
preg_replace was used to insert rendered attributes. This stripped one
level of escaping, leading to wrong return values.

This was worked around in the ContentElementWrappingService, but that
workaround was failing in some cases.

Fixes: NEOS-1245

* Commit: `4257eb2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4257eb22dab5a36308f9f8a1214f739d2a168cb0>`_

[TASK] Fix font-weight in media tooltips
-----------------------------------------------------------------------------------------

Depends: I85084a25d1fb11c1019fb53db83b14ba70ae2abe
Related: NEOS-1028

* Commit: `96f404d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/96f404d929b1b9af9a391889ff0ef373fc7f6a89>`_

[BUGFIX] Add Namespace for NeosException
-----------------------------------------------------------------------------------------

In lines 88 and 91 NeosException is used, but which is not associated with a
namespace. Therefore, there was an error if the appropriate package was not
activated.

Fixes: NEOS-1240

* Commit: `254ad05 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/254ad059eed4844fea585c2624b80c276a0fb676>`_

[TASK] Adjust dependencies for the 2.0 branch
-----------------------------------------------------------------------------------------

* Commit: `7d927d2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7d927d2111b57d5d0ce9b83c783b629abca7f9b9>`_

[TASK] Return 404 on inaccessible nodes
-----------------------------------------------------------------------------------------

The ``Frontend\\\\NodeController`` currently throws an exception when
trying to render a node that is protected by the ``ReadNodePrivilege``
because the ``$node`` argument can't be mapped.

This change adjusts this behavior by throwing an
``NodeNotFoundException`` (HTTP Status 404) if the requested node could
not be loaded.

Besides this change replaces some ``throwStatus()`` calls by proper
exceptions so that the regular error handling can kick in.

Background:

When the ``FrontendNodeRoutePartHandler`` resolves a request, the
``Security\\\\Context`` is not yet initialized (per design). So it can
resolve even protected nodes. But the ``PropertyMapper`` won't map
those leading to the exception.

Resolves: NEOS-1238

(cherry picked from commit 72c60e39ac16254a2b75197af4bac3ab8f95ae98)

* Commit: `5ca3660 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5ca3660d3cf8ceab15c24fb527f39939f2af09bc>`_

[BUGFIX] Adjust IntegratingJavaScriptSlider cookbook
-----------------------------------------------------------------------------------------

Since the TypoScript paths changed for 1.2 the cookbook doesn't
reflect realities anymore and missed the important part of including
the additional TypoScript file to the Root.ts2.

* Commit: `f6faa00 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f6faa00ca06eeaee5dd655c9c1eb5e9835db9256>`_

[TASK] Update composer manifest for 2.0.*@dev
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/typo3-neos-branch/5/

* Commit: `e1db589 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e1db589d50493d958f37a6e1d6a1360eb394b300>`_

[BUGFIX] Remove Template.ts2 which refers non existing class
-----------------------------------------------------------------------------------------

The deprecated `TemplateImplementation` in Neos was removed in
change Ifea6a15069d7349404858639d1d69964269d9734 but the TypoScript
file referring to it was not. This removes the references in
TypoScript as well.

* Commit: `277e0fc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/277e0fcfb0483147697bb690f8cdf42f5d616931>`_

[TASK] Improve debug output for node objects by excluding large classes
-----------------------------------------------------------------------------------------

With the change `If4a692168d317cbcb7527fb28ebb113705f7c500` in
TYPO3.Flow the ignoredClasses are configurable in the settings.
This change adds ignoredClasses for this package to improve the
debug output for node objects.

Depends: If4a692168d317cbcb7527fb28ebb113705f7c500
Resolves: NEOS-1140

* Commit: `b293cbe <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b293cbe14f9cddcab2a92d42d288b6952592ee4b>`_

[BUGFIX] Migration for serialized objects applies to all Assets
-----------------------------------------------------------------------------------------

The migration used to transform serialized objects into a reference
was just working with Images and arrays of assets but not with
other asset types. This change adds a transformation for those as well.

Fixes: NEOS-1236

* Commit: `1b2e09b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1b2e09bdabe4099b3cdde589a6f2f50fd7a309a2>`_

[TASK] Refactor the tree to use PositionSelector component
-----------------------------------------------------------------------------------------

Use PositionSelector component for New and Paste buttons.
CSS refactoring.
Remove `unmodifiableLevels` constant and allow to modify
any nodes in the tree, as long as constraints allow it.
Adjust constraints to match current behavior.

Related: NEOS-1098

* Commit: `8125ecf <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8125ecf2127cc9ff4ebb781f59a662996c910eef>`_

[FEATURE] Make inline editing handles behave the same as tree controls
-----------------------------------------------------------------------------------------

Introduces dropdown for create and paste buttons with option
to insert nodes before/inside/after.

Resolves: NEOS-1007
Resolves: NEOS-126

* Commit: `b267fc9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b267fc9b167786897722ecb0987692b93572ca1e>`_

[TASK] Remove restrictions for ContentCollections to be extended
-----------------------------------------------------------------------------------------

As it is now safe to extend ContentCollections, remove all checks
that disallowed it and update docs and code comments to say so.

Related: NEOS-1094

* Commit: `7d5c270 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7d5c270c06ee0efc29fa51edbc0168662a54e7ff>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/44/

* Commit: `1d573ef <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1d573efd9f05903ded201269579572e0d816d39c>`_

[TASK] Speed improvements for Page
-----------------------------------------------------------------------------------------

The backend parts of page are now integrated into the page
cache depending on the fact that the backend is rendered.
This allows for fully cached pages in live workspace.
Previously the backend parts were still evaluated at runtime
even on a live site.

* Commit: `0bbce6a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0bbce6a77bc0331e9f188af68de2c6a8a58e40d0>`_

[!!!][TASK] Implement ContentCollection in pure TypoScript
-----------------------------------------------------------------------------------------

The change `I06ba604f562685e3a1d5ee844a8adaec7eda20f5` was in fact
breaking if you need to overwrite properties of the actual
`Collection` renderer. Examples include the `itemName`,
`iterationName` or `itemRenderer`. Those must now be set inside the
`content` path of the `ContentCollection`.

So the following TypoScript::

  carouselItems = ContentCollection {
    nodePath = 'carouselItems'
    iterationName = 'carouselItemsIteration'
  }

Has to be changed to::

  carouselItems = ContentCollection {
    nodePath = 'carouselItems'
    content.iterationName = 'carouselItemsIteration'
  }

* Commit: `9f476aa <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9f476aa1628ce4f27225365ebc1ee4744a77d284>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/43/

* Commit: `d8f7c84 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d8f7c8484fcff64b173c0419a4ac22e7406bdd74>`_

[BUGFIX] When a new site is created in Sites module, deactivate others
-----------------------------------------------------------------------------------------

Disables existing Site Packages in case a new package is kickstarted
or a package is imported in the site management module.

This prevents a big variety of errors when people think the Demo Site
is inactive, but is still interacting with the their site because
Settings and NodeTypes are loaded.

Resolves: NEOS-1108

* Commit: `c9a270d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c9a270d3b74a28b34af1d1f8f39578b72dd0e871>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/42/

* Commit: `70aac69 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/70aac69f599898708f7c3ce9e8f220f41cd2ded8>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/41/

* Commit: `87a6696 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/87a66960bc7ea1afe2de8dc32236a6661f2e4963>`_

[TASK] Adjust content dimension selector to dimension constraints
-----------------------------------------------------------------------------------------

This change adjusts the content dimension selector panel to work with
multiple dimensions when content dimension constraints are configured.

Related: NEOS-1205

* Commit: `016d9eb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/016d9eb580c8f465d045209dca72df24b50adc98>`_

[!!!][TASK] Method to easily determine if backend rendering
-----------------------------------------------------------------------------------------

To reduce exposure to implementation details two helper methods
have been added to find out if currently the backend is rendered
and if the live workspace is rendered.

This deprecates the TypoScript context variable ``editPreviewMode``
that was used inside of Neos to know what to render. The change is
breaking if you used this variable anywhere in your TypoScript.
You can seamlessly replace it by using
``${documentNode.context.currentRenderingMode.name}``.

Related: NEOS-845

* Commit: `fd77e26 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fd77e26ce7c57ea817733b7b0b82bf436ca0f8bf>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/40/

* Commit: `b43dc60 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b43dc60c6bed5181c33bf1492dc2fe91e79f585b>`_

[BUGFIX] Allow NodeTreePrivileges to refer to node identifiers
-----------------------------------------------------------------------------------------

The ``NodeTreePrivilege`` was introduced with a custom
``NodeTreePrivilegeContext`` that only implements the
``isDescendantNodeOf()`` constraint.
That custom implementation, however, did not support referring to the
node *identifier*, it only supported node *paths*.

This change fixes this by replacing the custom context and relying on
the default ``NodePrivilegeContext`` which - as a side-effect - also
allows for targeting of nodes based on their *type*.

Related: NEOS-944

* Commit: `00fc903 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/00fc903096de5f2800d07f20406df26c2f4b7e5e>`_

[TASK] Integrate content dimension constraints into routing
-----------------------------------------------------------------------------------------

This change integrates the new content dimension preset constraints
into the FrontendNodeRoutePartHandler and thus makes sure that only
allowed combinations are accessible through the frontend.

This change also includes documentation for the new feature.

Related: NEOS-1205

* Commit: `8c752b7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8c752b7e242706d961cfdfcbf766c7135c0bd36c>`_

[FEATURE] Introduce show action for Content Dimensions REST service
-----------------------------------------------------------------------------------------

This change introduces a show action for the content dimensions service.
The new action allows for retrieval of presets of a single dimension or,
if a filter is specified, returns only those presets which are allowed
in combination with the given presets from other dimensions according
to possibly defined content dimension constraints.

Examples:

Retrieving only presets from the "language" content dimensions:

  http://localhost/neos/service/content-dimensions/language

Retrieving only those presets from the "language" dimensions which are
allowed in combination with the given "country" preset:

  http://localhost/neos/service/content-dimensions/language?chosenDimensionPresets[country]=de

Related: NEOS-1205

* Commit: `5e2df66 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5e2df66eb478d4dec819140dd27a5ae911e059d2>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/39/

* Commit: `0a78bc3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0a78bc38f5cf58f359200fa0ddd5090b15a4f13f>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/38/

* Commit: `11ad61c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/11ad61c7f3167653424615872534694ab5bc0560>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/37/

* Commit: `87b85e0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/87b85e068312449c0caeafdae29e251a532c7ae3>`_

[TASK] NodesController::createAction(): throw status instead of exception
-----------------------------------------------------------------------------------------

The createAction() previously throwed a NodeCreationException if the
given create mode was not supported. This action will now throw a
status exception with Bad Request instead.

* Commit: `e11dc0a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e11dc0a7d3f2f514f63c155f773fc4f35d1c871b>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/36/

* Commit: `d921bfe <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d921bfe5c7875ac16f36b5f96e146835740117a9>`_

[TASK] Remove unnecessary usages of ``TYPO3`` in documentation
-----------------------------------------------------------------------------------------

Removes the usage of ``TYPO3`` in the titles of various documentation
since the context is known, it's superfluous.

* Commit: `645634e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/645634e0fb27b862b5ea93b59e86cb9065256855>`_

[BUGFIX] Escape class names in ContentStructure documentation
-----------------------------------------------------------------------------------------

* Commit: `3c1f176 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3c1f176478f2ed1d9d6e1d88b1b60749152113ed>`_

[BUGFIX] Documentation should document existing TypoScript objects
-----------------------------------------------------------------------------------------

The TypoScript reference mentions two TypoScript objects in the
``TYPO3.Media`` namespace but that doesn't exist. Those objects are
in fact in the ``TYPO3.Neos`` namespace. The change reflects that.

Fixes: NEOS-1099

* Commit: `5d96b11 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5d96b1152dbfa2803ebbaf78ce0f9c5e21f1f31e>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/35/

* Commit: `e215706 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e2157063bd2c054a3b7b9e5fea2f2ed55f794704>`_

[TASK] Add changelog for TYPO3 Neos 1.2.5
-----------------------------------------------------------------------------------------

* Commit: `4314300 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4314300d7ca61edabec78f888bf4f562c47fafb7>`_

[BUGFIX] Shortcut resolves to first node instead of sibling
-----------------------------------------------------------------------------------------

Shortcuts pointing to the first child node resolves to the next
sibling of the current page when navigating the child pages of the
shortcut. This happens because the child nodes are fetched from the
first level node cache, which can have a array pointer that has been
moved.

Fixes: NEOS-1220

* Commit: `d7c534d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d7c534d24ebce6d3fd4439bcb7b80d248ccc5341>`_

[TASK] Add changelog for TYPO3 Neos 1.1.1, 1.1.2, 1.1.4 & 1.2.4
-----------------------------------------------------------------------------------------

* Commit: `de6264d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/de6264d1ccd1940aed0c5bd54699d30256de4fd8>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/34/

* Commit: `e2b7a8a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e2b7a8a23b9d6fb4434c8504b2894b3affae12d0>`_

[BUGFIX] Version upgrades leads to a broken backend
-----------------------------------------------------------------------------------------

Existing users experience a broken backend between Neos upgrades due to
the backend resources being cached in their browser.

To prevent this problem a bust header is added to the resource paths,
based on the Javascript & CSS built files when using the minified
versions.

Fixes: NEOS-1202

* Commit: `0506562 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/05065628a787ae0c9439a93d8037014342ccc3e7>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/33/

* Commit: `06c8402 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/06c8402a01c8f1665edfac4ea8683361490d8ec1>`_

[BUGFIX] Hide content element handles when page is selected
-----------------------------------------------------------------------------------------

I085f9dd7a692e12155d2627b7da50911766ba108 Introduced a regression
that caused the content element handles to stay visible if
the page is selected while a content element was selected before.

This change prevents unneeded manupulation of the nodes array
in the node selection that caused this bug to happen.

* Commit: `f3c796a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f3c796a3266eabfebd02268f71afbd8d9afd86b0>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/32/

* Commit: `acb0d13 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/acb0d134614b00cb1784f5032bc5592eb1c9636c>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/31/

* Commit: `4862b2c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4862b2c0f6ef73737fe4f8db21a035351d1d149b>`_

[BUGFIX] SiteImport should persist Workspace and Site
-----------------------------------------------------------------------------------------

With ``Id5d17fd64a744453e7bbc430fdea0fcc0761071e`` it seems
that finally only Nodes get persisted in persistEntities().
To fulfill database constraints while adding Nodes we
need to have the Workspace and Site already persisted when
starting to import Nodes.

This is a follow up to `I1834a7d388d7c61686138bf52a424ccadd3f7716`,
which only fixed it in `SiteImportService`.

Fixes: NEOS-1208

* Commit: `46981dd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/46981ddb6221335f11b2395cb53ebb590228dc47>`_

[BUGFIX] DimensionMenuImplementation uses configured dimension
-----------------------------------------------------------------------------------------

Before this change configuring the dimension to use for the menu had no
effect, since the dimension name was hardcoded to "language".

* Commit: `01db6d0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/01db6d0dd0c24eda3204005ebd2be2ee645ef827>`_

[BUGFIX] Pull in missing jQuery dependency
-----------------------------------------------------------------------------------------

This change defines jQuery as a dependency of the ContentModuleBootstrap
since it is used while registering the known translations.

* Commit: `e620142 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e6201429accb92229f6863f5ea6524d6b8ce5e2f>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/30/

* Commit: `d012503 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d012503222693562257caba470597c33a4b5465d>`_

[TASK] Meaningful pre-selection of UI language for new users
-----------------------------------------------------------------------------------------

This change sets the default value for the UI language in the form for
creating new users (Administration > User Management) to the same
language the currently logged in user is using. This should be a
meaningful default in most situations.

This also prepends an empty option to the select fields in order to
allow differentiation between "unselected" and "first option".

* Commit: `3e04bfc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3e04bfcf1033ca2a49f963c9dbeba0728001a52e>`_

[BUGFIX] SiteImport should persist Workspace and Site
-----------------------------------------------------------------------------------------

Follow up to I1834a7d388d7c61686138bf52a424ccadd3f7716 which
didn't take the ``LegacySiteImportService`` into account.
Of course the same change applies there as well.

This doesn't need to be backported as the backported versions
of this change already take care of both services.

Depends: I1834a7d388d7c61686138bf52a424ccadd3f7716

* Commit: `fcbb4d9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fcbb4d9c33ff7239d0c33fd3c556da33d820e45d>`_

[BUGFIX] Display site import step error messages immediately
-----------------------------------------------------------------------------------------

The error message occurring during a failed site import in the setup
site import step are not displayed until after a refresh of the page.
This happens because flash messages are used instead of a exception.

Fixes: NEOS-758
Depends: Ifbba8d4c45b87a6ec171f3fe72bbc093c7b93722

* Commit: `5507b0a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5507b0ad4d16eb32f0c9fe0139a2b546c89347e2>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/29/

* Commit: `bb82de7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/bb82de72935628229783c221837ad230f799faf6>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/28/

* Commit: `f2ef03b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f2ef03bd9340cd5f2774dbd1f3a2196cc8071fec>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/27/

* Commit: `c3f418f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c3f418f6ed986c901ec8305b7fcfa31762cdd11a>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/26/

* Commit: `d5a1483 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d5a14833616c0eed5ef34116d198631e5caec3e8>`_

[BUGFIX] Explicitly store new assets when uploaded in the inspector
-----------------------------------------------------------------------------------------

When new assets are uploaded in the inspector the server side service
returns a persistence object identifier. When the changes are applied
the node is then published with a reference to that identifier which
is not known to the resource management.

This change explicitely adds the objects to the repository if they
were not persisted before.

Resolves: NEOS-1204

* Commit: `8a25365 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8a2536519aecb08828322ba1abf955d26a02ec0c>`_

[BUGFIX] Moving node to a new parent and back makes it disappear
-----------------------------------------------------------------------------------------

When moving a node to a new parent and back to it's original parent
again makes it disappear. This happens because the `NodeOperations`
move method checks if there already exists a node in that location
in any context. Since there is a shadow node in it's original place,
that returns true and thus a new name is generated to avoid a conflict.
Problem is that the shadow node and the node will then share the
identifier on the same level, which leads to the node disappearing.

Fixes: NEOS-1203

* Commit: `d5332af <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d5332afdf63e98b2a4eb54ec571a90420949af28>`_

[BUGFIX] Updating page in node tree can lead to problems
-----------------------------------------------------------------------------------------

When a page is being edited in the node tree and the url is changed
on the server side, the link in the tree is out of sync.

Additionally if the title of the current page is changed, the page
is not reloaded.

To prevent these situations the URL of the node in the tree is updated,
as well as the title and if it's the current page it's reloaded automatically.

Fixes: NEOS-1197

* Commit: `3e9fd35 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3e9fd357522850d3d7f8bc255d003efa7b7ed51c>`_

[BUGFIX] Prevent unnecessary double persist when updating node in tree
-----------------------------------------------------------------------------------------

When a node is being edited in one of the tres in the navigate component,
the inline element is synchronized causing an additional update call to
the server. This call is unnecessary since that state has already been saved.

Fixes: NEOS-1196

* Commit: `d3cefcb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d3cefcb5010c89fdd2b0ee8c6e316f87a8844b3d>`_

[TASK] Re-use signal for `nodePropertyChanged` to flush route cache
-----------------------------------------------------------------------------------------

* Commit: `25de911 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/25de911025f2a7485ff792f358b81dff9773f0fa>`_

[BUGFIX] DimensionMenu should work on pages hidden in menu
-----------------------------------------------------------------------------------------

As the dimension menu uses code from the normal menu it also
ignores documents that have the ``hiddenInMenu`` flag set.
To make the ``DimensionMenu`` work on pages that have the flag
set it needs to ignore that.

* Commit: `26c13e4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/26c13e485574f452e3786780fccc24b4bdc5c285>`_

[TASK] Adjust tests to lowercase only node paths
-----------------------------------------------------------------------------------------

Adjusts the `NodeRenamingTest` to the TYPO3CR change only
allowing lowercase node paths.

Related: NEOS-1195

* Commit: `eb3de67 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/eb3de676fd7af821c57ebb1026d268d4544c2fde>`_

[TASK] Replace the installer screenshots
-----------------------------------------------------------------------------------------

Update the installer screenshots in the documentation with the
current versions screenshots.

Resolves: NEOS-1201

* Commit: `fdd63d2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fdd63d284a547575622d66b8a19a42f22268b655>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/25/

* Commit: `d95a0a2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d95a0a2f65fe660fb9e405e3b4b28d7f73cfa072>`_

[BUGFIX] Deleting inline element breaks if title doesn't contain tags
-----------------------------------------------------------------------------------------

A regression was introduced in `Ib5ae1224445d19316717bacda3732ddfff8c3a1c`
causing the deletion of inline elements to break if the title property of
the element wasn't wrapped in a HTML tag.

Related: NEOS-1125

* Commit: `a11f12d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a11f12d86052d70628f49e6ad78cc4cb0a2b7206>`_

[FEATURE] Inspector translation
-----------------------------------------------------------------------------------------

This change adds support for inspector translation. To do so it
extends the translate helper.
Contains a reworked bootstrapping of the I18n for Neos in order
to be able to load localisations inside the js. This customized
bootstrap fixes bug NEOS-1057.

We follow the following convention for the translation labels
for node types and node type properties:

  nodetypes.<dotted node type name>
  nodetypes.<dotted node type name>.properties.<property name>

Examples:

  nodetypes.TYPO3.Neos.Document
  nodetypes.TYPO3.Neos.Document.properties.title

To prevent the requirement to translate labels specifically
for every property even if the property is derived from a parent
node type we allow setting a fall back translation id on a property.
This means that if no specific translation is found for the node
property we fall back to this fall back label if it is configured.
This is especially useful for mixins, and can be used like:

  'TYPO3.Neos:Hidable':
    properties:
      _hidden:
        ui:
          label: 'Hide'
          labelTranslationId: 'nodetypes.TYPO3.Neos.Hidable.properties.hide'

In all cases the default fallback is the label property.

Translate helper usage examples:

Value data bind or parsed as string::

  {{translate value="Default label"}}

Fallback and id::

  {{translate fallback="Default label" id="button.createNew"}}

Value, id and package::

  {{translate fallback="Default label" id="createNew" package="Your.Package"}}

Data binding::

  {{translate idBinding="view.label" fallback="Default label"}}
  {{translate idBinding="view.label" fallbackBinding="view.fallbackLabel"}}

All arguments are allowed to data bind.
Allowed identifier combinations::

  i18n:Catalog:Package.Key:Identifier
  i18n:Package.Key:Identifier
  i18n:Catalog:Identifier
  i18n:Identifier
  Identifier

Related: NEOS-446, NEOS-437, NEOS-487, NEOS-1057
Resolves: NEOS-443

* Commit: `8d68229 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8d682291b8c0b5776175bdae7803b0117ed0a3b8>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/24/

* Commit: `61a0c50 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/61a0c501371e02c9dac23b09e25f767e64c89d7b>`_

[BUGFIX] SiteImport should persist Workspace and Site
-----------------------------------------------------------------------------------------

With Id5d17fd64a744453e7bbc430fdea0fcc0761071e it seems
that finally only Nodes get persisted in persistEntities().
To fulfill database constraints while adding Nodes we
need to have the Workspace and Site already persisted when
starting to import Nodes.

Related: Id5d17fd64a744453e7bbc430fdea0fcc0761071e

* Commit: `af95c8c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/af95c8c70ba20135541d09d591ab2634c62b3b19>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/23/

* Commit: `9bc952b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9bc952b626bf46ac9e32c857acc5801202e78c00>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/22/

* Commit: `8bb60a6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8bb60a6da6438aa70f49c98283018c756fc2312a>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/21/

* Commit: `2d79f16 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2d79f16f682ae49d6c1df164750728c0ac206afd>`_

[BUGFIX] Moving nodes down on the same level makes it disappear
-----------------------------------------------------------------------------------------

NodeOperations should check if a move stays inside the same parent
because then it is just a reorder which means we do not need to
generate a new node name for the node (which generates a wrong
result anyway as the node name exists - but it is the node moved).

Releaes: master, 1.2
Fixes: NEOS-1199

* Commit: `69c1af2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/69c1af253979c429e9b372be7796b19930540874>`_

[BUGFIX] Deletion of used assets not possible anymore.
-----------------------------------------------------------------------------------------

Assets should not be deletable if they still have relations
to Nodes. The changes to Asset handling and JSON storage have
broken the way we detected those relations but with this change
it works as before.

Fixes: NEOS-1112
Depends: I7bda7039423d05e83d5718a7b86c31c0b21d8c6e

* Commit: `dc2dd70 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/dc2dd70f5dca0610d715bcd03d6a45aba1ae0db0>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/20/

* Commit: `58bdfde <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/58bdfde2383ac8a6653c746ad5d189f55555e766>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/19/

* Commit: `b1146b6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b1146b632940a3626c81c80ac1d33e8e7944c973>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/18/

* Commit: `f1f79f9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f1f79f9db2a360b103377656aef5b6e880e4d904>`_

[TASK] Add missing icon for plugin view
-----------------------------------------------------------------------------------------

The plugin view content element doesn't have a default
icon and therefore uses the fallback icon. This is not
helpful since the element cannot be recognized easily.

Even though plugins have the same icon by default it's
still better since that would relate them. Additionally
most plugins would a specific icon instead of the default.

* Commit: `dab28a0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/dab28a084a94ead45aa455a45659d830abe514ae>`_

[BUGFIX] Allow overriding ArgumentNamespace for plugins
-----------------------------------------------------------------------------------------

Currently it is not possible to set a plugin ``argumentNamespace``
from TypoScript as the order of resolution will always result in an
early return because the NodeType will be resolved.
This fixes the resolution order.

Fixes: NEOS-1097

* Commit: `2433b82 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2433b828ab267d617428709942b5f17088dabc7c>`_

[BUGFIX] Remove trailing slash from _assetMetadataEndpointUri URI
-----------------------------------------------------------------------------------------

All other endpoints get called without trailing slash,
and it's really not needed there, but it can break rewrite
rules on some sites.

* Commit: `c1d7c8b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c1d7c8be6c2ea0b506d46ca83eb29b7be3318f0a>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/17/

* Commit: `15196d6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/15196d6ed0eb48eccfb01f2afee8758c0d93cb61>`_

[TASK] Add changelog for TYPO3 Neos 1.2.3
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/TYPO3%20Neos%20Release/26/

* Commit: `93d69ed <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/93d69ed0a9644b93106ceadbc2382b2d6da74831>`_

[TASK] Add date to 1.1.3 changelog header
-----------------------------------------------------------------------------------------

* Commit: `dbb349b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/dbb349b76cd0455c7b177c3fc8fd52256f4c3ed9>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/16/

* Commit: `4e710ef <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4e710efdbd9fe8e50ec97ae2c2f0c9746c8906b8>`_

[TASK] Make node migration compatible with json properties change
-----------------------------------------------------------------------------------------

Because the image variant change and json properties change have to
be migrated in the right order we need to adjust the node migration
to not use the node model for getting the property. This is because
the node model returns NULL for the data as it is at this time
serialized where the model is assumed to contain json.

This change updates the migration so it can migrate correctly.

Resolves: NEOS-427

* Commit: `5eaf8fc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5eaf8fc0fbc52f721b351ecdf4d1a12143cb5e4d>`_

[BUGFIX] Form validation results and behavior
-----------------------------------------------------------------------------------------

Form validation errors of backend submodules
were shown at the top of page with a wrong
offset and the problematic fields were not
highlighted.
Also several forms had a bad behavior when
pressing "enter" to submit and other small
bugs.

With this change the validation error list has
to be enabled by adding the
"validationResults" section and rendering
the "ValidationResults" viewhelper.
Most forms should not need this when all
errors are shown close to their fields.

Resolves: NEOS-264, NEOS-524, NEOS-1091

* Commit: `f8fece5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f8fece58490b19d99c7f597bee460fa0609f1e2c>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/15/

* Commit: `8cacf1c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8cacf1c5361da9097666cb681af7d318f8d10c8d>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `12f8cf1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/12f8cf15c116498c95c66659dd0932c6d8a674a4>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/14/

* Commit: `44662a5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/44662a57375138c7a4d3f54cea3f779b5a35526a>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/13/

* Commit: `1dcb42e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1dcb42ee7037883a865da1e17ef29f4144c80af3>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `47218ed <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/47218edf1e1b59f19dde05fc1efe2dfc0ecdab8a>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/12/

* Commit: `bb7ecfe <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/bb7ecfe22e5b24973c06fe2cb364883f66277b07>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `cd7dacc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cd7dacc76dc77da5ae0c5a47be1304aa248ebeac>`_

[TASK] Add changelog for TYPO3 Neos 1.1.3
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/TYPO3%20Neos%20Release/30/

* Commit: `eb0c324 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/eb0c3248a6a6108500b83bcca07476a902b89f81>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/11/

* Commit: `265208e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/265208e5ce29af3740ce6cbd1cbd9a52c94de9f9>`_

[BUGFIX] Flush doctrine query cache, when nodes are published
-----------------------------------------------------------------------------------------

Publishing nodes might change node paths in the target workspace.
A access restrictions on nodes partly depend on the node path, we
have to flush the query cache to apply the correct query constraints
with the new path information.

* Commit: `40616de <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/40616de916b7dd569848c31a08baafab3675d6b1>`_

[BUGFIX] Editing plugin view breaks with unpublished master node
-----------------------------------------------------------------------------------------

When a plugin view references a master node that hasn't been published,
an exception occurs because the node cannot be found in the live workspace.

Instead of looking for the master node in the live workspace it should look
in the current workspace and with the current dimensions.

Additionally it prevents breaking if the master node can no longer be found.

Fixes: NEOS-1096

* Commit: `26cd275 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/26cd2752d90963d12d2192c673d642e7fa74bac4>`_

[BUGFIX] Initialize security in behat tests
-----------------------------------------------------------------------------------------

This is needed to to the refactoring done in
I3c459e4e11f93f6d95f2073226ca4e8137356017.

* Commit: `f47f2ef <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f47f2efef773efe2c6c376f7ca55bb567711d42d>`_

[BUGFIX] Do not suffix default action URLs with .html in the backend
-----------------------------------------------------------------------------------------

Formally redirect URLs where build with a trailing ../.html this
caused a 403 error on some setups.

Resolves: NEOS-1179

* Commit: `0d7fdcf <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0d7fdcf86c1db867cb13e96d15cbd7f1d648b7cd>`_

[FEATURE] Translation label scrambling
-----------------------------------------------------------------------------------------

This change introduces the possibility to scramble
all translation labels to help with translating
the backend UI.

Relates: NEOS-89

* Commit: `79a1420 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/79a142034dc6e5b9e8674bac67e71a93a9f35f66>`_

[BUGFIX] Disable caching when editing nodes
-----------------------------------------------------------------------------------------

In Internet Explorer the response from the backend
when editing a page in the inspector was cached.
This means that changes are not visible and the
editor is forced to reload the backend.
This change tells the browser not to
cache the response.

Resolves: NEOS-1030

* Commit: `1a1a0cc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1a1a0cc39d0c010620649423c618ff8d45cfb64e>`_

[BUGFIX] Follow-up for broken strip tags for title in inline delete dialog
-----------------------------------------------------------------------------------------

The original bugfix didn't work properly and contained a JS error.

Related: NEOS-1125

* Commit: `821a63e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/821a63e32179b6779079ce46ae7a04b092b79d93>`_

[BUGFIX] Improve usability of menu panel button
-----------------------------------------------------------------------------------------

This commit improves the behavior of the neos-menu-button and the
corresponding neos-menu-panel. The menu will now only be opened
on a mouseDown and closed on mouseDown again or on a mouseLeave.

This commit also contains a bugfix preventing ghost clicks on the
neos-menu-button.

Resolves: NEOS-608

* Commit: `e1ba32b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e1ba32bea555c9f7fbb5432f9e7e6754f8a7f654>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/10/

* Commit: `127dbfe <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/127dbfec8665c72d8a1bc8bb64f3440365b9db45>`_

[SECURITY][BUGFIX] Editors should not be able to access others workspaces
-----------------------------------------------------------------------------------------

Severity: Low

This is a security fix, to restrict editors from accessing content in workspaces of other
editors.

Note: We consider severity low, due to the following facts:

* You still need an editor account to access any content in workspaces, that are not
  in the live workspace
* Neos currently does not officially support access controls for editors

Fixes: NEOS-960

* Commit: `1766fad <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1766fad6ed680cf73d83e361f9e291e50983dbac>`_

[TASK] Remove outdated Scripts/README
-----------------------------------------------------------------------------------------

It has been deprecated by Documentation/DeveloperGuide/Development/UI.rst

* Commit: `69b309d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/69b309d41ce2856cc23a0cac56bba8fbe2288d45>`_

[BUGFIX] Strip html tags in the inline delete node dialog title
-----------------------------------------------------------------------------------------

Removes the html tags from node label displayed in the confirmation
when deleting a node inline.

Resolves: NEOS-1125

* Commit: `62694e5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/62694e570e73ba2f288c126dbe7119a2e2d3f20d>`_

[TASK] Collapse site selector in the menu by default
-----------------------------------------------------------------------------------------

The site selector is seldom used and doesn't handle many sites well.
To make it better it should just be collapsed instead, then users can
open it if they want to use it.

Resolves: NEOS-1130

* Commit: `15a75c0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/15a75c0d6b2f5adff50b44a4534785dbc6070e7a>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/9/

* Commit: `40e2bd1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/40e2bd1a3309e2aef826e23562a9c5917425a31f>`_

[FEATURE] Check imagine drivers for image format support in setup
-----------------------------------------------------------------------------------------

With this feature all available image libraries are checked for
the support of png, gif and jpg files during the Neos
requirements check, to make sure these basic web formats are
supported on the system.

Resolves: NEOS-893

* Commit: `9c0c52d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9c0c52dd3a6b2c2c23686ed7edd0318be6de7740>`_

[FEATURE] Improve TypoScript Exception Message Rendering
-----------------------------------------------------------------------------------------

Templating and styling for the error message rendering for
TypoScript exceptions.

Resolves: NEOS-1106

* Commit: `0db70a2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0db70a2e369ce70946c0bdf71c560ea3851a3c9c>`_

[TASK] Root.ts2 not required anymore for a site
-----------------------------------------------------------------------------------------

A default TypoScript for a site can be defined in separate package and
so a site doesn't require a Root.ts2 to run.

Related: NEOS-1120

* Commit: `4e2a06e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4e2a06ee67200a935ff5695b29b1a51cdb39a302>`_

[BUGFIX] Fix method argument override in NodeController
-----------------------------------------------------------------------------------------

The argument node in NodeController::filterChildNodesForTreeAction is
overrided by error. The regression was introduced by
I42ab157cee3d1e2852442282857476d9f296f91f

* Commit: `528c7ae <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/528c7ae7723702e1fffee79bfbf849e87026680c>`_

[BUGFIX] fix regression introduced by "detect file-permission issues when publishing resources"
-----------------------------------------------------------------------------------------------

Resolves: NEOS-1111

* Commit: `159c546 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/159c546a9bd675703ec617479612497202fc4f48>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/8/

* Commit: `6d932d1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6d932d178a4bae673ad41b33ed23633f95218a43>`_

[TASK] Change `desiredNewPosition` to `inside` for contextStructureTree
-----------------------------------------------------------------------------------------

Related: NEOS-1143

* Commit: `d0c7e87 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d0c7e87c92af6a36ee2fdb4aea5c93f6bc1425c4>`_

[FEATURE] detect file-permission issues when publishing resources
-----------------------------------------------------------------------------------------

This check during the setup finds two issues:

- users who upgraded from Flow 2.x (Neos 1.x) need a different web server configuration which does not rewrite Web/_Resources
- permission issues, where PHP is able to write a file into Web/_Resources, but the web server is not able to read them

Resolves: NEOS-1111

* Commit: `f8632fc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f8632fcffcf6c44b62bbb03914ab455bf454643a>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/7/

* Commit: `9b824e0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9b824e0505ea37b0deafaaf25684741cdc9177ae>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/6/

* Commit: `822b19c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/822b19c67b1b2d8a98e03a39355b4fc4290251ef>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/5/

* Commit: `4e303c9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4e303c98672bd4feb82a6feb90ac47f3135182a7>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/4/

* Commit: `c252f87 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c252f87934816c93e0600cdf71f8bbf59ab08d02>`_

[TASK] Adapt to shadow node refactoring
-----------------------------------------------------------------------------------------

Removes the check for shadow nodes in ``CotentElementWrappingService``
as shadow nodes cannot exist as ``Node`` objects any longer.

Releaes: master
Depends: Ic855e10d7c6bd7fb73a5cb0926f8035910a790fe

* Commit: `aca1538 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/aca15382e6f5297756dffc4c7dc5df8de09d4bf3>`_

[BUGFIX] Adjust LinkingServiceTest to Flow
-----------------------------------------------------------------------------------------

Flows functional tests now correctly initialize the ResourceManager
since I23d7a0511a33345bd0977776aa03226b155191b0 was merged.
That means links generated Resource links are (correctly) prefixed
with a host again.
This change just adjusts the LinkingServiceTest to take that into
account.

* Commit: `3381231 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/33812318685d38a1beb5a8e9b9256ce5c0989c33>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/3/

* Commit: `287cbb3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/287cbb3f1f6962f4451ce2cdf41d555996611b87>`_

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/Update%20Neos%20references%20in%20master%20documentation/1/

* Commit: `dc5af9f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/dc5af9fdc17c84118141889fac7baa8ebc92b0dd>`_

[TASK] Cleanup SitesController
-----------------------------------------------------------------------------------------

The sites controller should use the the SitesService to prune a site
and also call the importer just with the necessary arguments.
It still created a context for importing which is no longer
necessary.

* Commit: `7c7a040 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7c7a0404a11b76cb3a552243bf0b5120d64e7671>`_

[TASK] Fix broken and add new unit tests for EditableViewHelper
-----------------------------------------------------------------------------------------

In change Ifd9342c98ffdfb1d0ced94d5282262523cd7a64e the Neos
EditableViewHelper learned new tricks, but the existing unit tests were
not adjusted.

This change fixes that and adds a new test actually covering the new
feature.

Related: NEOS-944

* Commit: `da5b437 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/da5b4371012d7682ab6e74e173b502f57843bba6>`_

[TASK] Disable editing in UI for read-only nodes
-----------------------------------------------------------------------------------------

This change deactivates the inline editing for nodes restricted by the
``EditNodePrivilege`` (see I16d415780896df2dc048ff0f43f35a2106bb5d69).
If the node is a document the inspector will be disabled, too.

Related: NEOS-944

* Commit: `ec9e78e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ec9e78e44651b9ced7ca599f68aaa6336f2a0430>`_

[TASK] Add "cleanup" schema migrations
-----------------------------------------------------------------------------------------

This adds migrations for MySQL and PostgreSQL that tweak the DB schema a
bit, cleaning up some leftover discrepancies.

* Commit: `9f13ba7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9f13ba7f9e5daf8c56824108cce5d9b6a093fb48>`_

[FEATURE] NodeTreePrivilege
-----------------------------------------------------------------------------------------

A privilege that prevents matching document nodes to appear in the
``Navigate Component``.
It also prevents editing of those nodes in case the editor navigates to
a node without using the Navigate Component (e.g. by entering the URL
directly).

Usage (in ``Policy.yaml``)::

 privilegeTargets:

   'TYPO3\\Neos\\Security\\Authorization\\Privilege\\NodeTreePrivilege':

     'Some.Package:SomeIdentifier':
       matcher: 'isDescendantNodeOf("/sites/some-site/some-path")'

This would add a privilege that intercepts editing of the
``/sites/some-site/some-path`` node (and all of its child-nodes)
unless explicitly granted to the current role.

Resolves: NEOS-944

* Commit: `ac2d4e0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ac2d4e05ac201fcf451b6600ade5cbfc820e15d4>`_

[TASK] Speed improvements for Menu
-----------------------------------------------------------------------------------------

To determine the rootline for the current page we now use
Context::getNodesOnPath() instead iterating the parents to
avoid multiple queries.

* Commit: `4a1cd3c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4a1cd3c809a4d0f38191eabc306135186c5e0994>`_

[TASK] Optimize media browser/module for smaller viewports & many tags
-----------------------------------------------------------------------------------------

Optimizes the media browser/module to work better for smaller viewports
and in general. Additionally moves the sidebar down underneath the
images when there's more than 25 tags to compress the needed size.

Depends: Ie54e0f8c7aa88e23f2a8750b4a794464744f9985

Resolves: NEOS-357
Resolves: NEOS-641

* Commit: `edee323 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/edee323d22371443ad20b088d47c045dcfd06d2d>`_

[BUGFIX] Fixes styling issues in the pagetree of the Neos UI
-----------------------------------------------------------------------------------------

Adds a dedicated font-size to the navigational anchors.
Adds a dedicated no text-shadow to the navigational anchors.

Fixes: NEOS-998
Related: NEOS-515

* Commit: `d7623ce <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d7623cefb02a2c2b2189dfb89c62633ce1a09423>`_

[BUGFIX] Fix outdated nodetype in documentation
-----------------------------------------------------------------------------------------

The nodetype TYPO3.Neos.NodeTypes:AbstractNode has long been renamed
to TYPO3.Neos:Node.

* Commit: `1b977ec <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1b977ec9c82076e846aa6756d33e7343aaf27568>`_

[BUGFIX] Prevent duplicate errors while moving nodes
-----------------------------------------------------------------------------------------

Now that the URI is separated from the node path the path can be
changed when moving nodes. This prevents errors when duplicate paths
could be created.

Also refactors this kind of operation into a service to be reused by
other consumers.

Fixes: NEOS-1009

* Commit: `4115682 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4115682a08406065789a85e00cfc74153cef5480>`_

[BUGFIX] createNewNode renders invalid uri path segments
-----------------------------------------------------------------------------------------

This change fixes a problem resulting in invalid uri path segments when
creating new document nodes. When a new document was created, the
NodeController would simply take the entered document title as the
node's uri path segment, even if it contained characters which are not
allowed as part of an URL path.

We now use the TYPO3CR's function for rendering valid node names (like
in the past) which provides some more or less meaningful transliteration.

Resolves: NEOS-1079
Related: NEOS-1059

* Commit: `8a84232 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8a842326363c2447da9133bf57b10c55d20bce06>`_

[TASK] Improve handling of tags in media browser/module
-----------------------------------------------------------------------------------------

- Support editing of tag labels
- Hides tag creation from until tag editing is enabled
- Show a confirmation prompt when deleting a tag
- A few additional tiny improvements

Depends: I435be505503a164b4b4993bf3bfbedca8c04e26c

Related: NEOS-1074
Related: NEOS-1072
Related: NEOS-1070

* Commit: `5b6c85d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5b6c85da924815e8916b8c157ad985e8b5f0dfe6>`_

[TASK] Improve delete action flash message in media browser/module
-----------------------------------------------------------------------------------------

Adjusts the flash message in the overridden delete action in
the media browser/module to follow the original.

Related: NEOS-1024

* Commit: `f2943db <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f2943db169aebb86c3b604f71be05565f289cdc4>`_

[BUGFIX] Move images used in release notes to right location
-----------------------------------------------------------------------------------------

This moves some images used in the Neos release notes to the right
location.

Fixes a regression from https://review.typo3.org/37278

* Commit: `1ad763d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1ad763d79e9d4630a748f08eddffe02c0f908961>`_

[TASK] Change background color of image preview in media browser
-----------------------------------------------------------------------------------------

Instead of a custom color the grayDarker color is used for the
image preview background in the detail view of the media browser/module.
This matches the list/thumbnail views as well.

Related: NEOS-1020

* Commit: `942d731 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/942d731b1b472c0d22f5be873e7b089536d96b0c>`_

[TASK] Cleanup inline ViewHelper syntax in templates
-----------------------------------------------------------------------------------------

Additionally fixes a couple of bugs related to incorrect usage of the
translate ViewHelpers.

* Commit: `2de23e1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2de23e185243bf697f63c97c3b98c3fd0894a11d>`_

[BUGFIX] Hide submodules the current user doesn't have access to
-----------------------------------------------------------------------------------------

This is a change that was missed while doing refactoring to adjust
to ACL changes in Flow (resource is now privilegeTarget) in change
I5b3c9981a606c886707dd536e5a72cfde0dec947.

Without that fix, setting ``privilegeTarget`` for module, e.g.
``TYPO3.Neos:Backend.Module.Administration.Configuration``
results with the module still showing in module overview section.

Resolves: NEOS-1067
Related: FLOW-11

* Commit: `6aac786 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6aac78644ae507ccb96bad5a49bc0251584c4c47>`_

[BUGFIX] uriPathSegment handling is slow and unreliable
-----------------------------------------------------------------------------------------

This change fixes two issues with the mechanism which assures the
uniqueness of uriPathSegments among node siblings:

  1. Updating document nodes with lots of siblings was extremely slow
  2. Newly created nodes will get a non-human-friendly uriPathSegment if
     the proposed name was already taken by a sibling.

A severe side-effect was introduced with the change
``I2315d30256f7d291204363fdde7e761154cbc7e4``, making
adding/updating nodes extremely slow when a node has many siblings.

Multiplied by the check happening for every given node property change,
can lead to timeouts.

This changes the behavior to only do the necessary check if it's
actually needed, in case of new nodes, updating the ``uriPathSegment``
property or changing the path of an existing node.

Fixes: NEOS-1059

* Commit: `a90dfc9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a90dfc9ac2bc9d6f5db2b30b593a8550ba0d8fb5>`_

[TASK] Document default Eel helpers in context
-----------------------------------------------------------------------------------------

This adds a list of Eel helpers available in the context by default to
the section on "Eel and FlowQuery" in the "Integrator Guide".

* Commit: `1705079 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/17050792b87c7a25823606dae837dd9233f6a2b2>`_

[TASK] Adjust to deterministic Adjustment order in Media
-----------------------------------------------------------------------------------------

With the change I0b31c216c983393e19055f7db07d1ea2beb9ac9f all image
adjustments have a defined order that needs to be preserved. The
UI needs to reflect that.

Depends: I0b31c216c983393e19055f7db07d1ea2beb9ac9f

* Commit: `4e337a2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4e337a2da032243de778c510056dbde42c3929c5>`_

[BUGFIX] Search field in media browser/list overflows
-----------------------------------------------------------------------------------------

The submit button for the search field in the media browser/list
overflows it's container.

Depends: I5f388e64cd9a498ae0ac7b4c2afaf3e8f349fb7a

Related: NEOS-832

* Commit: `6da9621 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6da9621dcffc43d9fdc2431bc7b4fa2d03099831>`_

[TASK] Improve tagging user experience in media browser/module
-----------------------------------------------------------------------------------------

- Display visual feedback when dragging assets in thumbnail view
- Improved styling of tag dropzones
- Display loading indication when an asset is dropped on a tag
- Display move-icon in list & thumbnail view instead of cursor pointer
- Display indication when creating new tag
- Display blue outline when hovering assets in thumbnail view
- Make tags more visible in list view

Depends: I065534694ade7a64ca34fd7932f56518c017d042

Resolves: NEOS-1018
Resolves: NEOS-336
Resolves: NEOS-454

* Commit: `1e120bb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1e120bb2bbe6a0ea4a7c5e585a5143240d8917af>`_

[FEATURE] Support non-HTML formatted backend module requests
-----------------------------------------------------------------------------------------

Support request to backend module to respond with JSON
formatted output. This enables AJAX request inside modules
without having to circumvent the module framework.

No wrapping is added around the content of JSON formatted
responses like it is with HTML responses.

* Commit: `157730b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/157730b28aad57a1d549f452b9ca83d3cdfec5c5>`_

[TASK] Move release notes to a new home in documentation
-----------------------------------------------------------------------------------------

This adds a home for release notes to the documentation and moves the
release notes that were in the change logs there.

While being at it, we also added a stub for the release notes of the
upcoming version 2.0.

* Commit: `6458cbf <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6458cbf8ef7e65ab4601acf2a4f31e3ea2cc3ca5>`_

[BUGFIX] make error/exception handling more robust - allowing to reload in case of an error
-------------------------------------------------------------------------------------------

Currently, if an error during rendering occurs, and then the user reloads
this document where the error occurs, the Neos backend breaks. This is because
some required context information is not added to neos-document-metadata,
breaking the page tree and the global workspace status indicator.

This is a regression introduced by  Ia8fa5228e772b0fee15921e02135c4899df39c0a

* Commit: `fb4b369 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fb4b3697d37afaa9414e3915d5d616661de20b7f>`_

[BUGFIX] user:addrole and user:removerole are broken
-----------------------------------------------------------------------------------------

This fixes a regression which was introduced in patch set #14 of change
I8a4c7010e25842583538e32dc8ef9cd851f306b4. As a result, roles could not
be added or removed via the command line interface.

Related: NEOS-962

* Commit: `80e8245 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/80e82451a3776dc0b325143530102683a290a621>`_

[BUGFIX] Bring back event log table migration for MySQL
-----------------------------------------------------------------------------------------

In change I8a4c7010e25842583538e32dc8ef9cd851f306b4 the migration for
MySQL from I1b44f47787c2ebaf3c40dce952fc82cd0f6ae43e was removed by
accident.

* Commit: `2b88a94 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2b88a94602d73e9ef988bdd00f4679c9977fc83e>`_

[!!!][TASK] Add code migration for ImageVariant to ImageInterface change
-----------------------------------------------------------------------------------------

This is a follow-up to
"[TASK] Adjust to new Flow resource management / new media management"
(Ic81c6595cb6594735206be8422cea5def01fbda7) that replaced the inspector
data type `ImageVariant`` with ``ImageInterface``.

This change is marked breaking in order to raise awareness.

To adjust your configuration, you can simply replace occurrences of
``TYPO3\\Media\\Domain\\Model\\ImageVariant`` by
``TYPO3\\Media\\Domain\\Model\\ImageInterface`` in your ``NodeTypes.yaml``
configuration and in your ``*.ts2`` files.

Alternatively you can execute code migrations on your site package(s)::

      ./flow flow:core:migrate --package-key <sitepackagekey>

Related: NEOS-883

* Commit: `4fccd15 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4fccd1558d0a16cc3bd1bfe1096c2ad2029dc3b7>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `6ad5125 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6ad512563ea98e48724494959983e5a95006df31>`_

[TASK] Add Polish to available UI translations
-----------------------------------------------------------------------------------------

This adds Polish to the list of available Neos UI translations.

Resolves: NEOS-1026

* Commit: `db816fe <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/db816fe3b10e8436ec5db0d1b0bf8f6c6a26b4b9>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `e953650 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e95365092b289e58482eef08cb0ffb5bacee34e0>`_

[TASK] Improve usability of sites administration module
-----------------------------------------------------------------------------------------

To make administration of sites more user friendly and clear,
a series of improvements are done:

- Group all sites by their site package
- Show site packages without any site instances
- Each site package is collapsable
- Color of warning badges are different than important badges
- The amount of domains are shown in the overview
- If domains are configured, the first active one is displayed
- New domains are by default active
- Instead of a state column a badge is added for less common states
- The site package name links to the package administration module
- Site package state is displayed if deactived or unavailable
- If a deactived site package contains site instances it's marked
  with a important badge instead of a warning badge
- If no domains are configured and there's multiple site instances
  the domain counter is marked with an important badge
- If no sites instances are available for a site package a message
  is shown instead

Additionally some changes are done to the package administration
module to keep consistency.

* Commit: `d1bb1c3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d1bb1c3f9a1eae4a15168feb24abb200319b805d>`_

[FEATURE] Introduce signals for user domain service
-----------------------------------------------------------------------------------------

This introduces a row of signals for the user domain service.

Related: NEOS-962

* Commit: `b012a8c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b012a8ccc240be3e604c244986e2178870e2e30c>`_

[TASK] Adjust to moved context dependent TypoScript exception handler
-----------------------------------------------------------------------------------------

The exception handler has been moved to the TypoScript package instead,
thus the Neos one is removed and replaced with the new one.

Depends: I3fa9282943c239d973d6d787656e6dbd3656c1fc

Related: NEOS-898

* Commit: `23dc2fd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/23dc2fdd5396c825edd1434a67dd9d0c8a56110f>`_

[!!!][FEATURE] Centralized Neos user domain service
-----------------------------------------------------------------------------------------

This change centralizes the management of Neos users by introducing a
domain service and refactoring code which previously created, deleted
and updated users.

The user management module has been refactored to rather deal with
User objects than with Account objects.

The ``UserService`` provides all important methods for creating, updating
or deleting users  including managing roles and passwords  and is
intended for carrying out additional tasks whenver users are changed.

The ``UserCommandController`` has been refactored and now uses the new
UserService. Along the way the output of a few of the commands has
been improved.

The ``AccountExistsValidator`` has been renamed to ``UserExistsValidator``.
The ``UserFactory`` (non-API class) has been removed.

Non-backwards-compatible behavior:

The ``user:remove command`` has been renamed to user:delete. Additionally
it drops support for the "--confirmation" option and now interactively
asks for confirmation. For automation purposes the "--assume-yes"
parameter can be used in order to assume "yes" for all interactive
dialogs.

Resolves: NEOS-962

* Commit: `a844700 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a8447000778d3a51c8dd4b1428a70938dba7750a>`_

[BUGFIX] Crop view can be opened regardless of it being disabled
-----------------------------------------------------------------------------------------

Clicking image in image editor opens crop view even though the
cropping feature is disabled.

Fixes: NEOS-1051

* Commit: `5435313 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5435313784145c9a7def342dd3523fb700c28680>`_

[BUGFIX] Cropping in the image inspector editor disabled by default
-----------------------------------------------------------------------------------------

Since the resource refactoring it is possible to disable cropping in
the image inspector editor. As a new default cropping is disabled by
default, this changes it to be enabled by default instead.

Resolves: NEOS-1049

* Commit: `ec638a2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ec638a25b31213099d4fc705fdf54e3562bea1d0>`_

[BUGFIX] Secondary inspector close button hidden behind HTML editor
-----------------------------------------------------------------------------------------

Related: NEOS-124

* Commit: `3cb638a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3cb638ae3aae6c7418926b9d4d8abc6bdb23b00e>`_

[FEATURE] Search field in media browser/module lists
-----------------------------------------------------------------------------------------

Adds a search filed in the sidebar of the lists of the media
browser/module to filter the assets based on their filename, title,
description or tags.

Depends: I32be341073b0e027a7722380408df5b4af04b7c9

Resolves: NEOS-832

* Commit: `a591445 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a59144586a7d4f515bda3893bc7f80f13bc4f77c>`_

[BUGFIX] Send JSON Content-Type response header in xliff.json
-----------------------------------------------------------------------------------------

Related: NEOS-435

* Commit: `b394a89 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b394a897bf32a0193fa56bbbd1b27b3f4eb3e461>`_

[TASK] Clear Xliff service cache on translation file changes
-----------------------------------------------------------------------------------------

Clears the ``TYPO3_Neos_XliffToJsonTranslations`` when the files
have changed monitor triggers with the type ``Flow_TranslationFiles``

Additionally optimizes the ``TYPO3_Neos_Configuration_Version`` cache
clearing only to occur for necessary types.

Resolves: NEOS-451

* Commit: `db2e595 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/db2e5957d52e61fc233c1fe31778f9e7edb12c86>`_

[TASK] Streamline navigate and inline delete dialogs
-----------------------------------------------------------------------------------------

Streamlines the navigate component's delete dialog with the inline
editing's delete dialog. Also removes the usage of the term ``page``,
since it's used in the node and structure tree.

Fixes: NEOS-869

* Commit: `b0811e9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b0811e9146ca3f12b7470cb87933e32d4c175db5>`_

[TASK] Preview of image thumbnails in media list view
-----------------------------------------------------------------------------------------

Shows a flyout with a larger preview of image assets when
hovering the thumbnail in the media browser/module list view.

Depends: Ie511edefd812e3bc1b8c12334d87388dd444a20a

Resolves: NEOS-1021

* Commit: `d258a8f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d258a8fe354d1fa9d91897ee1d1cf9c8793460f3>`_

[BUGFIX] User menu and publish menu dropdowns do not open
-----------------------------------------------------------------------------------------

A regression introduced in Ic013e0e6980886ad1c73a56eaae63b9ca771dbc7

* Commit: `6876173 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6876173b02d33676aa779842ff4663c5abc6bc9f>`_

[BUGFIX] Circular dependency causing unexpected behavior
-----------------------------------------------------------------------------------------

A require dependency to itself caused unexpected behavior
and broke things randomly in the content module.

Regression introduced with I160263ccd4cac3f6d749b14a7e703dc53d4e7cfe

* Commit: `d026a9c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d026a9cdf3a56003ad2dd9659c6ab0852bc23c27>`_

[TASK] Close button for secondary inspector
-----------------------------------------------------------------------------------------

Adds a close button in the top right corner of the
secondary inspector, making it possible to close
without having to click the opening button again.

Resolves: NEOS-124

* Commit: `c95666c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c95666cc39d5e007454640ad0cf06b294a310993>`_

[BUGFIX] Correct upload button label
-----------------------------------------------------------------------------------------

As the uploads now start directly there is only the ``Choose`` button
left which is a bit misleading in the ImageEditor. The button was thus
renamed to ``Upload`` because that is the actual action that happens.
Additionally some unused code in the ImageEditor template was removed.

Resolves: NEOS-125

* Commit: `f587def <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f587def2c223069566179a4ab45af10eac539418>`_

[BUGFIX] Prevent call to undefined getContext() on a non-object
-----------------------------------------------------------------------------------------

This change fixes the situation that $documentNode was set to
TRUE when it is set while it should be set to the actual
node object.

Regression introduced in I4cd01ee64a293d5ac2da75013e0fe3cfcddad5a9

* Commit: `2147f5f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2147f5ffd63f85a07e9c9806e1e528857d64dea6>`_

[BUGFIX] Clear asset import cache in tests
-----------------------------------------------------------------------------------------

Functional tests that import assets need to clear
the first level cache of the TypeConverter to avoid unwanted
side effects.

* Commit: `b215979 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b215979aca55f8ca7d014785ddbbfd5b2604d011>`_

[TASK] Mark recent core migrations applied
-----------------------------------------------------------------------------------------

This commit doesn't contain any changes, it simply marks recent
migrations applied so that::

  ./flow flow:core:migrate --status

won't show any open migrations for this package.

* Commit: `b6545b1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b6545b1544f065ba57555f9d8b8b1bf7914ca9ba>`_

[BUGFIX] Select2 leaks to global space
-----------------------------------------------------------------------------------------

Select2 writes a Select2 variable directly to the global
scope which causes problems with website frontends that
use jQuery and Select2. This change uses grunt to move
the definition of window.Select2 to the Shared/Utility
module in Neos.

* Commit: `c74cda7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c74cda715bc8cb85cb599fcc8f138785912ec4a8>`_

[TASK] Remove Neos CacheManager
-----------------------------------------------------------------------------------------

This change removes the class \\TYPO3\\Neos\\Cache\\CacheManager. The service
is currently only used in one single place
(ConfigurationCacheVersionViewHelper). Instead of providing a service
for this task, the view helper will now determine the configuration
cache version itself.

Also removes the unused property $cacheManager from
JavascriptConfigurationViewHelper.

* Commit: `a578bae <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a578baea019a68419dff5a713e393cb6af1978c0>`_

[FEATURE] Node type filter support in site:export command
-----------------------------------------------------------------------------------------

Adds an option parameter to the export command to filter out certain node
types in a site export. Example of excluding news articles::

  ./flow site:export --nodeTypeFilter \\!Acme.Site:Article

Resolves: NEOS-438

* Commit: `123d234 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/123d2347f9c578b60b6e7986272b06e9a9c56e16>`_

[BUGFIX] Tear down the context created in the tests
-----------------------------------------------------------------------------------------

The context cache can lead to side effects in other test cases
so it should be cleared even if there is only one test.

* Commit: `f6c57e0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f6c57e0ded2d0c1521a1e8ec23054ce539992374>`_

[BUGFIX] Event model database and schema mismatch
-----------------------------------------------------------------------------------------

A hack was used to add auto_increment to the uid property of the event
domain model, causing a mismatch between the schema and the database.
This breaks the doctrine:update command making it impossible to update
the database based on the schema.

To fix it a proper Doctrine generator is used for handling the
auto_increment across database types. Additionally the uid is used
as the identifier and it's marked as signed.

Fixes: NEOS-984
Related: NEOS-655

* Commit: `86decad <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/86decadbf4cb69dc24d539e878ac4c20c3c161b1>`_

[TASK] Add schema validation rules for Inspector views
-----------------------------------------------------------------------------------------

Related: NEOS-760

* Commit: `33e83e8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/33e83e8695deb252dc413412f210ba1f43aac7d7>`_

[FEATURE] Display file size and last modified in media list view
-----------------------------------------------------------------------------------------

Adds two new columns in the list view with file size and last modified
information. The last modified date is shown relative to the current
date, for easier distinguishment.

Additionally makes it possible to change the sorting by clicking the
name or the last modified table header.

Depends: I41ee9b90b4ae3a1d290d22c07d1732d556a9ce10

Resolves: NEOS-1022

* Commit: `bf54e51 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/bf54e5130ae0a7c7fd2e046e285814d169212f1c>`_

[TASK] Site import/export end-to-end test
-----------------------------------------------------------------------------------------

Adds a functional test case covering basic import/export scenarios.

Related: NEOS-1003

* Commit: `462f768 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/462f768b2e83024549818dc551115483c396a3e6>`_

[FEATURE] Sorting/filtering options in media browser/module
-----------------------------------------------------------------------------------------

Styling for sorting/filtering options in the media browser/module
lists.

Depends: I31fbb39715130fd8dc306cb6a3b632cd941c18d0

Resolves: NEOS-1023

* Commit: `c6e79ae <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c6e79aecfb60a9ead1cec434ce0dffb8f1af9f6f>`_

[FEATURE] Support dropdowns, tooltips, popovers in modules
-----------------------------------------------------------------------------------------

Adds support for using dropdowns, tooltips & popovers in backend
modules. Use the following attribute to enable the
functionality::

  data-neos-toggle="popover"
  data-neos-toggle="tooltip"
  data-neos-toggle="dropdown"

The components are based on Boostrap 2.3, but all CSS classes are
prefixed with "neos-\*" to avoid conflicts with normal bootstrap usage.

* Commit: `fd19408 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fd194082b0f91826ba4c2230e00b1484a6b27697>`_

[BUGFIX] Adjust to typo fix in namespace of NodeOperationsTrait
-----------------------------------------------------------------------------------------

A follow-up to Ibb8a59d78b02efa72de68e6d08d455ea262ff1fe that fixed the
namespace of the ``NodeOperationsTrait`` but did not adjust the using
code accordingly.

Related: NEOS-28

* Commit: `8ecd2b3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8ecd2b36c7636be2f845474c260a3697643de328>`_

[BUGFIX] Remove obsolete account in context tests
-----------------------------------------------------------------------------------------

The two unit tests about adding the ``account`` to the TypoScript
context have become obsolete by removing the ``account`` from
the context and using an EEL helper instead.
Therefore these tests are removed.

* Commit: `52bc48f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/52bc48fd4f85e000fc1f0f67b5b4543af53aa450>`_

[TASK] Display upload progress in media browser/module
-----------------------------------------------------------------------------------------

Display upload progress per file when uploading assets in the media
browser/module using the drop zone in the thumbnail/list views

Depends: I20fa172005d70cc535ff97bdb31c6ac83e039154

Resolves: NEOS-877

* Commit: `0e5f8ae <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0e5f8ae093bf18ec360127794b7a745577ee54ef>`_

[TASK] Change border-style when hovering image editor drop zone
-----------------------------------------------------------------------------------------

Related: NEOS-606

* Commit: `02ce79f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/02ce79f41814ce1124082b48b1226eeba76c34df>`_

[TASK] Adjust to typo fix in namespace of NodeOperationsTrait
-----------------------------------------------------------------------------------------

* Commit: `858970e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/858970e623f5e55da08ee351421909b36be35b7e>`_

[TASK] Remove obsolete RoutingLoggingAspect
-----------------------------------------------------------------------------------------

The RoutingLoggingAspect adviced methods in TYPO3\\Neos\\Service\\NodeService,
but that class does not exist anymore. If we need this kind of logging
again, it should be implemented directly in the respective class and
probably not via an aspect.

* Commit: `9513001 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/951300101f74e61ef14d933363230a81dd7fa4f9>`_

[FEATURE] Universal argument for site:import
-----------------------------------------------------------------------------------------

This change adds a third way for site:import to specify either the
filename or package key to import from: if neither --package-key
nor --filename is specified, Neos will try to detect an "exceeding
argument" and use it as filename or package key automatically.

Releated: NEOS-638

* Commit: `d1b44ce <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d1b44ceee3b31ca7c4dcef8491786299cf03a97a>`_

[BUGFIX] Content collections show same cached content
-----------------------------------------------------------------------------------------

A regression introduced with I68f309ee84f4688446ae2c969b4cfaef84f52455,
led to all content collections being cached with the same empty
entry identifier. This meant that all content collections showed the
content of the first one being cached.

* Commit: `0fa703b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0fa703bd021f831e330d9d690d49ec6f315bcaf8>`_

[!!!][BUGFIX] Account should not be available in the context
-----------------------------------------------------------------------------------------

The current account entity should not be available in the context
but rather retrieved via global context or EEL helper.
Having it in the context leads to serialization of the account
which is not a good idea. Also depending on the cache configuration
you might get an old account.

This fix uses the new SecurityHelper introduced in accompanying
changes to get the account entity for rendering the backend information.
It drops account from the context.

This is marked breaking if you use the context variable ``${account}``
in your own TypoScript. You should instead use
``${Security.getAccount()}`` to retrieve it. Therefor you should also
remove all usage of account in safed contexts for uncached TypoScript
objects.

Resolves: NEOS-1012

* Commit: `e051d41 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e051d411e0c9929557cde81d30b42836ebb3e946>`_

[BUGFIX] Fix undefined $ in ViewView.js
-----------------------------------------------------------------------------------------

The generic views code lacked an import of jQuery so it failed e.g. on
Shortcut pages. This change adds the needed import.

Related: NEOS-760

* Commit: `21064c2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/21064c2c5ffbcd4bf320f4835607ab224b4a9704>`_

[BUGFIX] Page exception handler should assume no nodes set.
-----------------------------------------------------------------------------------------

To prevent raising an error during exception handling the
``PageHandler`` needs to check if ``node``, ``documentNode`` and
``site`` are actually set before using them.

* Commit: `c007d82 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c007d8297a64f0e497f842d1bfff05ccd30cf6d6>`_

[BUGFIX] Fix rendering of HTML in translated string
-----------------------------------------------------------------------------------------

This fixes the rendering of HTML in the backend template for
FlashMessages and in the History module.

Background:
Since the "Consistent escaping behavior" of Fluid (see
1e4cd0942dcf7b0726f3d3892bf8713cba89e9a4) the output of the translate
View Helper is escaped for security reasons, disallowing the usage of
HTML within translation labels unless the using side explicitly allows
it by using the ``{f:format.raw()}`` View Helper.

* Commit: `406024e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/406024e6dbe7b8a18f0350cec051fd8abb7e9731>`_

[BUGFIX] Adjust to "Decoupling of Party package"
-----------------------------------------------------------------------------------------

A follow-up to Ic16f9daffc7dfda6870471a785271ef167b5a8a7 that relaxes
the dependency to ``typo3/party`` in order to prevent deadlocks when
updating before version 3.0 is released.

Related: FLOW-5

* Commit: `a184dcd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a184dcd2b9cd1370ee16ac88496c81e174f165d4>`_

[TASK] Adjust to "Decoupling of Party package"
-----------------------------------------------------------------------------------------

This adds a dependency to the ``TYPO3.Party`` package because that
package is no longer required by ``TYPO3.Flow`` (since the "Decoupling
of Party package" change, I1a5dee5729fa73229b29d11c9f828eb803eb6b24).

Related: FLOW-5

* Commit: `49aa9b9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/49aa9b99908b9902dbd142e1260e34f769303186>`_

[BUGFIX] Make FloatValidator JS implementation require correct xregexp
-----------------------------------------------------------------------------------------

The xregexp library required was nowhere to be found. This change fixes
that.

* Commit: `3a3ba7f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3a3ba7fccc3e4d5affc487c293a3db4cbba726d5>`_

[FEATURE] Display additional information about node in inspector
-----------------------------------------------------------------------------------------

This change adds a read only inspector editor showing additional
data about the node like the creation date and last modification date.

Depends: I1d8ec81971f1c185a7b8f94c80777dc7cdc04545

Resolves: NEOS-605

* Commit: `9be9b68 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9be9b6812b103a3c9c1fbed7b4d8a301d0f7c820>`_

[TASK] Skip CSRF protection for NodeController
-----------------------------------------------------------------------------------------

This adds a ``@Flow\\SkipCsrfProtection`` annotation to the
``showAction()`` in order to ignore any CSRF tokens for this
action.

Background:

When the ``showAction()`` is triggered with an sub request that is
not "safe" (e.g. a POST request by a plugin on the current page) the
CSRF token has to be validated when dispatching the sub request.
Previously ``SkipCsrfProtection`` annotations in the target action
of the plugin or Fluid widget were ignored because CSRF protection
was already enforced while dispatching the main request.

Related: FLOW-130

Depends: I2ccdcec97ce9fc9dcf84b9127c4f18ea800abe74

* Commit: `2915c55 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2915c55b0e903c33974e8aacced4164af5465912>`_

[BUGFIX] Fix rendering of HTML in translated strings
-----------------------------------------------------------------------------------------

This fixes the rendering of HTML in the backend template for shortcut
nodes and removes the translate ViewHelper from the login screen.

Background:
Since the "Consistent escaping behavior" of Fluid (see
1e4cd0942dcf7b0726f3d3892bf8713cba89e9a4) the output of the translate
View Helper is escaped for security reasons, disallowing the usage of
HTML within translation labels unless the using side explicitly allows
it by using the ``{f:format.raw()}`` View Helper.

See also change I8bc508a72b6d8ae4104b16a2efb2e0e2381510a6

* Commit: `2726de7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2726de742b45b87d01602ebdf5d4784e2165162b>`_

[!!!][TASK] ContentCollection overwrites node directly
-----------------------------------------------------------------------------------------

Instead of creating another context variable the
ContentCollection TypoScript can directly overwrite ``node``
which reduces the amount of needed code and the context
dependencies of rendered content as it cannot use the
context variable. If a content element needs to know it's
ContentCollection it can use FlowQuery to find it.

This is breaking if you rely on the ``contentCollectionNode``
variable being set. You can retrieve the nearest
ContentCollection via FlowQuery.

* Commit: `34eb60c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/34eb60c95bacdad40dd0677f7035adbfe1fb9e1e>`_

[!!!][TASK] Add charset and collation to all MySQL migrations
-----------------------------------------------------------------------------------------

This change set adds charset and collation to create table statements
in the existing migrations. This make sure the tables are set up
correctly independent of the database default configuration.

Also migrations generated contain this information since a while,
leading to problems on migration if the database is not using the same
charset and collation.

This is breaking if you have existing tables that do not use the utf8
charset and utf8_unicode_ci collation. To solve this you need to convert
the existing tables. This can be done using the command::

  ./flow database:setcharset

Related: NEOS-800

* Commit: `e510b2f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e510b2ff5960f6d1bbf1f0fab82269387ce2aea3>`_

[TASK] Removed deprecated use of Inject for settings
-----------------------------------------------------------------------------------------

This removes the use of the Inject annotation for settings and instead
uses the new InjectConfiguration annotation instead.

Related: FLOW-148

* Commit: `03ced44 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/03ced44072218f56c5f8c91617f7f88c81eb0caf>`_

[TASK] Adjust to "Fluid: Consistent escaping behavior"
-----------------------------------------------------------------------------------------

Adds "escapeOutput" property to existing ViewHelpers to ensure
backwards-compatibility.

Depends: I1e4cd0942dcf7b0726f3d3892bf8713cba89e9a4

* Commit: `a08b8a8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a08b8a8abb4a85f3e06bf74bdbeda9ff0b938316>`_

[BUGFIX] Fix spelling of "Add new site" button
-----------------------------------------------------------------------------------------

* Commit: `9465d68 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9465d68e8bbf0443bac54d9f81328fd5af29f563>`_

[TASK] Log exceptions during import to the log
-----------------------------------------------------------------------------------------

Related: NEOS-991

* Commit: `c569724 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c56972422c78fd7440776d49a363277e891b16d3>`_

[TASK] Import Arrays namespace in ModuleController
-----------------------------------------------------------------------------------------

In the method indexAction of the file
``TYPO3\\Neos\\Controller\\Backend\\ModuleController`` the usage
of TYPO3\\Flow\\Utility\\Arrays was referred twice. Instead the
namsepace is now imported.

* Commit: `fa14c67 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fa14c67f619b15a511297b25017794cf0c2f8f01>`_

[BUGFIX] Allow editing of documents as content elements
-----------------------------------------------------------------------------------------

This fixes a regression introduced with
Ia11ac5b6c7bef4c30e005b53f21215d0b17637c1 which resulted in document
nodes not receiving the ``neos-contentelement`` class which made them
inaccessible for the inspector. By introducing a flag to render this
special type of document metadata only if asked for it, the regression
is fixed.

* Commit: `88fdd67 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/88fdd672159bcc6fc4692585712f24367b53e735>`_

[TASK] Add changelog for TYPO3 Neos 1.2.2
-----------------------------------------------------------------------------------------

* Commit: `efc6d20 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/efc6d2031c3eb0e7528863d65efa0f498ee85708>`_

[BUGFIX] Unsetting node properties not possible
-----------------------------------------------------------------------------------------

Correct handling of node properties set to null (unset).

Fixes: NEOS-973

* Commit: `efbca59 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/efbca590b09405ca2ddc1d019d19e6e7dadd2e02>`_

[TASK] Fix reST syntax errors in documentation
-----------------------------------------------------------------------------------------

Resolves: NEOS-982

* Commit: `64cf13e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/64cf13ea02cc0fe1057e658627897cbfa5b2935e>`_

[BUGFIX] Empty integer values are converted to array by vie
-----------------------------------------------------------------------------------------

When a node type has a property of type integer without a default
value configured the content element wrapping service wraps an
empty attribute for that property. When vie reads the entity
from the DOM it converts the attribute to an array containing a
list of NaN string values.

Besides converting the value it adds an exception to the
HtmlAugmenter service that will be thrown if invalid attributes
are passed.

Resolves: NEOS-579

* Commit: `0e41058 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0e41058d0204d4067a2b37a9279620d2e39e74f0>`_

[TASK] Adapt to asset model mapping strategies
-----------------------------------------------------------------------------------------

The implicit decision of Asset type in the ImageTypeConverter is
not reliable and is therefor moved to the media package as a
strategy. This allows removal of the ImageTypeConverter but makes
property mapping configuration necessary.

Relates: NEOS-936

* Commit: `d47bf7d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d47bf7d69008def52ca5d49bfec1b395f5919d74>`_

[BUGFIX] Aloha list type styles missing in Raw Content Mode
-----------------------------------------------------------------------------------------

Fixes: NEOS-889

* Commit: `7aff167 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7aff1676873de7e834aac802714202dd0a46fafa>`_

[BUGFIX] Deletion of rows/columns in Aloha tables
-----------------------------------------------------------------------------------------

Selecting a row or column in an Aloha table and clicking
to delete it in the inspector, a Javascript error is
thrown due to jQueryUI missing the dialog widget. This
change adds that widget and styles the dialog to look
like the standard dialog boxes.

Fixes: NEOS-810

* Commit: `cae2588 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cae2588ef2c3c952a7c8068946786586b8205bd1>`_

[BUGFIX] Fix functional test regressions
-----------------------------------------------------------------------------------------

The change I06ba604f562685e3a1d5ee844a8adaec7eda20f5 introduced
a functional test regression as errors were not catched correctly.
The problematic case is an edge case but should still work
correctly.

The adjustments to the TypoScript take care of that.

Releaes: master

* Commit: `a36ad11 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a36ad111023f6184e3d300125b482a05150736f3>`_

[TASK] Only store "lastVisitedNode" in session if it has been started
-----------------------------------------------------------------------------------------

This change adjusts the ``NodeController`` to only store the
"lastVisitedNode" in the user session if it has been started before.
Usually that won't have any effect because an authenticated backend user
will start a session anyways. But it allows for replacing the default
``Typo3BackendProvider`` with a stateless implementation.

* Commit: `d183a1a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d183a1abbf5e5b70c982a96a3aa20b6f469787ef>`_

[TASK] Remove deprecated ContentElementViewHelper
-----------------------------------------------------------------------------------------

The ContentElementViewHelper is deprecated and due for removal.

* Commit: `424e9d9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/424e9d98edd5459b0100604d270f74c66688b1b0>`_

[TASK] Fix warnings during reStructuredText rendering
-----------------------------------------------------------------------------------------

This tweaks rst files to get rid of some warnings that are emitted
during documentation rendering.

* Commit: `4c461fb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4c461fb34024c389560e4e8c0d9c7c0bb39beb86>`_

[TASK] Fix warnings during reStructuredText rendering
-----------------------------------------------------------------------------------------

This tweaks rst files to get rid of some warnings that are emitted
during documentation rendering.

* Commit: `2a0aabc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2a0aabcbc2eab5504167bca3aaa4df20692a1dd7>`_

[TASK] Add documentation about global cache entry identifiers
-----------------------------------------------------------------------------------------

Related: NEOS-852

* Commit: `ae3f315 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ae3f31550bcbad1772272290da925c757e317745>`_

[BUGFIX] Avoid exceptions in FrontendNodeRoutePartHandler
-----------------------------------------------------------------------------------------

This change makes the FrontendNodeRoutePartHandler return FALSE in case
a NoSuchDimensionValueException is thrown in matchValue(). This makes
it possible to continue with routing to find other possible matches.

Fixes: NEOS-923

* Commit: `ded6600 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ded66005882af7784484673ce598d09742fa282c>`_

[TASK] Remove unused leftover function arguments
-----------------------------------------------------------------------------------------

In the ImageEditor parseInt() was changed to round() but one of the
arguments to parseInt() was left in place. Confusing at best.

* Commit: `8fcedd7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8fcedd77c4946df7254303288de80f99de6eeddc>`_

[TASK] Append number instead of uniqid to duplicate uriPathSegments
-----------------------------------------------------------------------------------------

When a uriPathSegment is duplicated on the same level a uniqid is appended
to avoid conflicts. However this is not very user friendly, so instead a
number is appended which additionally has a chance of not needing to be
changed afterwards.

Related: NEOS-970

* Commit: `41c18c5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/41c18c5bbc75114d9e759b5a3ade80aeb9becf24>`_

[FEATURE] Drag and drop support in image inspector editor
-----------------------------------------------------------------------------------------

Enables uploading images in the image inspector editor by
dragging images and dropping them on the image preview.

Resolves: NEOS-606

* Commit: `e9672a4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e9672a41fcea08e8cc54a60fdadd46f853bd549d>`_

[BUGFIX] Close crop view when uploading image in image inspector
-----------------------------------------------------------------------------------------

A regression introduced in Ic81c6595cb6594735206be8422cea5def01fbda7,
where the functionality is unintentionally removed.

Related: NEOS-557

* Commit: `2ba17a2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2ba17a2b4297cdd2c172e7294155c8930014b992>`_

[BUGFIX] Update cropping coordinates when changing aspect ratio
-----------------------------------------------------------------------------------------

When dragging the lower right corner of the crop field,
the changes are not taken into account.

A regression introduced in Ic81c6595cb6594735206be8422cea5def01fbda7

Related: FLOW-108

* Commit: `739d493 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/739d493a8f2a20326d892c8364c885859d681924>`_

[BUGFIX] Prevent unnecessary changes with locked aspect ratio
-----------------------------------------------------------------------------------------

Loosens the check if the aspect ratios of the image matches
the locked aspect ratio, caused by rounding issues.
This is done to avoid unnecessary changes when selecting image
elements with locked aspect ratios.

Fixes: NEOS-872

* Commit: `45a334b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/45a334b3b14f276e14810dbfc057f746b5c31256>`_

[TASK] Select crop aspect ratio option automatically
-----------------------------------------------------------------------------------------

If the crop coordinates matches an existing crop aspect ratio option,
that option is selected automatically since it's very likely it was
used to created the existing crop.

Additionally makes it possible to set the default option, making it
possible to select a certain option if no cropping has been applied
already. This is useful when having a default aspect ratio, but still
want to have it flexible. Configuration example::

  editorOptions:
    crop:
      aspectRatio:
        defaultOption: 'fourThree'

Avoids selecting the original aspect ratio option and the custom option,
since it's possible to tell if it was done using a custom aspect ratio
or manually.

Resolves: NEOS-871

* Commit: `d795015 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d7950156714654e51330956deeac0ef15a7882a1>`_

[BUGFIX] Apply locked aspect ratio immediately
-----------------------------------------------------------------------------------------

A regression introduced in Ic81c6595cb6594735206be8422cea5def01fbda7,
where the functionality is unintentionally removed.

Related: NEOS-557

* Commit: `57b8740 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/57b8740b0a7786f307d1be6692b06a6fc65efe5e>`_

[BUGFIX] Dummy image not displayed in image inspector editor
-----------------------------------------------------------------------------------------

After the resource refactoring the dummy image was no longer
shown when no image has been selected.

This also removes crop and resize controls as long as there
is no image selected.

A regression introduced in Ic81c6595cb6594735206be8422cea5def01fbda7

Related: FLOW-108

* Commit: `78e4ac8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/78e4ac8e7075d190e2fd22414ce6c599722eea08>`_

[BUGFIX] Copying nodes created duplicate uriPathSegment entries
-----------------------------------------------------------------------------------------

On duplicating a document (page), the uriPathSegment property was simply
copied as well, resulting in the same URI for two distinct documents if
the copy is a sibling of the original nodes.

This change amends the slot used to fill the uriPathSegment so those
duplicates are avoided upon copy and can also no longer be caused by
manually passing a used uriPathSegment.

Fixes: NEOS-970

* Commit: `078b7dc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/078b7dc04cf8d8cc9080e175023ef51cc9719169>`_

[BUGFIX] Media button activated across editors
-----------------------------------------------------------------------------------------

Having multiple properties using instances of either
the image or asset editors, clicking the media browser
button will result in all buttons being shown as active
at the same time. This is prevented by creating separate
instances for each editor.

Fixes: NEOS-756

* Commit: `2123e45 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2123e450960bdee6825b40bc836f0748fc44415f>`_

[TASK] Adapt to GlobalCacheIdentifiers prototype
-----------------------------------------------------------------------------------------

As the new prototype is used as default for generating cache identifiers
in Neos the ``domain`` and ``format`` can be removed from all cache
configurations.

Related: NEOS-852
Depends: I3d172b0ebfe54afc37b6eaa8397e8c2355a7d7da

* Commit: `36d2646 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/36d26465366cbbce91f7b93c53ef52cffaff9fb5>`_

[BUGFIX] Configuration module not displaying content
-----------------------------------------------------------------------------------------

The configuration module does not display any configuration
when loadMinifiedJavascript is enabled in Firefox. This happens
due to depending on a global configuration variable which is unset
when read in the Ember application. This only happens in with the
minified build due to JavaScript execution order. Instead of relying
on the global variable, we set the explicit path to be used instead.

Fixes: NEOS-881

* Commit: `a2632bb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a2632bb631a5750d55a81c166c4d7091ee4e8987>`_

[BUGFIX] Render service exceptions as JSON
-----------------------------------------------------------------------------------------

Adjusts the ``AbstractServiceController`` to catch all exceptions that
occur during request processing in order to convert them to JSON::

    {
      "error": {
        "code": 12345,
        "message": "Exception message",
        "details": "Optional message details",
        "referenceCode": "2015012315120876d8b2",
        "previous": {
          "code": 54321,
          "message": "Nested child exception"
        }
      }
    }

"details", "referenceCode" and "previous" are optional.

Note: This is a preliminary solution that improves error handling in
Backend. In the long term the exception handling of Flow will be
improved and this hotfix be deprecated.

Related: NEOS-108

* Commit: `fed656a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fed656aad69ece66bd52774623284d8c6bfe0ec1>`_

[TASK] Micro-optimization by replacing file_exists with is_file
-----------------------------------------------------------------------------------------

If we know that we can expect a file and not a folder we can use
is_file instead of file_exists as it generally benchmarks faster and
actually is more expressive in those cases.

* Commit: `127162f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/127162fcd6c0ccd67d0f73680de8f873fcb6adad>`_

[BUGFIX] "uriPathSegment" not created via auto-created child nodes
-----------------------------------------------------------------------------------------

Fixes the issue where the property "uriPathSegment" is missing when
document nodes are created via the auto-create child nodes mechanism.

If a node type triggers creation of a sub node of type
"TYPO3.Neos.NodeTypes:Page", that new node does not contain a
"uriPathSegment" property and thus results in exception, for example if
the sub document nodes are shown in the node tree.

The solution provided by this change registers a simple slot for the
Node Added signal which sets the uriPathSegment property to the
node name if that property does not exist yet.

Resolves: NEOS-925

* Commit: `658ab96 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/658ab96bbffa2ddffe4db5cae7b43b8c24b929fe>`_

[BUGFIX] Linking via context path works in non TypoScript environment
-----------------------------------------------------------------------------------------

Since 1.2 you couldn't link to a node using the context node path outside
of TypoScript environments. This feature can be useful in lots of
use-cases where you have a node path but no TypoScript context.

This change fixes that behavior and adds tests that actually test this
to prevent this kind of regression.

Fixes: NEOS-961

* Commit: `4c56e4d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4c56e4de16f74110cd1396466ff5f8acd4d6b39b>`_

[TASK] Constraint various node searching to current site
-----------------------------------------------------------------------------------------

When searching for nodes the result should be limited to the current
site to avoid issues like linking between sites is unsupported and
duplicate nodes from other sites make it difficult to tell apart.

Following searches are constrained:

- LinkEditor (Inspector)
- Reference(s)Editor (Inspector)
- Aloha link wizard
- Node tree filter

Depends: Ibaa9b914e438ba1c560d58a095a48e64a5428bfd

Fixes: NEOS-140
Resolves: NEOS-250

* Commit: `2494143 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/24941434dc17c135ac8db8564ed9f92e4b2b78de>`_

[BUGFIX] Loose domain matching check in menu site list
-----------------------------------------------------------------------------------------

* Commit: `98925fa <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/98925fa1a3b1d129f20271cb8c13a72fda0cc2e4>`_

[BUGFIX] Remove doubled slashes in site uri for site menu
-----------------------------------------------------------------------------------------

In the site menu the uri contained doubled slashes, because path had
trailing slash and uri had leading slash. Removed the trailing slash
in path. This only happens for sites with an active domain record.

Resolves: NEOS-450

* Commit: `c351672 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c351672d3bf5671f5651cce0135d2b0acf202dc1>`_

[TASK] Add Neos specific requirements check
-----------------------------------------------------------------------------------------

This adds a new step to the beginning of the setup tool meant for
additional checks for requirements of Neos.
Currently it checks if one of the three Imagine drivers is installed
and configures the best fitting one without user input needed.
The order (from worst to best) is gd, gmagick, imagick.

Additional checks can be added to this step.

Resolves: NEOS-858

* Commit: `6919265 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6919265e8387e833bfacdedcb6fc87f6eefb34b2>`_

[BUGFIX] Cross-browser compatible ellipsis animation
-----------------------------------------------------------------------------------------

The current implementation only support webkit browsers. The animation
is used in various areas like login button, saving/publish button.

Fixes: NEOS-940

* Commit: `6f24034 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6f24034d81eb11bb5597a256e43416b37a5dc094>`_

[TASK] Remove Aloha attributes crap from fixture site XML
-----------------------------------------------------------------------------------------

* Commit: `df1eddb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/df1eddbadc375cd6a16cf6710d3726cce0382346>`_

[TASK] Small doc fix: wrong indentation for note
-----------------------------------------------------------------------------------------

* Commit: `00ad67b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/00ad67b7d8be6826243c50a8b11d24a4757b7832>`_

[TASK] Adjust node command to adjusted interface
-----------------------------------------------------------------------------------------

Related: NEOS-329

* Commit: `7d30f46 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7d30f460c4556ecfcf425b3c8e945045dba5f1f1>`_

[BUGFIX] Generate uri path segments run for all node commands
-----------------------------------------------------------------------------------------

There's no check if the node command being run is actually the repair
command, so it will execute the generate uri path segments functionality
for all node commands.

* Commit: `2f36678 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2f36678244fec2ff295f3a9801c8a9738cc42c3f>`_

[BUGFIX] Missing safe guard for empty label in NodeView
-----------------------------------------------------------------------------------------

Fixes an issue in NodeView which causes an exception on rare occasions
when node type labels are empty.

The original error message was::

  Uncaught exception #1: Warning: strpos(): Empty needle in
  TYPO3_Neos_Service_View_NodeView.php line 273

* Commit: `740e1a3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/740e1a32596733c007d4c50e065a55b78747906d>`_

[BUGFIX] Adjust "Raw content editing mode" to refactored PrimaryContent
-----------------------------------------------------------------------------------------

This fixes a regression introduced with
293f2c5cc8fd15ae892360f0cc01eff25f79f1d2 that broke the "Raw content
editing mode".

Background:
For the 1.2 branch the refactoring has been reverted so this only
targets master (1.3+)

Fixes: NEOS-921

* Commit: `502d33e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/502d33ea242f36481fc6708cb22081b896acb3a8>`_

[TASK] Don't log "node discarded" events
-----------------------------------------------------------------------------------------

This changes removes logging of discard operations which undo changes
in an editor's local workspace. Discard operations are not generally
of interest to other editors so they can be removed from the global
history for now. Additionally, if a discard event has been logged in
the past, the History module would fail on rendering the list of events
since the Node Discard case hasn't been implemented yet.

Resolves: NEOS-914

* Commit: `18b02dd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/18b02dd450262602495838016a01a315a40db6d5>`_

[TASK] Add changelog for TYPO3 Neos 1.2.1
-----------------------------------------------------------------------------------------

* Commit: `2f6c86a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2f6c86a1cb2bd6f9de4b1bcf4d74246109ee9a0c>`_

[TASK] Use HTML5 validation on login form
-----------------------------------------------------------------------------------------

Prevents sending incomplete login credentials.

Related: NEOS-815

* Commit: `2ccaa86 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2ccaa86ed213ba150e93e57d57e32ea64016920a>`_

[TASK] Only warn when navigating away for non safe requests
-----------------------------------------------------------------------------------------

When navigating away from the content module an alert is shown
if requests are in progress. This leads to some undesired alerts
when the requests are simple get requests that won't cause loss
of data if not completed. To improve this the behavior should only
apply to non safe requests.

Resolves: NEOS-907

* Commit: `02974dd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/02974dd065f36da8375ce6c0282b96c763c6f82f>`_

[TASK] Use consistent label on publish all button
-----------------------------------------------------------------------------------------

Always show "Publish all" instead of "Published" when
no publishable changes are present. This is to avoid
confusion of what the button does and to streamline it
with the discard buttons.

Resolves: NEOS-908

* Commit: `5997954 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5997954c6e60cf61c8fecbec437e14197523ecab>`_

[BUGFIX] Remove undesired "(Page)" when editing titles in the node tree
-----------------------------------------------------------------------------------------

When editing a title in the node tree the title used contains "(Page)"
afterwards, since its using the tooltip as it's source for the existing
title.

Fixes: NEOS-909

* Commit: `df777b4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/df777b400c807e56843b07ad427f4ab2d9ec62d6>`_

[BUGFIX] Handle unset inspector groups correctly
-----------------------------------------------------------------------------------------

Prevent a fatal error when unsetting an inspector group to ~ (null)

Fixes: NEOS-910

* Commit: `40ee8ab <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/40ee8ab05b77a1b0866f568f21b47f5858824f28>`_

[BUGFIX] Add missing username on re-login dialog
-----------------------------------------------------------------------------------------

Fixes: NEOS-905

* Commit: `3e2e054 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3e2e054f0d0f3279ff9f1f227acc282dd80a55b9>`_

[TASK] Remove wrong title in changelog index
-----------------------------------------------------------------------------------------

* Commit: `9d67d85 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9d67d856144e9b120ad19927343318b61bf17335>`_

[TASK] Add release date to changelog titles
-----------------------------------------------------------------------------------------

* Commit: `b651efb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b651efb5c58cb24ceea5c77b68ccef6b8b4b307a>`_

[TASK] Remove backup changelog for 1.1.0
-----------------------------------------------------------------------------------------

* Commit: `795246a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/795246a2c7ce3e85fa9ead3ec71d4a889ac8c5e0>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `04cc5df <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/04cc5dfb8c6c2c08b590a71c522603238eea5559>`_

[TASK] Display warning if a inspector editor cannot be loaded
-----------------------------------------------------------------------------------------

Related: NEOS-894

* Commit: `46a5a72 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/46a5a721ab41fde21565902ca725f291d08a5021>`_

[TASK] Streamline direction and adjust position of notification arrow
-----------------------------------------------------------------------------------------

* Commit: `1da2e6e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1da2e6e41bfcb6373e40d4ec47ba53e8c39c1b91>`_

[BUGFIX] Disallow inserting content in normal content elements
-----------------------------------------------------------------------------------------

To avoid allowing inserting content inside other content elements,
unless explicitly allowed like for the content collection,
we constraint it for all content elements.

Fixes: NEOS-445
(cherry picked from commit 9a668a76f361823113345bd3c4463f59431d4c21)

* Commit: `55cad8f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/55cad8f50bd515c40640ffdbbaefa17f17784918>`_

[BUGFIX] fix image cropper on sites without bootstrap
-----------------------------------------------------------------------------------------

Because an unprefixed "clearfix" CSS class was used, the
image cropper only worked on sites based on Bootstrap. This
is fixed by properly namespacing the clearfix css class and
use "neos-clearfix" instead.

Resolves: NEOS-901

* Commit: `227e3f1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/227e3f1dc6488b9ff7112ac2b4de041742bdd7cf>`_

[BUGFIX] Clear content and route cache when importing / pruning sites
-----------------------------------------------------------------------------------------

Adds signals and dispatcher connections to clear content and routing
caches when sites were pruned or imported.

Fixes: NEOS-885

* Commit: `652aa07 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/652aa078d3f71f6880567576eae371fb215547f4>`_

[BUGFIX] Throw exception when trying to import an invalid Sites.xml file
-----------------------------------------------------------------------------------------

With this change a more meaningful exception is thrown if a site could
not be imported for unknown reasons.
Besides this slightly improves the ``site:import`` command to give
feedback about the imported site on success.

This also adds some cosmetic and non-functional cleanups in order to
increase readabilty and IDE support:

* Import FQN where applicable
* Reduce nesting in ``SiteImportService::importFromFile()``
* Remove unused import statements
* Whitespace fixes

Related: NEOS-885

* Commit: `4f6249a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4f6249a484a6fedf54dd99cce45b6897753099ae>`_

[TASK] Implement ContentCollection in pure TypoScript
-----------------------------------------------------------------------------------------

Rewrite ContentCollection to use just pure TypoScript code
instead of PHP implementation. Should be functionally equivalent
to current implementation.

In addition provide TYPO3.Neos:ContentCollectionRenderer 
service object, which helps to render all children of current node.

Related: NEOS-188

* Commit: `1efd1c0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1efd1c04b5413ffbcf126858baf1d233f2bdd8c2>`_

[TASK]Refactor PrimaryContent to use "renderer" instead of "type"
-----------------------------------------------------------------------------------------

Using "renderer" with an object and property declaration is easier
to read than "type" with prototype override.

* Commit: `55fd6c7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/55fd6c7d1e4b8043bf9e395c7aefdba3853890ac>`_

[TASK]Small correction in PHPDoc for convertUriToObject method
-----------------------------------------------------------------------------------------

* Commit: `d1e9fa6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d1e9fa6cef3fcea9520cdd085ecde9f1d0db8fab>`_

[BUGFIX] Use original image in image inspector editor
-----------------------------------------------------------------------------------------

A regression introduced in Ic81c6595cb6594735206be8422cea5def01fbda7,
where the functionality is unintentionally removed.

Related: NEOS-416

* Commit: `fd06151 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fd061510c98719625214cc9c6fa88e45ec6c8acc>`_

[!!!][BUGFIX] Property mapper error on node properties of type date
-----------------------------------------------------------------------------------------

This change is a fix for the property mapper error that occurs since
the resource management changes. Those changes introduced using the
property mapping in the getProperty method of a Node object.

This method gets the node type configuration though, which holds the
value 'date' for the type. The property mapper only knows about 'DateTime'
though.

The error only occurs for non internal node properties (so not starting
with a _) as those are handled by the ContentElementWrappingService.

This change fixes it for now by renaming the property type to 'DateTime'.
Marked as breaking as it will lead to errors if people forget to use
the supplied migration.

Related: NEOS-876

* Commit: `23eb037 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/23eb037f7be9f298858fa0ba5a0c3c3e4da37852>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `b674486 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b6744862abc8a9fe73ebbcaa3377e4b2bd8d5e93>`_

[BUGFIX] Error for selected values in LinkEditor
-----------------------------------------------------------------------------------------

Prevent errors thrown in the LinkEditor for selected values due to
incorrect format used in jQuery selector, leading to
``Syntax error, unrecognized expression``.

Fixes: NEOS-891
Related: NEOS-856

* Commit: `f3d83b7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f3d83b739f9a5c17a893ad4f24364a89ae36270b>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `82c9849 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/82c98490e22c57ba0d5fc2d560415204c0023964>`_

[BUGFIX] Fix test failures because of event log references
-----------------------------------------------------------------------------------------

This change adds a setting to disable the event log for functional
tests. It's still enabled for Behat scenarios to test the history
feature.

* Commit: `4c82929 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4c82929da046005a061b64e9abcc374f413be7fe>`_

[TASK] Fix Behat tests for history
-----------------------------------------------------------------------------------------

The history feature was changed and Behat tests were not updated
accordingly. This change additionally tags scenarios that perform
remote operations with HTTP with ``@remote`` to filter them when
running the Behat tests.

* Commit: `67827cd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/67827cd66c086e87986a0a46ff6df48b20ed18a2>`_

[TASK] Add site node to content context for rendering tests
-----------------------------------------------------------------------------------------

Functional tests might give wrong exceptions on failure
because the exception handler expects a site context variable.

* Commit: `62cdef0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/62cdef0bdc94f52cf3bce29369f286904e9c8676>`_

[BUGFIX] Gracefully handle wrong property types in PropertyEditor
-----------------------------------------------------------------------------------------

Before this a wrong / missing property type would basically crash the
backend and give no clear error message. This change adds a notification
and a console error (if available) with more details.

Related: NEOS-883

* Commit: `c9199ec <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c9199ecaf4eea2f89963d58946ea99d31e27978d>`_

[BUGFIX] Adjust broken ``NodeTypeSchemaBuilder`` test
-----------------------------------------------------------------------------------------

Adjusts the broken ``NodeTypeSchemaBuilder`` test for
``nodeTypesContainCorrectSuperTypes`` to the changed format.

Related: NEOS-870

* Commit: `7874e84 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7874e84b3853f305d954190792517afc73a4b426>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `609ba5a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/609ba5ab7d2a36910bc077a40969199bf967bcac>`_

[BUGFIX] Fix typos in 1.2 changelogs
-----------------------------------------------------------------------------------------

* Commit: `4ceada3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4ceada3a6a961c2a1690adc3402ba5846c113121>`_

[TASK] Add changelog for TYPO3 Neos 1.2.0
-----------------------------------------------------------------------------------------

* Commit: `c98caba <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c98cabaa152e917484410374cd5a117be3a0314e>`_

[BUGFIX] ContentContextFactory should not instanciate Now
-----------------------------------------------------------------------------------------

The ContentContextFactory created instances of
\\TYPO3\\Flow\\Utility\\Now which should instead be injected.

This resulted in hard to debug errors and is prevented by
injecting Now into the parent class in TYPO3CR.

Related: NEOS-879

* Commit: `a027fa9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a027fa9cd4e7e33510d2c88c716dbe131ffc9d38>`_

[BUGFIX] Remove outline on focussed inspector tab buttons
-----------------------------------------------------------------------------------------

* Commit: `a01e343 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a01e343622924f6dced29e859a17605635f8cf0c>`_

[TASK] Document ``Data Sources`` end points
-----------------------------------------------------------------------------------------

Documents the new ``DataSource`` functionality which allow easy
integration of data source end points, to provide data to the
editing interface without having to define routes, policies, controller.

Resolves: NEOS-729
Related: NEOS-529

* Commit: `7a67edb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7a67edbdc6d32a1901370002f5c584fba557be3a>`_

[TASK] Improve TypoScript object reference
-----------------------------------------------------------------------------------------

Improve and streamline the object reference.

Resolves: NEOS-366

* Commit: `35de30e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/35de30e557b5de8e9fc96d685d74426a23688a52>`_

[TASK] Display node type label in node tree's tooltips
-----------------------------------------------------------------------------------------

Adds the node type label to the tooltip in the tree's in
the navigate component. If the label already contains
the node type label, it's not added. This is due to many
elements in the context structure tree are like that, but
other elements like headline, text etc. aren't.

Resolves: NEOS-870

* Commit: `ab3b731 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ab3b731545e2b7b8b717bb876b59bf4294205dbc>`_

[TASK] Document NodeType property types & inspector editors
-----------------------------------------------------------------------------------------

Resolves: NEOS-147

* Commit: `5b6d77d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5b6d77da75f37a3dc011c402f1c44fd052cdb3d1>`_

[TASK] Make image editor maximum file size configurable
-----------------------------------------------------------------------------------------

Expose the maximum file size as an editor option for the
image inspector editor. If not set or an empty value,
the largest size allowed by the server is used.

Additionally improves the error handling to show file size
errors.

Depends: I9b35d1b08c7cb1f41330d88f62fc1092e90880c6

Resolves: NEOS-842

* Commit: `f749e94 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f749e9496fbf39c7b0fddd26efce8883e96163ea>`_

[TASK] Always open live preview in the same browser tab
-----------------------------------------------------------------------------------------

This is a follow up to I0e19d2b6a8deb7f6429437928a36ee309c1db720
that enforces clicks on the "Open page in live workspace" button to
open in the same browser tab instead of opening a new tab each time.

Related: NEOS-865

* Commit: `b6c4ace <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b6c4ace61bfa0d6153b608674c8442c5ac726113>`_

[BUGFIX] Disable autoparagraph by default and make it configurable
-----------------------------------------------------------------------------------------

Inline editable properties that does not allow paragraphs tags,
would get paragraph tags due to the autoparagraph plugin being
enabled on all properties by default. Instead the plugin is
configurable and disabled by default.

Fixes: NEOS-851

* Commit: `863c550 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/863c5502014d9bf4104d841c4f94107fba4f40d8>`_

[TASK] Adjust behat tests to changes in Flow
-----------------------------------------------------------------------------------------

Adds a BehatTestHelper class, according to the
changes in I410b7c7e4eaddff5aeb4e9d600dbdc1a3748df91.

Related: FLOW-134

* Commit: `4742cfe <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4742cfe5b35745fba38c069404b24d982b129b6c>`_

[TASK] Fix wrong formatting in aloha configuration example
-----------------------------------------------------------------------------------------

Having a # in the front breaks the example.

* Commit: `5d0fb86 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5d0fb8639a6d23dc731ad57d27eb10b1cb9a2336>`_

[BUGFIX] ContentCollection properties cannot be saved
-----------------------------------------------------------------------------------------

Without this change, saving ContentCollections results in an endless loop.

Resolves: NEOS-188

* Commit: `4fcf331 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4fcf33165c3756f1278d0221b67ba0863bde0aa9>`_

[BUGFIX] Display message for missing nodes/assets in LinkEditor
-----------------------------------------------------------------------------------------

Add handling of missing nodes/assets that have been selected in the
link inspector editor. Previously a "Loading ..." label would be
shown even though the ajax request had stopped. Instead a label
telling the node/asset is missing is shown with a warning icon.

Fixes: NEOS-856

* Commit: `a807c27 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a807c27aff587ee94ba57709a26ea21f484ae7af>`_

[TASK] Use ViewHelper to render tree in Configuration Module
-----------------------------------------------------------------------------------------

Recursive rendering in Fluid is very bad in terms of performance, and
max nesting needs to be pretty high. The template is now simplified by
generating the complete configuration tree using a specialized view
helper that does the rendering in PHP.

Resolves: NEOS-848

* Commit: `0001c21 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0001c21ae23ff3812ad25df4661f8835c2b591d6>`_

[BUGFIX] Changing dimensions on a shortcut breaks
-----------------------------------------------------------------------------------------

This bug shows up in two cases:

- when translating a shortcut, the browser was redirected
  to the original translation instead of the newly created one

- when switching the dimension on a shortcut, one was
  redirected to the target page of the shortcut (in the
  target dimension), instead onto the shortcut itself.

This is caused because shortcuts are, by default, also
resolved when a link is generated inside the template of
Service\\NodesController::showAction.

This is fixed by introducing an internal parameter which
allows to create a link to the shortcut itself, instead
of its target.

Fixes: NEOS-664

* Commit: `f1659e3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f1659e36a0ec7fbc95858676187c77ceee757e9e>`_

[BUGFIX] Remove typo in Gruntfile.js
-----------------------------------------------------------------------------------------

* Commit: `242764e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/242764eed9f2a44919014070a03086b80562cf62>`_

[BUGFIX] setNode() no longer assumes context is a ContentContext
-----------------------------------------------------------------------------------------

The setNode() method tried to fetch the current Site instance from the
context, not taking into account that not all nodes have a Neos
ContentContext but might have a TYPO3CR context assigned. That has no
getCurrentSite() method, thus setNode() crashed.

* Commit: `54b410c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/54b410ccb72f2c9bfbc0980507b736f6df240ff8>`_

[BUGFIX] Adjust Aloha list plugin fixes to new version
-----------------------------------------------------------------------------------------

After updating from Aloha 1.1.3 to 1.1.5 the custom fixes
for the listplugin didn't work anymore. This adjusts the
fixes to the changed code.

* Commit: `fb1d954 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fb1d95478bc59af5127fb986bad457cd83ce933e>`_

[BUGFIX] Add missing Ember dependency in PluginViewsEditor
-----------------------------------------------------------------------------------------

* Commit: `0ff5ad5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0ff5ad5efdf0b93015b61832a99f8a6bf966d153>`_

[TASK]Clean up multi-lingual route part handler regex
-----------------------------------------------------------------------------------------

the way the regex was built before, the "remainingRequestPath"
only contained a single character, and "context" containing
the rest.

Furthermore, we document and test the regex properly.

Related: NEOS-295

* Commit: `daf0510 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/daf051017f45f692b623a033aaf5de7ba3bf7981>`_

[BUGFIX] History module crashes on removed nodes or removed site
-----------------------------------------------------------------------------------------

If the site has been re-imported or nodes have been removed, the History
module crashed while trying to display non-existing entities.

* Commit: `cea247e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cea247e21fac927b5c3b72faec711ae62e1a16cb>`_

[BUGFIX] Functional tests fail due to Event model / SQLite
-----------------------------------------------------------------------------------------

Since the $uid property of Event has no annotation which works for
SQLite, functional tests fail (because the MySQL / Postgres migrations
are not used on our CI server).

Annotating $uid with nullable=true helps.

* Commit: `9e73e38 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9e73e385f072d6b7195159f31d1c4b77f154a2be>`_

[BUGFIX] History Event "created Page" is missing
-----------------------------------------------------------------------------------------

* Commit: `140fc5b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/140fc5b981aa503598ce39a331546536714abb6f>`_

[BUGFIX] Event log for created ContentElements
-----------------------------------------------------------------------------------------

Creating a ContentElement leaded to an server communication error and
the placeholder "Enter text here" got lost. There was also no History
Event.

* Commit: `bbae52d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/bbae52d005ba17829fadb69495ef85e3f129acdb>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `75830c3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/75830c365c6ca4514a04a05a0faf3fe1daeb4774>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `b943952 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b9439528512fedbe1660c6812c8a7a31bfe5441f>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `811fde0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/811fde01fb05e41b3b195ac0055f37c773018d63>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `2727d33 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2727d33aa733984ccf9085ce56b29b03ef5d0991>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `f60946b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f60946bbb1a345c1dd75c3792bc0501a71abc347>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `6582af5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6582af5f5d5505230b1b7c659ea5caaa116d1a57>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `78e0386 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/78e0386fe971242ba0db585a77d0dbe1aa06371b>`_

[TASK] Event Logging and History Module
-----------------------------------------------------------------------------------------

Changes to nodes and configured entities will be logged and can be
displayed in the history module.

Resolves: NEOS-655

* Commit: `92094bc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/92094bc1573d58f8f3669e3689e417c8fa3bcd16>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `b15fe04 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b15fe04fbb8640b20ec6871bdffc601a5abbacfd>`_

[TASK] Add changelog for TYPO3 Neos 1.2.0-beta3
-----------------------------------------------------------------------------------------

* Commit: `a7a3776 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a7a37762cc88e412334fc7295ba4364aee5418cc>`_

[BUGFIX] Only process node arguments with matching format in route cache
-----------------------------------------------------------------------------------------

Prevent errors caused by custom node arguments not having the correct
format needed to extract the identifier.

Resolves: NEOS-556

* Commit: `e04c387 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e04c3878ad9f784acd3e558b88417eed4da6ce72>`_

[BUGFIX] Prevent unselectable inline editable content
-----------------------------------------------------------------------------------------

When deleting all text in inline editable fields, it sometimes
becomes impossible to select the field to insert new text.
This happens because left over empty tags have zero height.

Fixes: NEOS-843

* Commit: `d32fee5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d32fee5309a5f8dd78164e57fbb2d3bfcfca32e7>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `7131460 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/71314606f813cf65e540d59c152d311080c8505f>`_

[TASK] Cache first online site and active domain in memory
-----------------------------------------------------------------------------------------

Resolves: NEOS-572

* Commit: `868a8d1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/868a8d173ae4f598bf794223348b99e76472ec1b>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `c85579c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c85579cbe085d165ff0cc4d5d91e7ff1c0421fa8>`_

[BUGFIX] Skip unnecessary time screen in DateTime inspector editor
-----------------------------------------------------------------------------------------

When no minutes or seconds exists in the date format, the minute screen
should be skipped entirely.

Fixes: NEOS-577

* Commit: `fd6f15e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fd6f15ebc9f15fcc20e5bdcb34531f5de858d369>`_

[BUGFIX] Respect inactive state for domains
-----------------------------------------------------------------------------------------

If a domain is inactive the domain will not be used for determining the
active site. This means that when requesting an inactive domain the
default site will be shown instead, as if the domain hasn't been
configured.

Previously the domain state wasn't taken into account at all meaning
that inactive domains would still match their respective site.

Fixes: NEOS-181

* Commit: `de13713 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/de1371322267108364fd7e89b3f0701d1f6b86b8>`_

[BUGFIX] Node search service needs to consider node dimensions
-----------------------------------------------------------------------------------------

Use the NodeDataRepository to do the properties search to have a
proper workspace and dimension behavior.

Fixes: NEOS-824

* Commit: `8ff489f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8ff489fad74deb5858c756623df9658a31414b4e>`_

[BUGFIX] document reference/references editor with node type restriction
-----------------------------------------------------------------------------------------

Resolves: NEOS-840

* Commit: `d5da8d1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d5da8d1e50999a5405b254783b9f3d1c87d5ae91>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `6cbd921 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6cbd9216c192f695f1a1652958c86745bc2a5a72>`_

[BUGFIX] Adapt Fixture and LinkingServiceTest
-----------------------------------------------------------------------------------------

The way Asset identifiers are exposed has changed and this needs
to be reflected in the functional test fixture and LinkingServiceTest.

* Commit: `dd6d842 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/dd6d84275484d4bb11e860aa9b9740a219b946c0>`_

[TASK] LinkEditor & Reference(s) inspector editors improvements
-----------------------------------------------------------------------------------------

- Removes the <b> tag around results in Reference(s) editors
- Highlights result text matching search text
- Prevent re-initializing Reference(s) editors unnecessarily on property
  changes

Resolves: NEOS-808

* Commit: `657287c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/657287cdc9223f7a2c10e0820e2be6b2e8a2017f>`_

[BUGFIX] Node type schema validation throws errors
-----------------------------------------------------------------------------------------

Adds schema for ui.aloha strong, em, del & formatlesspaste options

Allows setting ui.inspector.group to NULL as well as a string (unset support)

Fixes: NEOS-813
Fixes: NEOS-812

* Commit: `a7b8ee4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a7b8ee4f6a32b3e7f7695f7eeb5a1d85452e831e>`_

[TASK] Adjust to testing publishing target
-----------------------------------------------------------------------------------------

Depends: I366a5f7307ca246c73dc2b422a9001205fd9339d

* Commit: `84454bd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/84454bdf7e0946a20079a544095e99e831edcc4f>`_

[TASK] Use real UriBuilder in functional RenderingTest
-----------------------------------------------------------------------------------------

The use of a mocked UriBuilder broke when using the UriBuilder using
chained calls, as only `reset()` returned the mock and any other calls
did not. This lead to "method call on a non-object" errors.

* Commit: `05cc8c3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/05cc8c3e9645e485000f3caf0d282aee7926fde0>`_

[FEATURE] Data views for the inspector
-----------------------------------------------------------------------------------------

Add a column, table and time series view to display generic data from
a data source. Include D3 for SVG graphs.

The API of data views is not public yet.

Resolves: NEOS-761

* Commit: `a057c57 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a057c57f040fd14ed30f640f047b057d1e5d4b55>`_

[FEATURE] Generic views for inspector groups
-----------------------------------------------------------------------------------------

Add support for generic views besides property editors. These views
can be added through the "ui.inspector.views" node type option.

A widget base class for other views is included in this change.

Resolves: NEOS-760

* Commit: `ae6e726 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ae6e7268b52cf44b0efa976a4f2f84e605c39b74>`_

[BUGFIX] use nodeName instead of label for node:repair command
-----------------------------------------------------------------------------------------

node:repair must be used for upgrading to Neos 1.2
Nodenames with german umlauts will break the new builded
url from the url path segment without this fix. 

Fixes: NEOS-819

* Commit: `2e30893 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2e30893aa91cf33a0bd7bd429acf00997fc96c95>`_

[TASK] Login dialog improvements
-----------------------------------------------------------------------------------------

Prevents the login dialog from being duplicated if multiple request
were restricted.

Also streamlines the styling with the normal login by moving
the failed login message below the form, introducing a shake effect
on failed login.

Additionally indication of a login is in progress is added to the
normal login as well as the dialog login.

Furthermore fixes the login dialog to use native form validation in
the form of required fields.

Adds missing translation labels for ``login`` and ``authentication``.

Fixes: NEOS-599
Resolves: NEOS-815

* Commit: `e71a2e3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e71a2e3f333da9e6e8385c479cc4dce26c2f0678>`_

[BUGFIX] Icon alignment on insert new panel buttons
-----------------------------------------------------------------------------------------

* Commit: `98b48c2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/98b48c29c3042fec884d42b1bd76cbcc0b80af04>`_

[BUGFIX] Inline editing insert new panel sorting broken
-----------------------------------------------------------------------------------------

Regression introduced in Ie87f10dd3bd9b61a4e65d84bba05813f9476a52b

Related: NEOS-609

* Commit: `514750a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/514750a96cfd8dc28c80decc26390d697ff200fb>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `311e8c4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/311e8c4627969c3d69c183dba5f392fca048d1d3>`_

[BUGFIX] Request forbidden after login dialog re-login
-----------------------------------------------------------------------------------------

When a non GET request is being intercepted by the login dialog,
the request retry fails after a successful login. This is due to
the CSRF token isn't updated before retrying the request.

Fixes: NEOS-814

* Commit: `250e02d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/250e02d64cd7a201849c8bc9e527325abf5f3d33>`_

[BUGFIX] Grunt should watch scss files in all subdirectories
-----------------------------------------------------------------------------------------

The pattern did not consider files in directories of a deeper level.

* Commit: `be482e5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/be482e52785af2281ead069cd27f2d2f004283b2>`_

[TASK] Pass the controller context to a data source if it's settable
-----------------------------------------------------------------------------------------

A data source might need access to the current request for
building URIs. With this change, the controller context is set
if a data source provides a setter for it.

Related: NEOS-594

* Commit: `40622e8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/40622e8d3332de9372ccee878a5beacc346c6d8a>`_

[BUGFIX] Pass the controller context to the exception handler Fluid view
-----------------------------------------------------------------------------------------

This fixes a problem where the exception handler page itself throws
another exception because the current package couldn't be resolved
for translations.

* Commit: `720fe4e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/720fe4e1e590e42b0e9292169576414ea4a5f9d0>`_

[BUGFIX] Prevent recursion problems in Menus
-----------------------------------------------------------------------------------------

Object comparisons should be done strict otherwise PHP will
do a full comparison of all properties of both objects, which
is slow and can lead to recursion problems.
Changing the rootline comparison in menus to strict will prevent
that.

* Commit: `ac1917b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ac1917bdf26dcf25f9550273054c49b0830d1d7a>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `b67cee3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b67cee30650f69daed4c4ada91baf9b3a5fb934c>`_

[TASK] Minor improvements to SelectBoxEditor
-----------------------------------------------------------------------------------------

* Commit: `36b44f1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/36b44f1de5829563904d0b78fc2448b356777a42>`_

[BUGFIX] Typo in login screen footer (translation regression)
-----------------------------------------------------------------------------------------

* Commit: `15a5aaf <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/15a5aafd1f93925a5b733d600e90341d8c6c24f9>`_

[BUGFIX] Bottom border in single selected option for Select2
-----------------------------------------------------------------------------------------

* Commit: `0308c61 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0308c610b7091804793f8ed4e36d9309a0d9a756>`_

[TASK] Fix link in 1.2.0-beta2 release notes
-----------------------------------------------------------------------------------------

* Commit: `19f6fa1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/19f6fa1fcf4b23cf01f6ae6acc2d914ad489cad3>`_

[BUGFIX] Only display Backend users in user management module
-----------------------------------------------------------------------------------------

This adjusts the "User management" module to only display accounts
that are bound to the default "Typo3BackendProvider".

Related: NEOS-115

* Commit: `c372f35 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c372f35907bc3fc007054005dd3cff2f719f4fc7>`_

[TASK] Add release notes for 1.2.0-beta2
-----------------------------------------------------------------------------------------

* Commit: `5bc37ce <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5bc37ce88be05b5ac4a3cb626cdc746939fd46c8>`_

[BUGFIX] Shake effect on failed login broken
-----------------------------------------------------------------------------------------

A regression was introduced with the update of jQueryUI,
breaking the shake effect shown on failed logins.
This is due to the library no longer having the effects included,
and the path to the library not being adjusted.

Related: Ia286cf80246d21337eb1ae6bd3ad3d2aa22833ab

Fixes: NEOS-803

* Commit: `4909c7e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4909c7e954937893f76d49fef11aff4903628e71>`_

[TASK] Various visual improvements for workspaces module
-----------------------------------------------------------------------------------------

 - Improve handling of very long node paths
 - Use node type's name instead of configuration label
 - Removes duplicate display of site (when multiple sites)
 - Small adjustments to icons

* Commit: `9e6d417 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9e6d41710db1ff2433529dfc2a668d861e48ad00>`_

[TASK] Change icon of content collections
-----------------------------------------------------------------------------------------

* Commit: `402d335 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/402d335521c3bb73c6387fbab628295be63f8d9c>`_

[FEATURE] Shortcut to live workspace button
-----------------------------------------------------------------------------------------

Adds a button to the content module in the context bar,
which opens the current page in the live workspace when clicked.

* Commit: `5f7067b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5f7067b0fd704cc9ec03166baf5530268e420723>`_

[BUGFIX] Reference(s) inspector editors with selection broken
-----------------------------------------------------------------------------------------

A regression was introduced with the addition of icons
to the reference(s) inspector editors, causing a JavaScript
error when an existing selection should be shown.

Regression change I322998d5e25363684366eaec755bb4b984be8f1c

Fixes: NEOS-801
Related: NEOS-409

* Commit: `773c368 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/773c36802bdc36a8120bc788c7cffe6bcc9bcf0d>`_

[TASK] Update Aloha 1.1.3 to 1.1.5
-----------------------------------------------------------------------------------------

* Commit: `47178e1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/47178e1329feb6beea39112f464e732d3251e75e>`_

[BUGFIX] Inline linking to nodes/assets broken
-----------------------------------------------------------------------------------------

Linking to nodes/assets in inline editable properties using Aloha,
was broken because the href attribute was removed during sanitization.
They were removed since node:// & asset:// wasn't acknowledged as correct.
This happened due to the sanitization configuration being overwritten,
a regression introduced with the Aloha upgrade.

Unfortunately this bug means that all links to nodes/assets made inline
since the Aloha update are broken. However they can be fixed by clicking
the link in the text, since the href is then added and saved correctly.

Additionally removed unused marking/cleaning code.

Fixes: NEOS-742

* Commit: `d9e3ee4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d9e3ee443875594f7ddfeb804f3bc8ce1bf9f122>`_

[BUGFIX] Fix typo in ReferenceEditor.js
-----------------------------------------------------------------------------------------

Removes a superfluous line that has been accidentally introduced with
Id51aa287d57eb50e55536604878c22c6dfc52c15

Related: NEOS-558
Related: NEOS-801

* Commit: `ca20a04 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ca20a04709995204e31579db5072c7b8c422b0cb>`_

[BUGFIX] Fix translation of Neos exceptions
-----------------------------------------------------------------------------------------

Currently the rendering of Neos exceptions results in a fatal error
due to a regression introduced with Ib859bf63084f71159375d6169c7ecf1aac6e882e.

This change replaces the::

  TYPO3.Flow.error.exceptionHandler.renderingGroups.<renderingGroup>.error*

settings with ``error.exception.noHomepageException.*`` labels that are
translatable.

Depends: I3ac02f17f9aeba428bcd4d0b95b99b4dd7ed7d83
Related: NEOS-497

* Commit: `f2d42b1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f2d42b1aca4147a894033339a0f6d1ee74dd8258>`_

[BUGFIX] Raise Grunt version
-----------------------------------------------------------------------------------------

Using ``grunt.config.merge`` needs at least Grunt version 0.4.5

* Commit: `e3092f3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e3092f3e4a67e6b888c3d280e30ea28766e83b60>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `2531732 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/25317323d41d6b8c0f26039f8e320a534ba0c868>`_

[TASK] Document "nullable supertypes"
-----------------------------------------------------------------------------------------

Nodetype inheritance can be removed again for specific subtypes if named
keys are used (see https://review.typo3.org/34572).

* Commit: `31fc88f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/31fc88f48a628fd89cc02d2d134c22f459374932>`_

[TASK] Small cleanup in VieSchemaBuilder(Test)
-----------------------------------------------------------------------------------------

Removes one unused use statement and adds a type hint.

* Commit: `46c7672 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/46c767253c43a3cdf86f40a925215a15cca7eb1a>`_

[TASK] Adjust to node publishing dependecy ordering
-----------------------------------------------------------------------------------------

Adjusts the publishing service test to the new dependency
ordering in the node publishing introduced in
I5b9ab12384c7b8298bb79752c0e90563a62c2203.

Related: NEOS-770

* Commit: `d1b0027 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d1b0027169cb33d1bae6d8b82544253fe1093d52>`_

[BUGFIX] Publish button failed connection state broken
-----------------------------------------------------------------------------------------

Since the removal of ExtDirect the failed connection status for the
publish menu has been broken, because it uses the node endpoint to
listen for failed requests, which isn't available. Instead it should
listen to the HttpClient.

Fixes: NEOS-444

* Commit: `51c4763 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/51c4763d7bb2502e520d1bab7784ddb4417ae9ce>`_

[BUGFIX] Missing Ember dependency in I18n shared object
-----------------------------------------------------------------------------------------

* Commit: `5f5d1f1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5f5d1f182cb3fa64b0ae76f235e03b2ec8f5a8b0>`_

[TASK] Display warning when an error occurs while saving
-----------------------------------------------------------------------------------------

Implements a modal dialog which warns the editor when
an error occurs while saving content changes. The dialog
offers the opportunity to reload the current page in an
attempt to fix the problem.

Related: NEOS-346

* Commit: `578cde0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/578cde033ffda69d46ad6adbd43ad4f9f309f652>`_

[TASK] Move ImageTag and ImageUri TypoScript objects
-----------------------------------------------------------------------------------------

This TypoScriptObject was moved from TYPO3.Media to avoid a
dependency on TypoScript in Media. See original change for
usage examples, I10898dd66838f5bfedff23818e92100efb35bffe.

Fixes: NEOS-745

* Commit: `c8d53a4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c8d53a43080f88df55092470db42d0b279e9febd>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `acde65b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/acde65b553159618f1552e81fb596c8b8bee2a38>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `09724dc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/09724dcd318a19ef88a25020bbe9d98d03dca3e9>`_

[BUGFIX] QUnit tets runner fails because of undefined variable
-----------------------------------------------------------------------------------------

This change sets the variable before the tests include Ember
so the locale is not undefined in the Ember module.

Resolves: NEOS-782

* Commit: `3fea345 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3fea3457e6f360921873c21d725c6d90e39ac420>`_

[TASK] Add safeguards to user management module
-----------------------------------------------------------------------------------------

This add a safeguard that prevents the current user from being locked
out from the user management module.

Besides this checks whether an username is already taken when creating
a new user. Previously that case led to an exception.

Resolves: NEOS-763

* Commit: `82e87b7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/82e87b7c7aaca1981fe31758deec32d3a621765e>`_

[TASK] Remove duplicated method from PublishingService
-----------------------------------------------------------------------------------------

* Commit: `3c3a993 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3c3a993c2a88041c557025b206d50fa661092d71>`_

[BUGFIX] Fixes typo in the Settings file
-----------------------------------------------------------------------------------------

Current master is broken because in settings "defaut" is missing an "l"
character.

Related: NEOS-769

* Commit: `43ed78d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/43ed78d123f4d6c4b1129b75d17e9e2dda7e0a89>`_

[TASK] Add default robots.txt file to Neos
-----------------------------------------------------------------------------------------

This adds a default robots.txt to the Neos package. If no robots.txt file exists
in Web when the Neos package is installed, it will be copied in place.

If it exists, nothing will be done, so adjusting robots.txt in projects is still
possible.

Resolves: NEOS-714

* Commit: `98491a2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/98491a24422a633b9a14a5d958cfe4e35a659e64>`_

[!!!][FEATURE] Allow disabling crop and resize for ImageEditor
-----------------------------------------------------------------------------------------

The inspector image editor allows cropping and resizing images by
default. Those features can now be configured per NodeType.

The configuration can look like follows::

  'TYPO3.Neos.NodeTypes:Image':
    properties:
      image:
        ui:
          inspector:
            editorOptions:
              features:
                crop: TRUE
                resize: FALSE

Which would enable cropping but disable resize.

This change is marked breaking as the default for both features
is disabled now, which means you need to enable them for custom
NodeTypes that use the ImageEditor. The default Image and
TextWithImage elements will come with both features enabled.

Resolves: NEOS-752

* Commit: `75e2fe7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/75e2fe721f3f82b47005356543508b79e6778e18>`_

[TASK] Use "language" instead of "locale" and enable UI languages
-----------------------------------------------------------------------------------------

The current implementation of UI localization support uses
the term "locale" when referring to the user interface
language. That's not completely wrong, since we use a locale
to identify the language, but from a user's POV what we really
mean is the language.

Once we support date / time formats etc, we'll most likely
introduce more settings so the user can choose this
independently from the language.

Additionally we currently only provide "English" in the list
of UI languages. Let's add some more we are sure of being
available until the preview release.

Resolves: NEOS-769

* Commit: `1003671 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/10036719f5868b786af9e0c1754fa4e9b021f4d9>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `fc7bb9b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fc7bb9be2542e639c1b733500a3a6ec329c3fc76>`_

[BUGFIX] Document node types shown in inline create new panel
-----------------------------------------------------------------------------------------

If a document node type has the configuration ``ui.group`` set,
it shows up in the inline create new panel.

Fixes: NEOS-736

* Commit: `c4ec68d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c4ec68d55e844a8399843323d787fb186a000998>`_

[TASK] Group, sort & add icons for node types in NodeTypeEditor
-----------------------------------------------------------------------------------------

Group and sort node types as defined in the node type configuration
in the NodeTypeEditor used for changing node type in the inspector.
Additionally add node type icon for added clarity.

Resolves: NEOS-422

* Commit: `96fa045 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/96fa045ec0a2238c8d24dbdb06ef956399333ad4>`_

[BUGFIX] Exception instead of 404 in certain cases
-----------------------------------------------------------------------------------------

Neos responds with a "page not found" screen in some cases. If a page
cannot be found due to "normal" reasons, this works fine. In some cases,
the reason for the page not found is not a node that does not exist.

So when in a multi language site (like the demo site) the language
segment is removed, the rendering of the error page takes a different
path and the Backend\\TranslateViewHelper is involved.

That uses the security context without checking if it can be initialized,
leading to an exception.

This change adds a check using canBeInitialized() to that.

* Commit: `ab71441 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ab71441c45b56faa7ac7edc0f409d48214d6431f>`_

[BUGFIX] Assets service index action broken
-----------------------------------------------------------------------------------------

Ib859bf63084f71159375d6169c7ecf1aac6e882e introduced several
regressions, breaking the index action of the Assets service.

 - Wrong header label
 - Linking to unexisting controller action
 - Unclosed inline view helpers

Related: NEOS-89

* Commit: `1cb7e21 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1cb7e21e55f09865960ef4ef54729debcef7e2af>`_

[TASK] Insert new panel improvements
-----------------------------------------------------------------------------------------

 - Styled as cards instead of links
 - Navigatable with tab navigation
 - Max-height with overflow when exceeded
 - Handling of long node type labels (ellipsis + title)

Additionally some clean up:

 - Renamed AbstractDialog to AbstractModal
 - Abstracted the two different InsertNodePanels into one

Fixes: NEOS-581
Resolves: NEOS-609

* Commit: `95aa274 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/95aa2747b2de932ac3dc5f1ad0c94c80ea4d0603>`_

[TASK] Focus action buttons when opening dialogs
-----------------------------------------------------------------------------------------

When dialog are opened the focus is moved on the action buttons of the
dialog, which prevents allows keyboard navigation to handle the dialog.
Additionally it prevents weird behavior when hitting enter or tab
navigating after opening a dialog.

Resolves: NEOS-596

* Commit: `8d77f71 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8d77f710748ede97eac11f3fadfa8611b064302c>`_

[BUGFIX] Fix name of ManageAssets privilege target
-----------------------------------------------------------------------------------------

* Commit: `adf2618 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/adf2618d6bb1b34155f1c9c1026960ea8a0a8f79>`_

[TASK] Adjust to new Flow resource management / new media management
-----------------------------------------------------------------------------------------

This change adjusts Neos to Flow's new resource management and the new
API of the TYPO3.Media package.

Related: FLOW-108

* Commit: `bbdea77 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/bbdea77b74019a6396d9b2d6d696fa7be72badb3>`_

[TASK] Allow configurable search thresholds in reference editors
-----------------------------------------------------------------------------------------

The reference and references editor use a threshold of 1 character before
they start a search for matches. This change makes that threshold
configurable::

  editorOptions:
    threshold: 4

The default value is now 2.

Resolves: NEOS-558

* Commit: `45b3570 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/45b3570ac7fbde21cce7f31d783568d1b46358c5>`_

[TASK] Consistent meaning for arrow directions on buttons
-----------------------------------------------------------------------------------------

There's a mixture in the direction of various arrow buttons.
Now they're streamlined to mean that the direction the arrow
points is the direction that the element moves. E.g. a down
allow opens the element when clicked.

Resolves: NEOS-598

* Commit: `73cca19 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/73cca19ab15a45af9d1df4c89398cf6bff1e9c7e>`_

[BUGFIX] Validation errors empty for service controllers
-----------------------------------------------------------------------------------------

When a validation error is thrown in a service controller
the errorAction tries to output it, but the output is empty
because json_encode cannot handle objects.

Relases: master, 1.2, 1.1
Fixes: NEOS-411

* Commit: `dfe5baf <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/dfe5bafaad9b8f1617e4fd722842069ada704e2e>`_

[BUGFIX] Remove breaking unit test for user management module
-----------------------------------------------------------------------------------------

This removes a unit test for the ``UsersController`` that has been
refactored with I0ca000c233e36a2e9c3689c1dd405033274955b3.

Note: This doesn't fix the test, because the tested functionality is
trivial in the new version.

Related: NEOS-115

* Commit: `713beb4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/713beb41f10fd002127cb3729cc3b000b7a5b3a9>`_

[BUGFIX] Search the node tree loses focus
-----------------------------------------------------------------------------------------

When the node tree is searched, the focus on the search
field is lost after the results are returned.

This causes the situation where the user hits backspace
and then instead of deleting parts of the search term
the page is navigated back.

Fixes: NEOS-359

* Commit: `2e9b219 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2e9b2196136b33c20dd5fc4fc21034be173916db>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `632f853 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/632f8539ef371556fce8faa1fa38df633a87e1ed>`_

[BUGFIX] Fix shortcut page rendering in backend
-----------------------------------------------------------------------------------------

Fixes a regression introduced with
Ib859bf63084f71159375d6169c7ecf1aac6e882e that led to an exception
when navigating to a shortcut page in the backend due to wrongly nested
Fluid tags.

This also also translates the messages for remaining shortcut types.

Related: Ib859bf63084f71159375d6169c7ecf1aac6e882e
Fixes: NEOS-746
Related: NEOS-739

* Commit: `f58b637 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f58b637b42fef108692d29c03fcecf066c21d9ac>`_

[TASK] Remove use of deprecated method in functional test
-----------------------------------------------------------------------------------------

* Commit: `9181712 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/91817121645d0920d9173cf51f1981de391a1df0>`_

[BUGFIX] Shortcut points to unsupported type
-----------------------------------------------------------------------------------------

When a shortcuts resolves to a node it results in the error
500 Shortcut resolves to unsupported type. This happens as
the check for instanceof NodeInterface in the NodeController
fails is not imported and as such returns FALSE.

Resolves: NEOS-754

* Commit: `2cf1a03 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2cf1a030ebc51a422251e2ad894c85ee6563067d>`_

[BUGFIX] Links are broken due to translations
-----------------------------------------------------------------------------------------

Fixes a regression introduced with Ib859bf63084f71159375d6169c7ecf1aac6e882e, 
where links are being localised when they
shouldn't and thus causing problems.

Related: Ib859bf63084f71159375d6169c7ecf1aac6e882e
Related: NEOS-739

* Commit: `6609852 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6609852f536aea9fffb364319682989a6fe023fc>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `b28e346 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b28e346c9a53dde674a464356c79fd0e79cb3ea1>`_

[FEATURE] Module Users: Allow arbitrary roles to be assigned to accounts
-----------------------------------------------------------------------------------------

Previously the user management module only allowed for assigning one
of the roles ``TYPO3.Neos:Editor`` or ``TYPO3.Neos:Administrator`` to
be assigned to a user.

With this change all configured roles that are not abstract can be
assigned to a user, also multiple ones.

Furthermore this change contains some (mostly cosmetic) tweaks in PHP
code and Fluid templates.

Resolves: NEOS-115
Resolves: NEOS-543

* Commit: `10935f6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/10935f6658922077f8a54b2fc0244774d99983aa>`_

[TASK] Remove deprecated TemplateImplementation
-----------------------------------------------------------------------------------------

The Neos TemplateImplementation was deprecated even before
version 1.0 and just outputs an error message, therefor cannot
be in productive use. Removing it will fix the possible error
in the AbstractMenuImplementation that imports the
TemplateImplementation from TypoScript which can  lead to a fatal
PHP error as the name is already in use in this namespace.

Resolves: NEOS-738

* Commit: `39982b4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/39982b4330fd5596e04cc6235b42c9af89a657e3>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `09114fd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/09114fd83425b4d539008226f99cd89fa13f495f>`_

[TASK] Add known issue to 1.2.0-beta1 release notes
-----------------------------------------------------------------------------------------

* Commit: `f126484 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f1264845af7034487d3bad24213b2a5c07e611c9>`_

[TASK] Adjust 1.2.0-beta1 release notes
-----------------------------------------------------------------------------------------

* Commit: `519457a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/519457a09b3db401e158dae4a0615b457ee57c63>`_

[TASK] Update 1.2.0-beta1 release notes
-----------------------------------------------------------------------------------------

* Commit: `642318a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/642318ae96be82951802124d10c552d210e11818>`_

[TASK] Update functional test fixture xml
-----------------------------------------------------------------------------------------

This updates the structure of the functional test node xml to the
new format supporting dimensions.

* Commit: `c5b6cf1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c5b6cf1aa9af15a9b834588e3046b3d1bd73acbd>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `b27160e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b27160e7eb747a970e34d5f6e0bbe31115c3aba7>`_

[TASK] Make preset name & preset configuration available in dimension menu
-----------------------------------------------------------------------------------------

Related: NEOS-299

* Commit: `411aa4b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/411aa4bc533fc13b9df3ccb1753816ee8107d578>`_

[FEATURE] Dimension/Language Menu
-----------------------------------------------------------------------------------------

Create links to other node variants (e.g. variants of the
current node in another dimension) by using this TypoScript object.

Minimal Example, outputting a language menu with all configured
dimensions::

	languageMenu = TYPO3.Neos:DimensionMenu {
		dimension = 'language'
	}

If you only want to render a subset of the available dimensions
or manually define a specific order for this language menu,
you can override the "presets":

Overridden presets::

	languageMenu = TYPO3.Neos:DimensionMenu {
		dimension = 'language'
		presets = ${['en_US', 'de_DE']}
	}

No matter how many languages are defined, only these two are displayed.

Resolves: NEOS-118

* Commit: `475a82e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/475a82e1c298c23e33d32f42a196b91a9f4adbd1>`_

[TASK] Add documentation about content dimensions and translating content
-----------------------------------------------------------------------------------------

Resolves: NEOS-299

* Commit: `b2fba7b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b2fba7b2df308a99627ea05791177c568a0555c3>`_

[TASK] Add f:translate in backend module templates
-----------------------------------------------------------------------------------------

Add f:translate in the Fluid templates of Neos backend. This makes the
Neos backend module labels and descriptions translatable.

Related: NEOS-88
Related: NEOS-497
Related: NEOS-500

* Commit: `b8d8deb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b8d8debc02db9e4bba915ee097ba996b54969702>`_

[FEATURE] Dynamically loaded options for the inspectors SelectBoxEditor
-----------------------------------------------------------------------------------------

Introduces a concept of data sources to allow easy
integration of data source end points, to provide
data to the editing interface without having to define
routes, policies, controller.

Usage::

  'Acme.Demo:FAQ':
    properties:
      questions:
        ui:
          inspector:
            editor: 'Content/Inspector/Editors/SelectBoxEditor'
            editorOptions:
              dataSourceIdentifier: 'questions'
              # alternatively using a custom uri:
              dataSourceUri: 'custom-route/end-point'

Accompanied by a class that implements
``TYPO3\\Neos\\Service\\DataSource\\DataSourceInterface``, preferably by
extending ``TYPO3\\Neos\\Service\\DataSource\\AbstractDataSource``.

Resolves: NEOS-529

* Commit: `9c9dd50 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9c9dd50311abc95353d1dc7a73b9bb1c8b4c4276>`_

[TASK] Adjust to acl changes in Flow
-----------------------------------------------------------------------------------------

Adjusts the Neos package to the recent refactoring of the Security
Framework in TYPO3.Flow mainly by running the respective
code migrations.

This also adds a new code migration that renames the
``TYPO3.Neos.modules.<moduleName>.resource`` setting to
"privilegeTarget".
Make sure to execute code migrations with the::

  ./flow core:migrate

command to apply those changes to 3rd party packages.

Related: FLOW-11

* Commit: `79cfa04 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/79cfa040cf05a6952a8e24fe0a13c9abd586a641>`_

[FEATURE] Localize the UserInterface
-----------------------------------------------------------------------------------------

Implemented Ember-i18n in order to localize the Handlebar templates
and Javascript strings. Translations are read from the XLIFF files
and two new settings are added under TYPO3.Neos.userInterface:

- locale: the default locale for the backend interface
- availableLocales: the locales available in the system

For the Handlebars template, the helper works similar like the Fluid
Translate ViewHelper, so it parses the string based on the key, or
renders the key if the key is not found::

	{{translate id="key"}}

In case no translation is found for the key, the default value  is
returned as output. In case a translation is found for the key,
that is returned::

	{{translate id="key" value="default content"}}

Alternative syntax::

	{{#translate id="key"}}content{{/translate}}

Possible arguments to `translate`:

- `id`, the identifier (required)
- `value`, default content
- `package`, packageKey (defaults to TYPO3.Neos)
- `source`, sourceCatalogue (defaults to Main)

For the `id` dots (`.`) inside the xliff file will be ported to
dashes (`-`) in order to have programmatically correct json files
without losing functionality in the xliff files.

I.e::

	my.xliff.label.identifier

becomes::

	my-xliff-label-identifier

Adds an interface language selector to the user preferences in the
Administration/UserModule. The preference is saved to the users
preferences.

Adds methods to the UserService to fetch the user preferences.

Related: NEOS-61, NEOS-89, NEOS-143, NEOS-435, NEOS-436, NEOS-446

* Commit: `caf3fbd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/caf3fbdf825cae049e890bc9d6e8653b7a5b2f2b>`_

[TASK] Trim and crop default node label
-----------------------------------------------------------------------------------------

The text property is used for the label and it often contains line breaks.
To avoid whitespace around the text, it should be trimmed.

Additionally the label is cropped to a 100 characters, since it's very
unlikely a label needs to be any longer than that. This is again necessary
because the text property can often contain lots of text.

Related: NEOS-257

* Commit: `7f7aacc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7f7aacc18dfa6a252645e502ef7aee710adfc5ce>`_

[TASK] Remove unused method in NodeView
-----------------------------------------------------------------------------------------

* Commit: `e657b22 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e657b2293a59581ec81986269e3966e76e423ead>`_

[BUGFIX] Adjust code migration identifier pattern to contain the full timestamp
-----------------------------------------------------------------------------------------

Previously code migrations are expected to have a class name with the
pattern ``Version<YYYYMMDDhhmm>`` and the unique identifier was
determined extracting the last 12 characters of the class name (which
are expected to be the timestamp).

This change adjusts existing code migrations to use the full timestamp in
order to establish the new guideline (note: those migrations still
return the old identifier so that they won't be applied again with a
new identifier).

Related: FLOW-110

* Commit: `ff6bbe1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ff6bbe13d08205ed0d9b47f65faaad98435c5b96>`_

[!!!][BUGFIX] Fix linking behavior
-----------------------------------------------------------------------------------------

This adjusts Neos' way of dealing with links to shortcut nodes in several
areas.
Links to shortcut pages are now properly resolved: The label of the link
will be taken from the shortcut page node but the link points directly to
the target node or external URI.

This is a breaking change if you relied on the previous behavior.
That is especially noticeable if the root node of a site is a shortcut.
In that case a link pointing to the "homepage" will now directly point
to the target of the root node instead of pointing to "/" and
redirecting to the target on click.

Related: NEOS-564

* Commit: `f1529cf <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f1529cfac7b4ec17e29e9df2e451e4a0ee96569d>`_

[BUGFIX] Content dimensions fetched in modules
-----------------------------------------------------------------------------------------

When opening a module the content dimension selector
fetches the available dimensions, even though the
content dimension selector won't be displayed.

Related: NEOS-546

* Commit: `f805fef <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f805fefa732eb4d7bcd5ab2e7a052174875845dc>`_

[TASK] Add QUnit for running JavaScript tests
-----------------------------------------------------------------------------------------

This adds a new grunt task for running the JS tests. In the Neos package, do::

  cd Scripts
  grunt test

PhantomJS is installed automatically as a dependency via npm for this, see
``Scripts/install-phantomjs.sh`` for some dependencies you might need on top.

Resolves: NEOS-663

* Commit: `a37108f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a37108fd4d10b7c396e56eb2cd52fcafe0d6de41>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `08447f9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/08447f9330f4a41796db4ed673b63a655f0836f4>`_

[TASK] Improve exception handling during rendering
-----------------------------------------------------------------------------------------

Improves the exception handling by changing the way
exceptions are thrown for content and by rendering
a fallback page if the whole page couldn't be rendered.

The exception handling for content elements is changed so
that it now only outputs a XML comment in the frontend in
production context. When logged in a short message, without
technical detail is displayed in production context.
In development the output is the same as before, consisting
of a exception message and a TypoScript path.

The exception handling for the whole page is improved so
instead of just always displaying a message when broken,
it renders an error page with a styled message. In development
context a technical message is displayed, while it's only outputted
as a XML comment in production context. This makes it possible to
navigate the backend, even though the current page is broken.

Resolves: NEOS-344

* Commit: `5c12b1b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5c12b1b2356149151f0d36655bf428fa26ad5b7e>`_

[BUGFIX] Fix duplicate error codes in PasswordValidator and HostnameValidator
-----------------------------------------------------------------------------------------

This change assigns a new error code to the "invalid hostname" error in
the HostnameValidator (the PasswordValidator is older and thus "wins").

This is needed to allow correct detection, display and error message
translation of that error.

The XLIFF files are adjusted as well and the (wrong) translations are
reset to the original (english) string.

* Commit: `95824e5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/95824e5136513620299d925340ef67279dcef034>`_

[TASK] Update the Page prototype to use the new TS prototype Http.Message
-----------------------------------------------------------------------------------------

This adds a way to change the HTTP status code and headers in TypoScript::

    prototype(YourPackage:Page) < prototype(TYPO3.TypoScript:Http.Message) {
	    httpResponseHead {
		    headers {
			    Content-Type = 'application/xml'
    		}
    	}
    	content = TYPO3.TypoScript:Template {
    		...
    	}
    }

Related: NEOS-449

* Commit: `3e427f3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3e427f3b40bf032fe4c8ae4b23c3a266d343b185>`_

[BUGFIX] Routing: only flush related caches when a node changes
-----------------------------------------------------------------------------------------

Currently the complete routing cache is flushed whenever a node is
changed. This can have a noticeable negative impact on performance of
both Frontend and Backend.

With this change only the cache for affected nodes is cleared when
a node is published and/or the "uriPathSegment" property was changed.

Depends: I49da56cd705e41fdc96fe84ac4936d268a0b6f06

Fixes: NEOS-673
Related: NEOS-296

* Commit: `b9c95bd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b9c95bd9e75f80cfa55fc1f0c38937e6bfa30689>`_

[TASK] Use grunt for building css and js
-----------------------------------------------------------------------------------------

To have consistent results the processes for compiling scss
and js files into those files loaded by the browser, we now
use grunt to have a defined process. This also means we need
to define exactly which version of the tools is used.

Therefore we install compass locally into the project
instead of using a version installed into the system. To
install compass the ruby package manager bundler is used.

For new developers it might be hard to figure out what needs
to be installed. This therefore also adds a script which
gives hints how to install necessary tools like node, npm
and bundler. It then uses these tools to install grunt,
compass, etc.

::

  Scripts/install-grunt.sh

To prevent confusion with the old r.js -o build.js command
the build.js is moved to the Scripts folder. Compiling
all javascript and css can now be done by 'grunt build'::

  cd Scripts
  grunt build

Related: NEOS-439

* Commit: `73f2d0e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/73f2d0e86bf640d6219359b4e69dd7acc1e6020a>`_

[BUGFIX] Missing getObjectManager method and trait usage
-----------------------------------------------------------------------------------------

This change implements getObjectManager() on the FeatureContext
and includes the IsolatedBehatStepsTrait which is required for
running the Behat tests.

* Commit: `9f623d7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9f623d7d314faf54bc19718d80b3db8b874f7933>`_

[!!!][FEATURE] Make button label and highlighting mode configurable
-----------------------------------------------------------------------------------------

The HTML editor uses code mirror and could thus be used to edit
other types of textual content as well. To allow this two new
``editorOptions`` are introduced:

- ``buttonLabel`` overwrites the text on the button to open the editor
- ``highlightingMode`` overwrites the default (text/html) highlighting

This is breaking if you used the HtmlEditor in your node types. To
adjust, you need to replace *HtmlEditor* with *CodeEditor*, either
manually or with::

  ./flow core:migrate --package-key <your package>

Resolves: NEOS-379

* Commit: `8855770 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8855770963d14b8f7fcdea4cbcdd8c77f202c14b>`_

[TASK] Document custom validator/editor use for node properties
-----------------------------------------------------------------------------------------

Documents the use of custom (JS) validators and editors for the
inspector implemented with https://review.typo3.org/26005.

Resolves: NEOS-223

* Commit: `0328e73 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0328e73e0ed346c8c91493d72f7bc64bddf22b9d>`_

[BUGFIX] Make legacy site import tests independent from demo site
-----------------------------------------------------------------------------------------

Adjusts the LegacySiteImportServiceTest fixture so that the functional
tests don't fail if the ``TYPO3.NeosDemoTypo3Org`` package is not
installed.

* Commit: `79236e9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/79236e9d4d136ee459d3d48f726b44804e41eadc>`_

[BUGFIX] Incorrect handling of integer values in SelectBoxEditor
-----------------------------------------------------------------------------------------

If a option value is can be interpreted as a finite number it is
treated as an integer, regardless of it being a string value.
This results in wrong behavior where the editor is marked as
modified, without it actually being so.

Related: NEOS-419

* Commit: `fef016b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fef016b81e54c14aa63125126b09c88186d6e09f>`_

[FEATURE] Display modal dialog for initial translation of a document
-----------------------------------------------------------------------------------------

If a document does not exist in the target language, the editor can
choose whether content from the current language should be copied to
the target language, or whether he'd like to start from scratch.

Additionally, all documents which do not exist in the rootline in
the target variant are also materialized.

Resolves: NEOS-633
Resolves: NEOS-646

* Commit: `2d4727e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2d4727edbc906e2762d2dd27d32e668267b7e454>`_

[BUGFIX] Skip null values in inspector SelectBoxEditor
-----------------------------------------------------------------------------------------

Values without configuration should be treated as unset
values and not included as selectable options.

Related: NEOS-419

* Commit: `73dfed2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/73dfed28dadad8e0c5c645ccce917333a7c2dd5a>`_

[FEATURE] Routing: content dimension / translation support
-----------------------------------------------------------------------------------------

This change introduces translatable URI segments and
general support for content dimensions in the frontend node
route part handler. Editors may change the path segment of
a specific document node (for example a page) in the inspector.

The route part handler which renders and matches the URIs
does not use a node's name anymore but refers to a new
node property "uriPathSegment". This finally decouples
URI generation from the internal node structure and naming.

This change also makes sure that router caches are flushed if
any node is updated, removed, published or discarded. That
is refined in a separate change.

In order to migrate existing websites, you must run the "node:repair"
command in order to fill the new uriPathSegment properties.

If you used the "LocalizedRoutePartHandler" from a development
version of Neos, you need to remove the respective Objects.yaml
configuration.

Resolves: NEOS-296

* Commit: `e9c4d71 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e9c4d71d604feac46e2b021203373f9db206e561>`_

[TASK] mark a Document Node Type as "aggregate"
-----------------------------------------------------------------------------------------

I09223f24a80182596a99c9b4908773a990b9316a introduced the "aggregate"
flag to TYPO3CR. This change sets the flag for the
``TYPO3.Neos:Document`` node type so that ``NodeType::isAggregate()``
returns TRUE for those.

Related: NEOS-644

* Commit: `7b812ff <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7b812ffc38a416fcb39595f1747e9287311384b1>`_

[TASK] Adjust behat feature context to Flow changes
-----------------------------------------------------------------------------------------

This adjusts the behat feature context to the changes
made in I7ba61a8e49d108b685394a70be8657550c4033aa.

Related: FLOW-102

* Commit: `512ea64 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/512ea640634dff95b17c6a52fcee7b26157d1110>`_

[TASK] Add icons to reference(s) inspector editor results
-----------------------------------------------------------------------------------------

Resolves: NEOS-409

* Commit: `0e1e1d7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0e1e1d7541f359643c01ccdf504eb9e03a5f00fd>`_

[TASK] Improve usability of publishing button
-----------------------------------------------------------------------------------------

* Change publish button state during publishing (add ellipsis)
* Change dropdown button during publish all/discard actions (ellipsis
  instead of arrow)
* Ensure buttons cannot be clicked during publishing/discarding
* Disable buttons during saving of content changes/having
  pending content saves
* Change publish button color to orange when save changes are pending
* Ensure publish all count is updated after publishing/discarding
* Display error messages if publish/discard failed
* Only discard changes if actually nodes to be discarded are available

Related: NEOS-348

* Commit: `d8bc597 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d8bc597729dcc132f7d47c4932bee57f55d81541>`_

[FEATURE] External events when panels open/close and layout changes
-----------------------------------------------------------------------------------------

This change adds several new events that will be triggered a
panel is opened or closed, causing the viewport of the content
area to be resized.

 - ``Neos.LayoutChanged`` When the content window layout changes (when panels
                          that alter the body margin are opened/closed).
 - ``Neos.NavigatePanelOpened`` When the navigate panel is opened.
 - ``Neos.NavigatePanelClosed`` When the inspector panel is closed.
 - ``Neos.InspectorPanelOpened`` When the navigate panel is opened.
 - ``Neos.InspectorPanelClosed`` When the inspector panel is closed.
 - ``Neos.EditPreviewPanelOpened`` When the edit/preview panel is opened.
 - ``Neos.EditPreviewPanelClosed`` When the edit/preview panel is closed.
 - ``Neos.MenuPanelOpened`` When the menu panel is opened.
 - ``Neos.MenuPanelClosed`` When the menu panel is closed.

Resolves: NEOS-408

* Commit: `6cbe15c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6cbe15cade0d4d36a86426895633f4569d787f99>`_

[TASK] Refactor usage of data attributes for node data
-----------------------------------------------------------------------------------------

The usage and naming of data attributes for the node data
is very inconsistent and there's no clear rules.

- Renames node attributes from data-neos-\* to data-node-\*.
  Direct properties of the node are prefixed with _ and internal
  non properties are prefixed with __.
- Replaces all usage of .attr('data with .data('
- Renames some of the attributes to match their actual content
- Replaces usages of reserved word "arguments"
- Adds missing dependency in PluginViewEditor

Resolves: NEOS-356

* Commit: `13eac17 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/13eac17803419cc7338f5020fabc57dc91220e44>`_

[TASK] Document TS include syntax in Integrator Guide
-----------------------------------------------------------------------------------------

This adds a section on TypoScript ``include`` to the Integrator Guide
chapter "Inside TypoScript".

Related: NEOS-440

* Commit: `31a45fb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/31a45fba193d57d1dae160ef22dcc17c193fca87>`_

[FEATURE] Extensible node search service
-----------------------------------------------------------------------------------------

Add an interface for the node search service allowing
it to be extended with a better search algorithm.

Resolves: NEOS-535

* Commit: `ccaa7d8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ccaa7d857efd75e2a99a4f707274d517bccca1e5>`_

[TASK] Document change in layout properties
-----------------------------------------------------------------------------------------

* Commit: `bd88d62 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/bd88d62e6942247744feba3da3977704a5870085>`_

[BUGFIX] Gracefully handle links to removed nodes/assets
-----------------------------------------------------------------------------------------

Links to nodes/assets that cannot be resolved will now be
unlinked automatically.

When nodes and assets can not be resolved in the LinkService an
exception is thrown. This causes an issue in the ConvertUrisImplementation
object as it will throw an exception. This leads to the fatal
error ``__toString should not throw an exception`` and as such
a white page on production servers.

This change makes LinkingService::createNodeUri() and createAssetUri()
return NULL if $node/$asset was NULL as well (which was already
anticipated by the method anyways).

Fixes: NEOS-564

* Commit: `be6ddf5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/be6ddf5d68e140b667996e077c1545f6aff47e2e>`_

[!!!][FEATURE] Use node label for link.node view helper
-----------------------------------------------------------------------------------------

Changes the output of the view helper to use the node's label
if nothing else is defined. Additionally it makes the linked node
available as a variable named "linkedNode" that can be used when
rendering the content. Example::

  <n:link.node node="subpage">{linkedNode.label}</n:link.node>

The variable name can be changed by defining
the "nodeVariableName" argument.

This is breaking since it changes the behavior of empty links,
so if you relied on that you need to use the f:link.uri view helper
inside the href attribute of a normal a tag.

Resolves: NEOS-367

* Commit: `8ba8655 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8ba865561544e9e2ef668d95fb899e6b1e35b23f>`_

[TASK] Fix content cache clearing in Behat scenarios
-----------------------------------------------------------------------------------------

The glob pattern could not match any directory, so the content cache
produced wrong results for the scenarios.

Additionally a leaking detached Workspace instance is prevented by
clearing all node instances before importing the site.

* Commit: `d6bd2e9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d6bd2e9de4ad7e0d32fc58abacb96af49d5c7102>`_

[BUGFIX] Deleting text in inline editable properties is slow
-----------------------------------------------------------------------------------------

When deleting text in an inline editable property it is very slow.
The problem was caused by inserting some elements that weren't even
used. The slowness was possibly caused by the elements being duplicated
multiple times.

Fixes: NEOS-585

* Commit: `a1bdb09 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a1bdb096475502ecaa39349698492895df6dca32>`_

[TASK] Adapt after the NodeInterface::getFullLabel removal
-----------------------------------------------------------------------------------------

This change adapt the Neos navigate component to crop node label on the
client site with CSS.

We also remove technical informations from the structure tree to have a
more clean interface. The icon for Content Collection is now a folder.

Related: NEOS-441

* Commit: `4382d4d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4382d4d49179e073b1205456b03310f74006f185>`_

[FEATURE] Crop aspect ratio lock presets (image editor)
-----------------------------------------------------------------------------------------

Introduces aspect ratio lock presets for the cropping
in the inspector image editor. Multiple presets can be
configured, additionally it's optional to allow custom
ratios and to enable the original ratio as an option.

Additionally a locked aspect ratio can be configured
to ensure a specific aspect ratio of all images in
that image property.

Example configuration::

  editorOptions:
    crop:
      aspectRatio:
        options:
          square:
            width: 1
            height: 1
            label: 'Square'
          fourFive:
            width: 4
            height: 5
        enableOriginal: TRUE
        allowCustom: TRUE
        locked:
          width: 0
          height: 0

Example of disabling available options::

  # Disable ``square`` option
  'Acme.Demo:Image':
    properties:
      image:
        ui:
          inspector:
            editorOptions:
              crop:
                aspectRatio:
                  options:
                    square: ~

Resolves: NEOS-557

* Commit: `6a38b9f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6a38b9f2a9ee2a9b4f982c12c6c5be55ea34749e>`_

[BUGFIX] Uncached PluginView
-----------------------------------------------------------------------------------------

Plugins are uncached by default. PluginViews should get the same
caching behavior.

Resolves: NEOS-548

* Commit: `cfb9936 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cfb993677a6bb87935d428612e5079101592ee92>`_

[!!!][TASK] Move FlowQueryOperations concerning nodes to TYPO3CR
-----------------------------------------------------------------------------------------

All FlowQuery operations concerning nodes have no dependencies
on the TYPO3.Neos package, but only on the TYPO3.TYPO3CR package.
The rightfully belong there and probably ended up in the Neos
package before the TYPO3.Eel package became part of the Flow base
distribution. Now that Eel is available all the time the
operations can as well reside in TYPO3CR which allows to use
them without installing the Neos package at all.

This change is breaking if you extended the FlowQueryOperations
that are now moved. You need to extend from the same class in
TYPO3CR now.

The needed namespace replacement is from::

  ``TYPO3\\Neos\\TypoScript\\FlowQueryOperations``

to::

  ``TYPO3\\TYPO3CR\\Eel\\FlowQueryOperations``

Resolves: NEOS-405

* Commit: `2e8acd3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2e8acd3c357cb71a93c6cc712a5abea0f4980b67>`_

[BUGFIX] Adding custom handlebars.js breaks Neos backend
-----------------------------------------------------------------------------------------

Ember should prioritize imported Handlebars over global Handlebars to
allow Neos to use its own version if any other is loaded.

This patch is actually part of newer versions of Ember:

* https://github.com/emberjs/ember.js/pull/3910

Fixes: NEOS-301

* Commit: `0122317 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0122317a7bf2bdbb95ea8c1aeeaae4c9f9831ae6>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.Neos.NodeTypes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Adjust node type config to new super type configuration format
-----------------------------------------------------------------------------------------

Depends: I6b5c89f5c88339db99f4a81c5e6b74ec5e7ceee9

Related: NEOS-1253

* Commit: `403c7d6 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/403c7d6c5ff75bd766f19a4b7bea8c1486957dd0>`_

[TASK] CGL Cleanup
-----------------------------------------------------------------------------------------

This change is purely cosmetic and fixes CGL issues.

* Commit: `8b5285f <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/8b5285f37d54c5d3cc676a00d1017c0e73526ae3>`_

[TASK] Adjust dependencies for the 2.0 branch
-----------------------------------------------------------------------------------------

* Commit: `214e809 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/214e8090c24d9fce9ae14691915e8f8a77d84562>`_

[TASK] Update composer manifest for 2.0.*@dev
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/typo3-neos-branch/5/

* Commit: `25d1255 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/25d12557751e82d8fe2786626162b7f9e61c1407>`_

[TASK] Adjust to helper method to determine if backend rendering
-----------------------------------------------------------------------------------------

Reduces the nesting of conditions in the Image partial by using the
new helper method in Neos to find out if currently in backend.

Releaes: master
Depends: I2c48f66716dfee756418f4fdb95b958a2bb24f01

* Commit: `f7d9c99 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/f7d9c99574abf2d4d4918bc6c2c63a780886f0a2>`_

[BUGFIX] Unable to select the Menu if it's empty
-----------------------------------------------------------------------------------------

This change add a message "The menu is empty" only in the backend
context, so the user know that the menu is empty, and can select the
content element to configure it.

Resolves: NEOS-1124

* Commit: `6c65a1c <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/6c65a1c177de92b581f8c48b7e3f5180160fb08f>`_

[!!!][TASK] Disable image resizing for image properties by default
-----------------------------------------------------------------------------------------

This removes the image resizing options for image properties. This is done
since it's more common to rely on the rendering taking care of it.

If resizing is desired it can be re-enabled with the follow configuration
in the ``NodeTypes`` configuration::

  'TYPO3.Neos.NodeTypes:ImageMixin':
    properties:
      image:
        ui:
          inspector:
            editorOptions:
              features:
                resize: TRUE

Resolves: NEOS-1050
Related: NEOS-1049

* Commit: `3e7fd94 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/3e7fd94ee641a06c3fe1815447dbb9e23256f712>`_

[TASK] Streamline TypoScript and add fallback for title/caption
-----------------------------------------------------------------------------------------

Remove unecessary parts of the TypoScript as the convertUris
processing is applied with the autogenerated TypoScript already.
Additionally adds fallback for title and caption from the media
image entity.

Related: Iea35682d39189bfe9bb5cfb0709e7d90eaee2fce

* Commit: `c3c0127 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/c3c01273a26c3461b8afd03158f6f720e2fd7607>`_

[TASK] Mark recent core migrations applied
-----------------------------------------------------------------------------------------

This commit doesn't contain any changes, it simply marks recent
migrations applied so that::

  ./flow flow:core:migrate --status

won't show any open migrations for this package.

* Commit: `e786b89 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/e786b89067a4f2ce59df87196e4b6ee80fd70cc7>`_

[!!!][TASK] Cleanup multi column rendering
-----------------------------------------------------------------------------------------

This removes one unnecessary div in multi column rendering.
Without this change the column would generate a div and the
content collection another one inside. Now the ContentCollection
is the column div which makes the generated markup nicer.

This is breaking if you rely on the MultiColumnItem having a
template as MultiColumnItem is not a ContentCollection (so a
plain tag). Attributes configured for MultiColumnItem still
work as before.

* Commit: `d0a3906 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/d0a39062e6e1ab51a5e1b29b41ead009a93f13b1>`_

[!!!][TASK] Rename "Insert records" content element
-----------------------------------------------------------------------------------------

Renames the ``TYPO3.Neos.NodeTypes:Records`` node type to the less
ambiguous ``TYPO3.Neos.NodeTypes:ContentReferences`` and adjusts labels
and properties accordingly.

To adjust your existing elements, run the following node migration::

  ./flow node:migrate 20141210114800

Resolves: NEOS-847

* Commit: `faedb84 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/faedb84034a84bbef4e702cd22df1dabcafa7875>`_

[TASK] Adjust to configurable Aloha autoparagraph
-----------------------------------------------------------------------------------------

Related: NEOS-851

* Commit: `0a71e8b <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/0a71e8b50ff4034f64e5bb3d5e641e80279df3d9>`_

[TASK] Use placeholders instead of default values where possible
-----------------------------------------------------------------------------------------

For inline editable properties that use a default wrapping of a paragraph,
it's possible to use placeholders instead to avoid having to remove the
default text first. This is because unwrapped text is automatically wrapped
with in a paragraph.

Resolves: NEOS-372

* Commit: `9efa39c <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/9efa39c597131d174443f8f30dff8647abe8b5d4>`_

[BUGFIX] Order of image properties
-----------------------------------------------------------------------------------------

The order of properties in the image inspector group,
is not specfically configured meaning that the order
is determined by the configuration merging.

* Commit: `928ab2b <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/928ab2b2805babce7d98e7191506bbe6ccfc0190>`_

[!!!][TASK] Remove deprecated TYPO3.Neos:Page nodetype
-----------------------------------------------------------------------------------------

This was deprecated with the release of 1.0, let's remove it.

* Commit: `0b2662f <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/0b2662fc72f1e672c1ef983c3687ce2b0b30fd3c>`_

[TASK] Adapt to feature switches for ImageEditor
-----------------------------------------------------------------------------------------

The ImageEditor now allows to switch crop and resize on/off,
default in the editor is off but to retain backwards compatibility
for default content elements this switches both features on.

Related: Ic4d4fe0cc486b77a9f062c826f916d8f16a9257b

* Commit: `b49efa2 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/b49efa2847f3b064201d4c21e8c7e22b47def8e2>`_

[TASK] Adjust to new resource management
-----------------------------------------------------------------------------------------

Related: FLOW-108

* Commit: `3f5e250 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/3f5e250089fb507248b03b3993df1cce7b9d9803>`_

[TASK] Mark migration as merged
-----------------------------------------------------------------------------------------

This commit marks some migrations as merged that are not needed on this
package. This speeds up core:migrate and avoids potential errors.

* Commit: `5f680ed <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/5f680ed6595581c2e093c19ff02639c161290b25>`_

[BUGFIX] Adjust remaining code migration identifier
-----------------------------------------------------------------------------------------

This is another follow-up for I3dc57f55ba052bee2399ba5b97e5f985fd0a4e3a
that fixes the identifier for a code migration.
Besides this contains the corresponding "Migration" footers so that
migrations won't be applied again.

Related: FLOW-110

* Commit: `69cb1be <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/69cb1be658ae001eb8ab4025723de89d5a0aa62d>`_

[TASK] Adjust to acl changes in Flow
-----------------------------------------------------------------------------------------

Adjusts the NodeTypes package to the recent refactoring of the
Security Framework in TYPO3.Flow mainly by running the respective
code migrations.

* Commit: `f624402 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/f624402380f235611338e9895b1a866b2af0c2d4>`_

[BUGFIX] Adjust remaining code migration identifier
-----------------------------------------------------------------------------------------

This is a follow-up for I3dc57f55ba052bee2399ba5b97e5f985fd0a4e3a that
adjusts a remaining code migration that has been left out in the previous
commit.

Related: FLOW-110

* Commit: `351e429 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/351e429f715d411b84d645129249307c90d8ae36>`_

[BUGFIX] Adjust code migration identifier pattern to contain the full timestamp
-----------------------------------------------------------------------------------------

Previously code migrations are expected to have a class name with the
pattern ``Version<YYYYMMDDhhmm>`` and the unique identifier was
determined extracting the last 12 characters of the class name (which
are expected to be the timestamp).

This change adjusts existing code migrations to use the full timestamp in
order to establish the new guideline (note: those migrations still
return the old identifier so that they won't be applied again with a
new identifier).

Related: FLOW-110

* Commit: `00345bc <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/00345bc79b0ff10365efdd763d8afc56136034d2>`_

[TASK] Adjust HtmlEditor to CodeEditor
-----------------------------------------------------------------------------------------

Related: NEOS-379

* Commit: `01653ef <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/01653efe69d2208ba9662ee6d238a2485b3cefab>`_

[!!!][TASK] Hide document layout properties by default
-----------------------------------------------------------------------------------------

Since many websites won't use the layout features, it's
disabled by default but still easily available by setting
the inspector group for the properties.

If you rely on these properties, adjust your node type configuration
by setting the group on the two layout properties::

  'TYPO3.Neos.NodeTypes:Page':
    properties:
      'layout':
        ui:
          inspector:
            group: 'layout'
      'subpageLayout':
        ui:
          inspector:
            group: 'layout'

* Commit: `1e0b311 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/1e0b3112416e53bf16a365e2946c6b39be02e514>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.Neos.Kickstarter
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Adjust dependencies for the 2.0 branch
-----------------------------------------------------------------------------------------

* Commit: `ccddd66 <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/ccddd667cb36063e298180586dbb0659ffdb7bdc>`_

[TASK] Update composer manifest for 2.0.*@dev
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/typo3-neos-branch/5/

* Commit: `5bc93ef <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/5bc93efee89ccb15fbd7546c7a73159183beb3fd>`_

[BUGFIX] Uri segment empty for kickstarted sites
-----------------------------------------------------------------------------------------

The uri segment is not set for kickstarted sites which causes
an error when trying to save the root page afterwards.
A ``node:repair`` will fix it as well.

Fixes: NEOS-980

* Commit: `36a7017 <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/36a70179afcc1f3c1d7fb4eacf83a3d67be3aa79>`_

[TASK] Mark recent core migrations applied
-----------------------------------------------------------------------------------------

This commit doesn't contain any changes, it simply marks recent
migrations applied so that::

  ./flow flow:core:migrate --status

won't show any open migrations for this package.

* Commit: `1489b41 <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/1489b414bf18f7dd2e3aa1b04963b68d78358785>`_

[BUGFIX] Fix accessRoles xml tag
-----------------------------------------------------------------------------------------

Corrects the generated XML to match the expected
structure for an empty array.

Resolves: NEOS-1003

* Commit: `226e9a4 <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/226e9a4e6e3613d26b39eeb50f5418b239f5a7df>`_

[TASK] Create Resources/Public in site generation
-----------------------------------------------------------------------------------------

As this is the Generator for a site, we can be fairly sure that it will
contain public resources so we should create the Resources/Public folder.
The best practice folders "Images", "JavaScript" and "Styles" are also
created.

* Commit: `02ad4e6 <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/02ad4e6ffdab87e93edde74ea3180a76f6168934>`_

[BUGFIX] Add default dimension values when kickstarting a new site
-----------------------------------------------------------------------------------------

The site kickstarter never added any dimension values to the generated
Sites.xml, this would result in an unusable site if dimensions where
configured as the nodes without dimension values wouldn't be found.

With this change the current dimension defaults are added to the
generated Sites.xml.
This still means that kickstarting a site, then adding dimensions and
importing will result in a problem. But this should be solved on the
Neos side in a general way.

Fixes: NEOS-757

* Commit: `6bf83c5 <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/6bf83c5bc01925184b8feca12754badf7e7c827a>`_

[TASK] Kickstarted packages suggest TYPO3.Neos.Seo package
-----------------------------------------------------------------------------------------

Adjusts the generated composer manifest to contain a suggested dependency
to the "typo3/neos-seo" package.

Besides this tweaks the generated ``NodeTypes.yaml``.

Resolves: NEOS-785

* Commit: `d5921d0 <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/d5921d06ad4dae0e619fb6710132fe3189b53ad2>`_

[TASK] Adjust Sites.xml template to new format
-----------------------------------------------------------------------------------------

With support for content dimensions the XML format has been adjusted. This
change updates the template used to kickstart sites to that new format.

The indentation is changed from tabs to spaces, as the site export uses spaces
to indent as well.

Related: NEOS-166
Related: NEOS-158

* Commit: `ebaf91d <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/ebaf91df2c4dd87f309471ebf7d92e6643b083a1>`_

[BUGFIX] Make special characters in sitename possible
-----------------------------------------------------------------------------------------

When using special charcters in the sitename while
creating a new site with the kickstarter the generated
site.xml is rendered broken.

Resolves: NEOS-493

* Commit: `951c78c <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/951c78c08e73e14ed5f8de3bfc76da476a70b3d3>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.TYPO3CR
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Change configuration syntax for defining node super types
-----------------------------------------------------------------------------------------

Changes the configuration syntax for defining node super types to
be similar to the constraints syntax. This is done to make it more
clear when having to unset super types, without having to use a custom
key. Now the key is the node type name and the value is an enable flag.

The change is fully backwards compatible with the old syntax, however
it's recommended to switch to the new syntax.

Resolves: NEOS-1253

* Commit: `1f7f180 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/1f7f1809fcca8ec62a12b0b2a730d6b1a38be82b>`_

[BUGFIX] Persist nodes even if only the ``removed`` flag is set
-----------------------------------------------------------------------------------------

When only the ``removed`` flag was set, the node wasn't updated in
persistence because ``NodeData::remove()`` didn't call ``addOrUpdate()``.

This change fixes the issue by unifying the behavior of the ``remove()``
and ``setRemoved()`` methods (the latter one is required for
Property Mapping to work).

Fixes: NEOS-1252

* Commit: `2f66311 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/2f66311e81d7cf678d070a9dfbc987b142610f15>`_

[BUGFIX] ChildNode constraints check needs to be lowercased
-----------------------------------------------------------------------------------------

Since all node paths are lowercase the constraints check for
childNodes must be done against the lowercased node name to match
properly. To be more precise any changes applied to the configured
nodeName in
``\\TYPO3\\TYPO3CR\\Domain\\Model\\NodeType::getAutoCreatedChildNodes()``
must also be applied to incoming node names in
``\\TYPO3\\TYPO3CR\\Domain\\Model\\NodeType::allowsGrandchildNodeType()``

Fixes: NEOS-1234

* Commit: `082e5ec <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/082e5ec00b947677f8c7e7a8c3e228d3e4f61320>`_

[BUGFIX] Reducing nodes by dimensions works for nodes without
-----------------------------------------------------------------------------------------

The `NodeDataRepository` filters query results with the method
`reduceNodeVariantsByWorkspacesAndDimensions` which works as
long as all nodes in your database have the same dimensions.
Especially the case that you have nodes with some dimensions and
nodes without any dimensions is not handled well if no dimensions
are used (configured).

Given you have two variants of a node, one with dimensions one
without. If you ask the `NodeDataRepository` for a node with that
identifier and no dimensions it would (wrongly) return the node with
dimensions. This change adapts the matching algorithm for the specific
case of matching against empty dimension values.

* Commit: `d3f6645 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d3f66451002a369c5c0cf1ea5b32cb7349da0da4>`_

[BUGFIX] Node Import must generate Node Identifier if not part of dump-file
-----------------------------------------------------------------------------------------

This is a regression to If7e6598b176528252c720344cb240e34be163e2e - it reverts
this part of that change, and adds a unit test case to prevent the error
from happening in the future.

* Commit: `2659139 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/26591391c1c4183157d71809bae490a2ce77fed7>`_

[TASK] Code cleanup in `NodeImportService`
-----------------------------------------------------------------------------------------

* Commit: `85bc376 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/85bc376405b0fe4db12ed0ffd807b160fc85fd23>`_

[TASK] Adjust dependencies for the 2.0 branch
-----------------------------------------------------------------------------------------

* Commit: `825f98e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/825f98e054c534fc54458317d0896df78f8bde14>`_

[BUGFIX] Update functional test export fixture
-----------------------------------------------------------------------------------------

Prevents an error caused by using the old format which
results in the imported site containing a `TYPO3.Neos:Shortcut`
node as root, which leads to constraint issues.

* Commit: `ea7f649 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/ea7f64917c2e7cf0da5ae07fd9cf3c771cd71d74>`_

[BUGFIX] ImportService should import with lowercase paths
-----------------------------------------------------------------------------------------

The change I890ea84ec26f1fba00f72b200e959e3c0fc30f94 introduced a
regression for importing sites from the Sites.xml. Paths in there
would be used as is, so nodes with paths containing uppercase
characters could never be found.

This change adds the necessary lowercasing of paths found in the
imported Sites.xml file.

Fixes: NEOS-1237

* Commit: `011bd42 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/011bd42411f577916764cf3c52a78cdd0c67049a>`_

[TASK] Improve debug output for node objects by excluding large classes
-----------------------------------------------------------------------------------------

With the change `If4a692168d317cbcb7527fb28ebb113705f7c500` in
TYPO3.Flow the ignoredClasses are configurable in the settings.
This change adds ignoredClasses for this package to improve the
debug output for node objects.

Depends: If4a692168d317cbcb7527fb28ebb113705f7c500
Resolves: NEOS-1140

* Commit: `30cf3fa <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/30cf3fab19cdede534f823816cc97ff2c4833d95>`_

[TASK] Optimize `renderValidNodeName` utility method
-----------------------------------------------------------------------------------------

Checks the given name against the name pattern before doing
expensive unnecessary transliteration.

Related: NEOS-1237

* Commit: `6e1b1cf <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/6e1b1cfccfecf6bf2f269585ad61f002f85b29df>`_

[BUGFIX] Node querying must be case insensitive
-----------------------------------------------------------------------------------------

A regression in `I890ea84ec26f1fba00f72b200e959e3c0fc30f94` lead to
creation of auto created child nodes failing if they contained
uppercase characters in their name.

Additionally hard coded queries for node paths weren't lowercased
automatically to avoid breaking changes.

To prevent these scenarios the node querying is always done with
lowercase paths automatically and the auto created child node names are
processed with the `renderValidNodeName`.

Related: NEOS-1195
Related: NEOS-1081

* Commit: `5272e1e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5272e1e1c8026e39d9adaac06e7155f84710ec8c>`_

[BUGFIX] Defined privileges have wrong YAML syntax
-----------------------------------------------------------------------------------------

The privilege defined for a Behat feature does not follow YAML syntax
so it will fail if using a strict parser. This fixes the error.

* Commit: `82a9f52 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/82a9f52232be86015449d0448bafdc42badbde7e>`_

[BUGFIX] Ignore NodePrivileges that don't match any node
-----------------------------------------------------------------------------------------

When ``isDescendantNodeOf()`` translates node identifiers into their
respective node path, it needs to return a false SQL condition, if the
node does not exist.

Background:
Previously this returned ``NULL`` if the referenced node could not be
found, but NULL is converted to a ``TrueConditionGenerator`` in the
``EntityPrivilege``.

Related: NEOS-5

* Commit: `19bfb01 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/19bfb01f50a6e7aef76b089fe9d7064aed008065>`_

[BUGFIX] Disable authorization checks during node import/export
-----------------------------------------------------------------------------------------

This change makes sure that TYPO3CR imports/exports are not intercepted
by authorization checks.

Background:
In CLI mode security is disabled anyways, but the Import/ExportServices
can also be triggered through HTTP requests (e.g. in the Neos setup).
If the site to import/export is protected with privileges, those
shouldn't intercept the process.

Related: NEOS-5

* Commit: `b5baaab <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/b5baaabe8f39dc4260f33f4072494db4706604d2>`_

[FEATURE] Constraints configuration for content dimension presets
-----------------------------------------------------------------------------------------

This change introduces a new configuration option for the content
dimension settings which allows for defining allowed and disallowed
combinations of content dimension presets. For example, it is now
possible to allow the combination of "English" and "Germany" for the
dimensions "language" and "country" respectively, but disallow the
combination "German" and "United States".

The configuration syntax basically matches the syntax of node type
constraints.

An example::

	TYPO3:
	  TYPO3CR:
	    contentDimensions:
	      'language':
	        default: 'en'
	        defaultPreset: 'en'
	        label: 'Language'
	        icon: 'icon-language'
	        presets:
	          'en':
	            label: 'English'
	            values: ['en']
	            uriSegment: 'en'
	          'de':
	            label: 'German'
	            values: ['de']
	            uriSegment: 'de'
	            constraints:
	              country:
	                'de': TRUE
	                '*': FALSE
	          'fr':
	            label: 'French'
	            values: ['fr']
	            uriSegment: 'fr'
	            constraints:
	              country:
	                'fr': TRUE
	                '*': FALSE

Resolves: NEOS-1205

* Commit: `33b279b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/33b279b28905019b7e95e8ecfcd0e6ce2a7c161a>`_

[!!!][BUGFIX] Node path should always be lowercase
-----------------------------------------------------------------------------------------

The change `I4649436ae6dfa2f386d9c5b656680ba87be25002` had some
undesired side effects by allowing uppercase characters in generated
node paths. In general all node paths should be lowercase
to avoid similar issues. Since the node path is primarily internal,
it's fine to force it to be lowercase.

This is breaking in case you have nodes with names that have uppercase
letters and they are referenced by their path somewhere.

Fixes: NEOS-1195
Related: NEOS-1081

* Commit: `cac7405 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/cac740591301d55fc2034179835bf19788a9c597>`_

[TASK] Add runtime cache to getSubNodeTypes()
-----------------------------------------------------------------------------------------

This adds a runtime cache to NodeTypeManager::getSubNodeTypes(),
drastically lowering the calls to NodeType::isOfType().

In my test setup the number of calls to isOfType() went down from
over 212.000 to a little over 3000.

* Commit: `3cb94c3 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/3cb94c3faee6f3840567042f76c50de46cac0c9f>`_

[BUGFIX] Check if $dateTime is a DateTime object before calling format()
-----------------------------------------------------------------------------------------

This change adds 2 checks to see if $dateTime is really a DateTime
object before calling the format() method. The lack of this check could
cause fatal errors when publishing pages after clearing the hidden
after / before date time.

Resolves: NEOS-1219

* Commit: `d1338e1 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d1338e1741645771f62725a37672a900873e6e33>`_

[BUGFIX] Allow publishing of nodes with modified schema
-----------------------------------------------------------------------------------------

This is a follow-up to "Allow publishing of nodes with modified schema"
(Id03709f32eb5d238334a7d5a0ddf509117e14021) that prevents ``Now`` to be
injected as ``DependencyProxy``.

Background:
When injecting objects via ``Flow\\Inject`` annotations, Flow generates
a proxy object to save memory in case the object is not actually used.
When the proxy is passed to a type hinted method before it has been
activated, a Fatal Error is triggered.

Related: NEOS-1172

* Commit: `f8e625e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/f8e625e51fca5aab3cf36fcde48066337332d078>`_

[BUGFIX] `findByProperties` now allow directly on `pathStartingPoint`
-----------------------------------------------------------------------------------------

When giving the `findByProperties` a `pathStartingPoint` it should also
allow nodes with that exact path in addition to child nodes as results.

Fixes: NEOS-1212

* Commit: `5c99ea8 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5c99ea870505253d973abe07d4d6f9781aace10a>`_

[BUGFIX] Allow publishing of nodes with modified schema
-----------------------------------------------------------------------------------------

When changing node types on existing nodes, the following publication would
fail under certain circumstances (see issue NEOS-1172 for details). This
change fixes those problems.

Adds a behat test as well: "When changing the node type of a node in my
workspace to one that has fewer properties it is still possible to publish it"

Resolves: NEOS-1172

* Commit: `ebc967c <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/ebc967cf04631245920cf3061d1c7cd8d8504fc9>`_

[TASK] Add some additional Behat scenarios about moving nodes
-----------------------------------------------------------------------------------------

This adds some more scenarios about moving nodes. In fact they cannot
show the bug explained in NEOS-1199 as that is a result of the
Neos NodeOperations service behaving wrongly.
Still those additional tests might be useful.

Related: NEOS-1199

* Commit: `c6efe9d <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c6efe9d4b119fbad82a804c5be79ba26852d2194>`_

[TASK] `NodeService` method to check if nodepath can be used for node
-----------------------------------------------------------------------------------------

Adds method `nodePathAvailableForNode()` to the `NodeService` which can be
used to check if a node can be allowed to be placed in a given path.
This is needed to ensure that a node can be moved back to a location where a
shadow node has been created in it's former place.

Related: NEOS-1203

* Commit: `e607ce1 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/e607ce1c92dc2007c20cf8c0edecd20275743f48>`_

[BUGFIX] Incorrect handling of associative arrays in NodeConverter
-----------------------------------------------------------------------------------------

Node properties of type array should convert incoming JSON objects
into associative arrays instead of stdClass objects.

Fixes: NEOS-1194

* Commit: `10b74b7 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/10b74b794c70ace474aac77748527137e1acf325>`_

[BUGFIX] Don't generate NodeTemplate node name from the title property
-----------------------------------------------------------------------------------------

The node name shouldn't be generated from the title property since
it's internal and causes conflicts if the title changes later on.

* Commit: `986c795 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/986c7959c6318eb69279d4b9256ad22a148db7f6>`_

[!!!][BUGFIX] Minor changes to improve CR performance
-----------------------------------------------------------------------------------------

Calls to ``persistEntities()`` does not iterate over all nodes
anymore and ``findHighestIndexInLevel()`` uses a caching property.

Additionally logic to create the workspace in a ``Context`` was
streamlined to use less queries.

This is breaking if you rely on the fact that persists are triggered
for each newly created Node. This was a side effect of assigning
the highest index to the newly created Node and is now no longer
needed in all cases. Therefor tests need to be adapted so that
they do no longer rely on this behavior.

Fixes: NEOS-1189

* Commit: `5bcf364 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5bcf3646d351837302db8322122865116fb1835e>`_

[BUGFIX] JSON storage compatible method to find by properties
-----------------------------------------------------------------------------------------

Replaces the method
``findByRelationWithGivenPersistenceIdentifierAndObjectTypeMap`` with
a new method ``findNodesByRelatedEntities`` that finds entity relations
in node properties. This is used by Neos to detect related assets in
Nodes and prevent deletion of those.

The above mentioned method as well as ``findByProperties`` now also
work with postgresql and json column types by casting to string.

Related: NEOS-1112

* Commit: `59d1a33 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/59d1a332e3b8a8aab40e0b6a1a8819bdfc300670>`_

[TASK] Add some additional behat scenarios about moving nodes
-----------------------------------------------------------------------------------------

This adds some more scenarios about moving nodes. In fact they cannot
show the bug explained in NEOS-1199 as that is a result of the
Neos NodeOperations service behaving wrongly.
Still those additional tests might be useful.

Related: NEOS-1199

* Commit: `5180a0a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5180a0a593f587288e60802c8a51ad432e185c6d>`_

[BUGFIX] Fix regression introduced with JSON storing
-----------------------------------------------------------------------------------------

As the JSON storing doesn't handle DateTime objects the same as
serialize, we need to adjust exports to that.

Related: I78a9e8c5d1d48202fd5b6a6be39abe59eee93f19

* Commit: `da7f72e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/da7f72e7b0ed266e3fba2d824c51396c5f5fe308>`_

[TASK] Add missing PostgreSQL migrations
-----------------------------------------------------------------------------------------

The JSON properties change lackedd the NOT NULL definitions
for the PostgreSQL migrations. This change adds them to
get the migrations in line again.

* Commit: `f98124b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/f98124bb6d7e04eb9007c28c5cf49c6decd38181>`_

[BUGFIX] Make functional tests run isolated
-----------------------------------------------------------------------------------------

Functional tests in TYPO3CR didn't work running isolated due to
missing Security Context. This change adds testable security to the
AbstractNodeTest.

Fixes: NEOS-1186

* Commit: `763159b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/763159b26741c6d5a349d4a2fbc72b848086b956>`_

[BUGFIX] Return correct denied node types in AuthorizationService
-----------------------------------------------------------------------------------------

This fixes the behaviour of the node ``AuthorizationService``, to
return all registered node types, if the user has no grant privilege
on a ``CreateNodePrivilege`` targeting no specific node types.

Related: NEOS-163

* Commit: `d7aae26 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d7aae26f4ebb3b6ac1fbc2744ec2f4e12602efd4>`_

[FEATURE] Support for node identifiers in "isDescendantNodeOf" matcher of NodePrivileges
-----------------------------------------------------------------------------------------

This change extends the ``isDescendantNodeOf`` matcher of node
privileges to accept a node identifier in addition to its path.

Background:
The node path is not reliable because
it changes if a node is moved. Besides the path is not "human-readable"
in Neos because new nodes get a cryptic name.
Therefore it's best practice not to rely on the path but on the
identifier of a node.

Related: NEOS-28

* Commit: `e9f84e0 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/e9f84e04f322cd5d9953cd788ffda89ac191c04b>`_

[FEATURE] EditNodePropertyPrivilege
-----------------------------------------------------------------------------------------

A privilege that targets editing of node properties in the TYPO3CR.

Usage (in ``Policy.yaml``)::

 privilegeTargets:

   'TYPO3\\TYPO3CR\\Security\\Authorization\\Privilege\\Node\\EditNodePropertyPrivilege':

     'Some.Package:SomeIdentifier':
       matcher: 'isDescendantNodeOf("/sites/typo3cr/service/teaser") && nodePropertyIsIn(["hidden", "name"])'

This would add a privilege that intercepts editing properties of the node
`/sites/some-site/some-path` node (and all of its child-nodes) unless
explicitly granted to the current role.

Resolves: NEOS-948

* Commit: `1bedab5 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/1bedab506987ddd90a75f275b1bc3dc0a62faafc>`_

[BUGFIX] Initialize security in behat tests
-----------------------------------------------------------------------------------------

This is needed to to the refactoring done in
I3c459e4e11f93f6d95f2073226ca4e8137356017.

* Commit: `e761d39 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/e761d39d49de542dfd6e62a760b59b4922c6ab27>`_

[FEATURE] ReadNodePropertyPrivilege
-----------------------------------------------------------------------------------------

A privilege that targets editing of nodes in the TYPO3CR.

Usage (in ``Policy.yaml``)::

 privilegeTargets:

   'TYPO3\\TYPO3CR\\Security\\Authorization\\Privilege\\Node\\ReadNodePropertyPrivilege':

     'Some.Package:SomeIdentifier':
       matcher: 'isDescendantNodeOf("/sites/some-site/some-path")'

This would add a privilege that intercepts reading properties of the node
`/sites/some-site/some-path` node (and all of its child-nodes) unless
explicitly granted to the current role.

Resolves: NEOS-33

* Commit: `3ed3c41 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/3ed3c413d7606ff32e842a0b0585803e1884b202>`_

[FEATURE] RemoveNodePrivilege
-----------------------------------------------------------------------------------------

A privilege that targets deletion of nodes from the TYPO3CR.

Usage (in ``Policy.yaml``)::

 privilegeTargets:

   'TYPO3\\TYPO3CR\\Security\\Authorization\\Privilege\\Node\\RemoveNodePrivilege':

     'Some.Package:SomeIdentifier':
       matcher: 'isDescendantNodeOf("/sites/some-site/some-path")'

This would add a privilege that intercepts deletion of the
`/sites/some-site/some-path` node (and all of its child-nodes) unless
explicitly granted to the current role.

Resolves: NEOS-947

* Commit: `8ba757a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/8ba757a3aff4d4ba41641cdc4742a9076db96795>`_

[TASK] Change to JSON storage for properties and dimensionValues
-----------------------------------------------------------------------------------------

Storing node properties serialized is error prone and hard to
use. Additionally the BLOB it is stored in doesn't allow case
sensitive searches.

This change implements a new JsonArray data type for Doctrine
that stores the node properties JSON encoded.

Resolves: NEOS-427
Depends: I7eeb7d55e8ee593cae5bccf98211e4a2ff83b1d8

* Commit: `7ea214b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/7ea214bd73006401e744a9fb59de8c081ac705bd>`_

[FEATURE] CreateNodePrivilege
-----------------------------------------------------------------------------------------

A privilege that targets creation of nodes in the TYPO3CR.

Usage (in ``Policy.yaml``)::

 privilegeTargets:

   'TYPO3\\TYPO3CR\\Security\\Authorization\\Privilege\\Node\\CreateNodePrivilege':

     'Some.Package:SomeIdentifier':
       matcher: 'isDescendantNodeOf("/sites/some-site/some-path") && createdNodeIsOfType("TYPO3.Neos.NodeTypes:Text")'

This would add a privilege that intercepts creation of `Text` nodes in
the `/sites/some-site/some-path` node (and all of its child-nodes) unless
explicitly granted to the current role.

Resolves: NEOS-163

* Commit: `22f284d <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/22f284d1df52dbb1d324cce96d2920364a4b638e>`_

[BUGFIX] Prevent issues with mixed case node paths
-----------------------------------------------------------------------------------------

The node name match pattern in NodeInterface is case insensitive,
but the utility to render a valid node name enforces them to be
case insensitive. This is change removes the strtolower call
to make the utility consistent with the pattern.

Besides that the change checks if auto created child nodes
already exist before creating them to prevent constraint
errors on node copy.

Resolves: NEOS-1081

* Commit: `be8db4d <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/be8db4d6cb170bd9120d93bdfdbfd2c4265ef0f3>`_

[TASK] Refactor shadow node generation to NodeData class
-----------------------------------------------------------------------------------------

Shadow nodes are purely internal so ``Node`` should not be
responsible to create or deal with shadow nodes at all.
Shadow nodes are also no longer exposed to the outside world
as the ``NodeFactory`` no longer creates ``Node`` instances
from shadow nodes. To do that the ``NodeData`` class got the
new method ``isInternal()`` which returns a boolean to mark
the object as purely internal preventing the NodeFactory to
create a ``Node`` object. a ``NodeData`` currently identifies
as internal if it has the ``movedTo`` property set AND
``removed`` is TRUE.

Fixes: NEOS-1013

* Commit: `87ee1b0 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/87ee1b024a2661d56d0b7306791c0b2675d12cce>`_

[TASK] More graceful handling of non-existing migrations
-----------------------------------------------------------------------------------------

The node:migrate command exited with an uncaught exception if the
specified migration does not exist. This change will catch the
exception and display the error message instead.

* Commit: `b2221b1 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/b2221b11a52a75def9fac816ef74c2a9c163bd2d>`_

[TASK] Skip unnecessary updates in node setters
-----------------------------------------------------------------------------------------

Prevents unnecessary signals and database updates when calling setter
methods on a Node with the existing value. Without it performance
decreases exponentially with the amount of properties being set using
the NodeConverter e.g.

Resolves: NEOS-1060

* Commit: `e5cd0e3 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/e5cd0e3e16a29cbbb9aa31a3a7452c0d2baa6dc4>`_

[BUGFIX] Remove unused injections from NodeCommandController
-----------------------------------------------------------------------------------------

As funtionality was moved out some injections became
unnecessary and should be removed.

* Commit: `2351b65 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/2351b657d127e36f11227f19d56eef11c30d4811>`_

[TASK] Add "cleanup" schema migrations
-----------------------------------------------------------------------------------------

This adds migrations for MySQL and PostgreSQL that tweak the DB schema a
bit, cleaning up some leftover discrepancies.

* Commit: `accee62 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/accee62625cf1ede8a5ba3e4d2b3099007812561>`_

[BUGFIX] Fix error in PostgreSQL down migration
-----------------------------------------------------------------------------------------

In the down migration of Version20140826164247 a FK constraint and an
index were dropped "twice" (dropping a column removes related items
already).

* Commit: `6ee82da <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/6ee82da0cde54b06f136d2e38bd2189b922f7559>`_

[FEATURE] EditNodePrivilege
-----------------------------------------------------------------------------------------

A privilege that targets editing of nodes in the TYPO3CR.

Usage (in ``Policy.yaml``)::

 privilegeTargets:

   'TYPO3\\TYPO3CR\\Security\\Authorization\\Privilege\\Node\\EditNodePrivilege':

     'Some.Package:SomeIdentifier':
       matcher: 'isDescendantNodeOf("/sites/some-site/some-path") && nodeIsOfType("TYPO3.Neos.NodeTypes:Text")'

This would add a privilege that intercepts editing of ``Text`` nodes
on the ``/sites/some-site/some-path`` node (and all of its child-nodes)
unless explicitly granted to the current role.

Resolves: NEOS-650

* Commit: `85ed911 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/85ed911c1b14d22322fecbfde3947d157ad92a13>`_

[TASK] Remove on-the-fly repair for broken references
-----------------------------------------------------------------------------------------

In https://review.typo3.org/25468 some on-the-fly repair code was
added. This is removed with this change, since the expected data should
now really be what it is to be expected.

* Commit: `a6225ae <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/a6225aee8e3d8c269768dfdb9a72d5ee4ea5aed0>`_

[TASK] Remove workaround for returning objects for references
-----------------------------------------------------------------------------------------

``AbstractNodeData::getProperty()`` has a workaround for ``references``
to return objects instead of identifiers. This is not really meaningful
and means giving a context object to AbstractNodeData.
The workaround is (not anymore) used anywhere in the Neos code and
should therefor be removed.

* Commit: `082a9ca <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/082a9caed1e6264600a1fbd33effbd00e2a40f5b>`_

[BUGFIX] Remove shadow nodes for moved nodes in user workspace
-----------------------------------------------------------------------------------------

If a node was not yet published to the live workspace and moved in the
user workspace, the shadow node data (which is marked as removed) was
not removed. This leads to strange effects where nodes disappear for
individual users.

Fixes: NEOS-1068

* Commit: `4763f3f <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/4763f3f1a90c6f3725064674456a6edb3dd1d590>`_

[TASK] Node should persist related entities
-----------------------------------------------------------------------------------------

Until now entities related to a Node had to be persisted manually when
a change to them was made while updating the Node. This happens now
since entities are no longer serialized to the Node.

For Media entities the TypeConverter of the Media package takes care
of persisting since the resource changes. This is bad architecture wise
and also not future proof for relations with other entities. Therefor
the Node itself needs to take care of persisting entities related to it.

* Commit: `8c12328 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/8c1232834bfe42cf6b5ee90cdd2e111d8c9300fd>`_

[FEATURE] ReadNodePrivilege
-----------------------------------------------------------------------------------------

This change adds the ``ReadNodePrivilege`` that can be used to limit
access to certain sub-parts of the TYPO3CR::

 privilegeTargets:
   'TYPO3\\TYPO3CR\\Security\\Authorization\\Privilege\\Node\\ReadNodePrivilege':
     'Your.Package:MembersArea':
       matcher: 'isDescendantNodeOf("/sites/yoursite/some/path")'

With this ``Policy.yaml`` configuration, the node on path
"/sites/yoursite/some/path" and all its child nodes will be hidden from
the system unless explicitly granted to the current user::

 roles:
   'Your.Package:SomeRole':
     privileges:
       -
         privilegeTarget: 'Your.Package:MembersArea'
         permission: GRANT

Resolves: NEOS-945

* Commit: `6eaa204 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/6eaa204ebcb1ab0f5b594338ae2c636c420d9d2f>`_

[TASK] Mark recent core migrations applied
-----------------------------------------------------------------------------------------

This commit doesn't contain any changes, it simply marks recent
migrations applied so that::

  ./flow flow:core:migrate --status

won't show any open migrations for this package.

* Commit: `66183e8 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/66183e8506b1aea7f53a373bc3ab77a75fd23966>`_

[FEATURE] Accept node type filter in node export service
-----------------------------------------------------------------------------------------

This can be used to export only nodes of a certain type or selectively exclude
some types during export. See https://review.typo3.org/32998 for a related
change making use of it.

Related: NEOS-438

* Commit: `eee3dcf <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/eee3dcff19614d0fd0758f57890f8391770eb56b>`_

[!!!][BUGFIX] Fix unique constraint for workspace/dimensions
-----------------------------------------------------------------------------------------

Run ``./flow doctrine migrate`` to adjust the database.

The unique constraint https://review.typo3.org/36845 added lacked the
movedto column and broke shadow nodes.

This is breaking if you were unlucky enough to migrate between the merge
of the the aforementioned change and this very change. In that case, drop
the wrong constraint::

  DROP INDEX UNIQ_60A956B9772E836A8D94001992F8FB01 ON typo3_typo3cr_domain_model_nodedata -- MySQL
  DROP INDEX UNIQ_60A956B9772E836A8D94001992F8FB01 -- PostgreSQL

and then run this for MySQL::

  ./flow doctrine:migrationversion --version 20150211181736 --delete
  ./flow doctrine:migrate

and this for PostgreSQL::

  ./flow doctrine:migrationversion --version 20150211181737 --delete
  ./flow doctrine:migrate

Related: NEOS-1002

* Commit: `a5dfac3 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/a5dfac3e8bec2df733185088ddee6775035acc4f>`_

[!!!][BUGFIX] Node data identifier not unique for workspace/dimensions
-----------------------------------------------------------------------------------------

Run ``./flow doctrine migrate`` to adjust the database.

This prevents a node duplicate identifier in the same workspace with
the same dimensions, by adding a constraint across identifier,
workspace and dimensions. Without it unexpected behavior can occur
when finding nodes by their identifier, e.g. used for references and
links.

Fixes: NEOS-1002

* Commit: `d1bdf04 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d1bdf04950ec512dbb7d7fa1a5a127b5d28aedec>`_

[BUGFIX] Two unit tests updated to recent merges
-----------------------------------------------------------------------------------------

Two UnitTests are not updated to the change merged with
I13b5a1a58beb70260b3ea3321a0d81e81a829ae3
They lack a mocked nodeTypeManager which is added with this
fix.

Releaes: master

* Commit: `4d21300 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/4d213002df5973ea6e9fc12b4f13395bfadf5b1b>`_

[BUGFIX] Sites with the same prefix are exported multiple times
-----------------------------------------------------------------------------------------

This fixes a case where nodes were exported multiple times, if one site
node name is the prefix of other site node names. This lead to duplicate
key constraint errors during the import.

Related: NEOS-991

* Commit: `e823d67 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/e823d673f87b9ea159666238a384546d787c7b10>`_

[BUGFIX] Skip nodes that have no connection to a parent node
-----------------------------------------------------------------------------------------

This fixes the site export for repositories that contain broken nodes
without a proper rootline (one or multiple parent nodes in the path
are missing).

Related: NEOS-991

* Commit: `331ba24 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/331ba24041fb761dc4561655c0506915a6b7580f>`_

[BUGFIX] Fix parsing of ``accessRoles`` during import
-----------------------------------------------------------------------------------------

This fixes the ``NodeImportService`` that choked on site exports that
contained non-empty ``accessRoles``.

Background:
We currently don't use/evaluate the ``accessRoles``, thus the
``site:export`` command generates empty and self-closing accessRoles
tags::

 <accessRoles __type="array"/>

If accessRoles are *not* empty (as it was the case in the manually
generated Sites.xml of the ``TYPO3.SiteKickstarter`` package (see
I04bdd9fb750df7017ec81d8b600f6bb3ba427a87) the import failed.

Fixes: NEOS-1003

* Commit: `e5c811f <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/e5c811f260f7cdbbe75110416de2f156ccda4711>`_

[BUGFIX] Fix behavior of NodeData::hasAccessRestrictions()
-----------------------------------------------------------------------------------------

This replaces the hard-coded check for the "Everybody" role with a
check for the fully qualified role identifier "TYPO3.Flow:Everybody".

Besides this adds tests for the the modified "isAccessible()" behavior
introduced with Ia3a6220ae7fc7224b272794dba301fba2c617876

* Commit: `2de54ad <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/2de54adf65d30d57faf895a1f8854b94f055e7d9>`_

[BUGFIX] Fix two failing unit tests
-----------------------------------------------------------------------------------------

This fixes two tests of the NodeDataTest test case that failed due to
some unexpected method sequence indexes.

Besides this cleans up the test case in order to simplify debugging and
refactoring.

* Commit: `02a60ae <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/02a60aea547fe96ac2a081c7d46d7fe567c74665>`_

[TASK] Behat test foundation and authorization service for node privileges
-----------------------------------------------------------------------------------------

This changes adds needed behat foundation functionality to test
node privileges. It also adds the stub for an authorization service,
actioning as API to retrieve node related permissions.

Related: NEOS-28

* Commit: `0fddd5b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/0fddd5b811aee0ef4446841a0638d3e0db8a0bbc>`_

[TASK] Remove excludeClasses setting
-----------------------------------------------------------------------------------------

The excludeClasses setting has been deprecated, and in this case can be
removed completely.

* Commit: `a3766f5 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/a3766f5ed544de74f3b657eca1d921deeaf3b823>`_

[TASK] Fix failing unit tests related to SecurityContextHash
-----------------------------------------------------------------------------------------

The change 'Respect "SecurityContextHash" in Context cache' left some
failing unit tests behind. This change fixes them.

Related: NEOS-433

* Commit: `588d456 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/588d4564f6c3cd74231178412a3eea1051282261>`_

[TASK] Respect "SecurityContextHash" in Context cache
-----------------------------------------------------------------------------------------

Adjusts the ``ContextFactory`` to respect the current
``SecurityContextHash`` in order to prevent protected nodes to be
available to unauthorized users.

Background:
The ``FrontendNodeRoutePartHandler`` of the Neos package fetches nodes
without authorization checks. Without this change protected nodes might
end up in the current ``FirstLevelNodeCache``.

Related: NEOS-433

* Commit: `495091e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/495091e82fb7296c638fbf9f97fe1ee47145d93b>`_

[FEATURE] Node privilege groundwork
-----------------------------------------------------------------------------------------

This change adds some basic classes that allow creation of node specific
privileges.

Related: NEOS-28

* Commit: `954244a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/954244a88a5503b58858b64e74ddeeaa7a56b91f>`_

[!!!][FEATURE] Creation, last modification & last publication dates
-----------------------------------------------------------------------------------------

Adds a composer dependency on "gedmo/doctrine-extensions".

Implements creation date, last modification date & last publication date
for nodes using DateTime properties in NodeData. The creation date &
last modification dates are set when creating a new node. The creation
date is copied for proxy nodes, but not when copying nodes. The last
modification date is updated using the Timestampable behavior extension
from DoctrineExtensions and is updated with every node update (except
for some specific properties). The last publication date is null by
default and set when a node is published to another workspace. The last
modification date is copied for proxy nodes, but not when copying nodes.

Resolves: NEOS-194

* Commit: `fafb6c5 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/fafb6c5a48f6bd363028ac7cfb2f906a523d4c34>`_

[BUGFIX] Exception when setting a node's path if it's unchanged
-----------------------------------------------------------------------------------------

Prevents an exception caused by checking for other nodes with the same
path and finding itself, when the path is set to the existing path.
This can happen through the node converter e.g.

* Commit: `370aefa <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/370aefa7f54e5a70fb97780cb4cb65bd8e04545a>`_

[FEATURE] Support hidden before/after in site import/export
-----------------------------------------------------------------------------------------

Handle the hidden before/after date time properties in the site
import/export functionality.

Resolves: NEOS-990

* Commit: `51b6c33 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/51b6c33b6ae44ac88c730bbfed21a05dcfb3258f>`_

[!!!][TASK] Add charset and collation to all MySQL migrations
-----------------------------------------------------------------------------------------

This change set adds charset and collation to create table statements
in the existing migrations. This make sure the tables are set up
correctly independent of the database default configuration.

Also migrations generated contain this information since a while,
leading to problems on migration if the database is not using the same
charset and collation.

This is breaking if you have existing tables that do not use the utf8
charset and utf8_unicode_ci collation. To solve this you need to convert
the existing tables. This can be done using the command::

  ./flow database:setcharset

Related: NEOS-800

* Commit: `118c8c9 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/118c8c974971623e378a200c8c07b41fc1edfd2b>`_

[TASK] Removed deprecated use of Inject for settings
-----------------------------------------------------------------------------------------

This removes the use of the Inject annotation for settings and instead
uses the new InjectConfiguration annotation instead.

Related: FLOW-148

* Commit: `51f9590 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/51f95903655c76276c904fd5e88015692a8e8e38>`_

[BUGFIX] Support import of multiple sites
-----------------------------------------------------------------------------------------

This change fixes a problem with the import of multiple sites. The end
element for nodes was not correctly discovered, such that the nodes of
the second site would break the import.

For more robustness in these cases the change introduces an exception if
an unknown XML element is processed.

Related: NEOS-991

* Commit: `0c77064 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/0c770641eb50895873f7e3c50a47c7bdd0269726>`_

[TASK] Improve query performance by avoiding DISTINCT
-----------------------------------------------------------------------------------------

This changes queries in the NodeDataRepository so that no joins to
the NodeDimensions happen, instead a subquery is used.
Due to this the DISTINCT function can be avoided which results in
MySQL using no temporary table (which in case of NodeData will
always be a disk based temporary table).

A typical query for childnodes of a certain type in a specific
dimension is about 3x faster on the demo site dataset.

Additionally the findOnPath() query now uses the pathHash instead
of the path.

* Commit: `8afcfb2 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/8afcfb2d07c182453d08f9b69e32dd5c0bf9136f>`_

[TASK] Remove unset NodeType properties from configuration
-----------------------------------------------------------------------------------------

Fixes: NEOS-973

* Commit: `5187ab0 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5187ab0fc03a59597a46266635ad66e1b493f305>`_

[BUGFIX] Allow configured childNodes to be moved
-----------------------------------------------------------------------------------------

ChildNodes should not be bound to constraints as they are explicitly
configured. Therefore moving a Node that is a childNode at the target
place should not be stopped by node constraints.

* Commit: `40c73b1 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/40c73b12d3b59c4c4a2b1dac940e1754fde741de>`_

[FEATURE] ChildNodes have defined positions
-----------------------------------------------------------------------------------------

This change introduces the possibility to set positions for auto created
child nodes to define the order they appear in the backend.

An example may look like::

  'TYPO3.Neos.NodeTypes:Page':
    childNodes:
      'header':
        position: 'before main'
        type: 'TYPO3.Neos:ContentCollection'

This would add a new ContentCollection ``header`` to the default page
that will be positioned before the ``main`` ContentCollection that the
default page has.

The ``position`` setting follows the logic of the sorting also used in
TypoScript implemented in If7487f8724462a5ff48375eda1085a2831becf5a.

Depends: I15957beca407163f7c166dc062ab84db087c3be0
Resolves: NEOS-922

* Commit: `6641b03 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/6641b03051d3b1617574843d19af6da265923785>`_

[BUGFIX] Functional tests work again after merging export fix
-----------------------------------------------------------------------------------------

The Functional test for the ExportService was not adapted to the
change that fixed the export of non string properties
I13b5a1a58beb70260b3ea3321a0d81e81a829ae3
This change fixes that.

Related: I13b5a1a58beb70260b3ea3321a0d81e81a829ae3

* Commit: `c7c891f <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c7c891f8560e2208331266ec4186818d0694a5a7>`_

[BUGFIX] Make SiblingsOperation usable on toplevel nodes
-----------------------------------------------------------------------------------------

The FlowQuery SiblingsOperation assumed that the nodes in the context
all return a parent node. If that is not true, a fatal error is caused
by the use of a method call on a non-object.

This change fixes that by checking for the parent node to exist before
trying to iterate over it's children.

* Commit: `5d3b6aa <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5d3b6aaeb8dfea12eb0c3cf2ac5f8f2be3fb78f2>`_

[BUGFIX] Export non-string node properties correctly again
-----------------------------------------------------------------------------------------

With recent changes the export of non-string node properties was broken
in certain cases. Most obvious: resources attached to nodes were no
longer exported with the XML.

This is caused by those objects being stored as their identifier, which
is just a string in the node data properties. Export assumed the actual
properties in there, whereas Node.getProperty() does a type conversion
internally. As a result the "image" would be exported as a "string",
no longer triggering the expected type converter.

This change fixes this by applying a type conversion during export that
takes the property type from the nodetype into account. If a nodetype is
not available, the properties are still exported, but always as string.

* Commit: `416844e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/416844e92ade9035bcf038dc41be9be22d8b4ed8>`_

[BUGFIX] Avoid use of undefined class constant
-----------------------------------------------------------------------------------------

The ImportExportPropertyMappingConfiguration referenced to a constant
from ObjectConverter using self, which is fixed with this change.

* Commit: `31364ec <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/31364eca83200989e6bcebb3cfd696e806d744ff>`_

[TASK] Adjust NodeTypes schema to allow unsetting properties
-----------------------------------------------------------------------------------------

Related: NEOS-973

* Commit: `470ee37 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/470ee3724ddce21c963d6dba9820ad5862d12351>`_

[BUGFIX] Case-sensitive answer in node:repair interaction
-----------------------------------------------------------------------------------------

Related: NEOS-329

* Commit: `92b5ad0 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/92b5ad0bfa5b721987ac22f1a460ec980d088926>`_

[BUGFIX] Exception for undefined node types in node repair
-----------------------------------------------------------------------------------------

If a node with an undefined or abstract node type is not removed
in the optional removeAbstractAndUndefinedNodes check. That node
will then cause an exception in the removeUndefinedProperties check
since it tries to use the node type. To prevent this we handled that
situation explicitly.

Related: NEOS-329

* Commit: `a7dae5e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/a7dae5e05b3826621c16b8222461f6e11057fac3>`_

[TASK] Reintroduce node migration application information
-----------------------------------------------------------------------------------------

This reintroduces the behaviour which was removed in
I535507ef7072affb0a806d45e54de8009deb5344: Showing
application information to every available node migration.

The reason why it didn't work anymore has been fixed
in Ifacef07200fdfd372c4b99e5fbd98b3b88a2dc3d.

Besides, this adds a word wrap to the comments column
to not exceed a particular line length and look messy
in most terminals.

* Commit: `fbd152c <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/fbd152cbd35271313eb709813a41ae5f4cf5145b>`_

[BUGFIX] Remove unpresent property from Repository
-----------------------------------------------------------------------------------------

This removes the not present property ``workspaceName``
from the MigrationStatusRepository to make it function
properly again.

Resolves: NEOS-967

* Commit: `4ab8f2a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/4ab8f2a3020523783a5bd34db9cbb19c24f0e700>`_

[BUGFIX] Use propertyMappingConfiguration for converting object properties
-----------------------------------------------------------------------------------------

To correctly configure object mapping, the PropertyMappingConfiguration
given to the NodeConverter should be forwarded to the propertyMapper.
That way an action can correctly configure the options used for
mapping objects inside of nodes.

* Commit: `8100e8b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/8100e8bc53d3049fac2c2438cf1b01ce8eafe3e1>`_

[FEATURE] Allow findByProperties() to be constrained to a path
-----------------------------------------------------------------------------------------

Currently findByProperties() always searches all available nodes. This
change allows to set a $pathStartingPoint so only nodes below the given
node will be searched.

Related: NEOS-250
Related: NEOS-140

* Commit: `9650614 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/9650614402ff3fdd2a0ceedb01ccc4ed161e6a84>`_

[BUGFIX] Correctly import node properties of type array
-----------------------------------------------------------------------------------------

If a set export contains nodes with array properties, the export cannot
be imported again. Thus arrays of strings, as produced by references
properties are rendered unusable.

The change adds a test for this case and fixes it by the way array elements
are parsed.

Fixes: NEOS-931

* Commit: `1731b60 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/1731b608947cab4e98a059ad50904d46988520e3>`_

[BUGFIX] RenameDimension transformation keeps existing dimensions
-----------------------------------------------------------------------------------------

The RenameDimension transformation was destructive for other existing
dimensions, so executing a migration with this transformation twice
would result in a broken state.

Fixes: NEOS-926

* Commit: `dc7a102 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/dc7a1027dc374ccfa36cab3f340996039231b19e>`_

[FEATURE] Additional cleanup in node:repair commando
-----------------------------------------------------------------------------------------

Adds additional cleanup to the node:repair command to ensure
node integrity according to the node type configuration.
The following cleanup operation are executed:

1. Removes nodes with abstract or undefined node types

2. Removes child nodes that aren't defined as auto
   created child nodes or don't fit constraints

3. Removes orphan nodes

4. Removes undefined properties

Resolves: NEOS-329

* Commit: `c565c29 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c565c297226b839e0e32d11184d7830da92383e2>`_

[FEATURE] Add default values for unset properties in node:repair
-----------------------------------------------------------------------------------------

Performs checks for unset properties that has default values and
sets them if necessary. This makes it easy to update existing nodes
when adding new properties without having to write a node migration,
since the operation is safe.

Resolves: NEOS-915

* Commit: `58e2326 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/58e23267be43593fced5f252357a513d3b784e00>`_

[TASK] Improve node retrieval in node:repair's child node creation
-----------------------------------------------------------------------------------------

Improves the retrival of nodes in createChildNodesByNodeType to exclude
shadow & removed nodes directly in the query as well as only fetching
nodes for the given workspace.

Related: NEOS-841

* Commit: `3ffe1f7 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/3ffe1f7457de755d00812389fc4585c68c70530f>`_

[FEATURE] Display node migration comments in node:migrationstatus
-----------------------------------------------------------------------------------------

This change includes the comments provided for migrations listed in
node:migrationstatus as a new column in order to make it easier to
identify the respective migrations.

The feature which should have displyed the migration status (ie. when
a specific migration has been applied) has been removed since the
underlying mechanism in MigrationStatusRepository doesn't seem to work.

This behavior needs to be fixed in a separate change.

* Commit: `2931835 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/2931835c712909f38a12d6668afb57f13e3f938d>`_

[!!!][BUGFIX] Node with identifier should only exist once per context
-----------------------------------------------------------------------------------------

On adopting nodes or in cases with undefined NodeData precedence
it could happen that for the same identifier two Node objects are
created for the same context. By just using the identifier and the
context object hash in NodeFactory that is prevented. Nodes that
are adopted into their own context directly get the new NodeData
object, thus the factory doesn't need to know about it.

This removes the $dimensions argument from NodeInterface::createNode().
It was dangerous to use anyway so you shouldn't rely on it.
Node::createNode() also sees  the argument removed so make sure you
remove all usages of it from your code.

Fixes: NEOS-354

* Commit: `04ec9df <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/04ec9df0ac1f290f56d0c5d8a2353073fd2a8c84>`_

[TASK] Adapt to DateTime property type change in Neos
-----------------------------------------------------------------------------------------

This change adapts the NodeConverter to the changes in
I49f719670b60fa91c041af574b4dbbeb8b399eca.

Related: NEOS-876

* Commit: `a503b4a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/a503b4affb157d209d020bf6e3ddc152fafd8279>`_

[BUGFIX] Correclty handle empty property elements in node import
-----------------------------------------------------------------------------------------

Resolves: NEOS-807

* Commit: `03106de <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/03106de8eea813af657a2e83bd664b4a00e81d6b>`_

[BUGFIX] Fix broken ``ContextFactoryTest`` & ``ContextTest``
-----------------------------------------------------------------------------------------

Fixes two broken tests, which break due to the unit tests not
automatically injecting lazy properties.

``ContextFactoryTest::createMergesDefaultPropertiesBeforeSettingAnInstanceByIdentifier``
``ContextTest::getCurrentDateTimeReturnsACurrentDateAndTime``

Related: NEOS-879

* Commit: `5da81f4 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5da81f4769aa6073abb7a9111a05d81310ac7413>`_

[BUGFIX] Now should not be instanciated
-----------------------------------------------------------------------------------------

Currently the ContextFactory creates new instances of
\\TYPO3\\Flow\\Utility\\Now which results in multiple context instances
despite having the same context properties.

This led to hard to debug errors that could happen randomly.
By injecting Now from the ObjectManager these problems are prevented.

Resolves: NEOS-879

* Commit: `6bf4e8d <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/6bf4e8dbc776b129cf98c058c11daf887ee94a50>`_

[TASK] Adjust behat tests to changes in Flow
-----------------------------------------------------------------------------------------

Adds a BehatTestHelper class, according to the
changes in I410b7c7e4eaddff5aeb4e9d600dbdc1a3748df91.

Related: FLOW-134

* Commit: `59b16e1 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/59b16e1ba746c5699252341cf905cf505ddeaf9e>`_

[TASK] Correct docs that FlowQuer has() operation is not recursive
-----------------------------------------------------------------------------------------

* Commit: `38f77db <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/38f77db272cb9776a2a99e3554caf1ce95a12e81>`_

[TASK] Add additional signals in Node for History feature
-----------------------------------------------------------------------------------------

This change adds a bunch of new signals to Node.

Related: NEOS-655

* Commit: `37b0dc2 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/37b0dc2f8359baf2c30fb803af5bf85268607c32>`_

[TASK] Minor comment changes to NodeData class
-----------------------------------------------------------------------------------------

* Commit: `d894cbd <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d894cbdde017935ed5f4e3d7c7be62dd463b323c>`_

[TASK] Include (internal) search over node properties
-----------------------------------------------------------------------------------------

Move the method for node fulltext search into a repository method for
proper workspace and dimension behavior. This method is internal API
and bound to change.

Related: NEOS-824

* Commit: `c871b19 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c871b1926b7e3757ebc40a4f623026b5d17ae002>`_

[BUGFIX] Add ``label`` property to NodeTypes schema
-----------------------------------------------------------------------------------------

This extends the ``NodeTypes.schema.yaml`` to cover the recently
introduced ``label`` property.
The updated schema also supports unsetting of existing labels
(by setting it NULL)

Fixes: NEOS-813
Fixes: NEOS-812

* Commit: `0b684da <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/0b684dae1985b8e90cc00b214c51c258bde333d8>`_

[TASK] Initialize some variables to silence IDE warnings
-----------------------------------------------------------------------------------------

Even though the variables in question are never undefined during runtime
initializing them does no harm and is good style.

* Commit: `3fce7d0 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/3fce7d045d40d644c9a8a6e4a46317f52e2a91d9>`_

[BUGFIX] Export/Import fixes
-----------------------------------------------------------------------------------------

The export should use the parent class name if a property
turns out to be a doctrine proxy.

The new Doctrine Collection to array converter is used.

Identities are set inside of TypeConverters setting them in
the Importer is removed.

Additionally removes all remaining occurances of
TYPO3.Media repositories as they are no longer needed in master.

* Commit: `6ba5709 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/6ba57090b2f3c589439313ee7d06492e38142309>`_

[BUGFIX] Site export is broken due to incorrect sorting
-----------------------------------------------------------------------------------------

Fix sorting order by making ``/`` always precede other
characters like ``-``.

If there are two similarilly named nodes like ``node``
and ``node-1`` they will be sorted by path as ``node``,
``node-1``, ``node-1/childnode``, ``node/childnode``
which would cause site export to produce a broken XML
(site export relies on correct sorting of nodes by path).

Doctrine doesn't support ``replace`` function, thus
the sorting is implemented in PHP by replacing ``/``
with ``!`` (the first visible character in ASCII).

Fixes: NEOS-829

* Commit: `77fc80c <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/77fc80cb6091642cd80665f54cb8327d94c99b38>`_

[BUGFIX] Make findByWorkspace() work on PostgreSQL
-----------------------------------------------------------------------------------------

The introduction of a check for "removed = 0" breaks on PostgreSQL
because there is no operator to compare integer to boolean directly.

Using a placeholder in the query and giving a type hint to Doctrine
this is fixed with this change.

Fixes: NEOS-823
Related: NEOS-770

* Commit: `9b6818f <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/9b6818fc7dd649c4fb404d477c3a69b499da2eb1>`_

[BUGFIX] When writing to dimensionValues use proper conversion to DB
-----------------------------------------------------------------------------------------

The dimensionValues field of NodeData is declared as object array, thus
when writing to it, the proper conversion needs to be done.

Related: FLOW-132

* Commit: `5749664 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5749664c64db3b1ece9144d9c3e9bfb43e89b606>`_

[TASK] Resolve supertype inheritance in NodeType
-----------------------------------------------------------------------------------------

The supertype inheritance is now done in the NodeType, not inside the
NodeTypeManager. This allows to unset supertypes, thus removing their
configuration from the final nodetype.

The Neos documentation (Integrator Guide) describes how to do that.

Related: NEOS-791

* Commit: `be1e22a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/be1e22aa5756b4a4d9f753dd5224e273dc6f20ba>`_

[TASK] Move super type inheritance resolving into NodeType class
-----------------------------------------------------------------------------------------

This is a commit just moving functionality around. This is the base for
the following commit and exists to ease the reviewing process.

Related: NEOS-791

* Commit: `62058f7 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/62058f7790d4a508433edfc4ca9148df4e3e8acb>`_

[TASK] Remove empty DocBook manual stub
-----------------------------------------------------------------------------------------

* Commit: `bfd919a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/bfd919ab6cba898e269a72c37cd1af2397afc3fe>`_

[BUGFIX] Discarding of changes should consider shadow nodes
-----------------------------------------------------------------------------------------

Shadow nodes need to be removed when removing a changed node from
a workspace.

Fixes: NEOS-797

* Commit: `f84c4a6 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/f84c4a61c874ad650915632ca9ac6255afbd888e>`_

[BUGFIX] Multiple moves of nodes break publishing/results in lost content
-----------------------------------------------------------------------------------------

Shadow nodes must only be created if no original shadow node exists
before. This solves moving the same node twice. In addition a
scenario where a node is moved to and from at the same path is covered
by storing the reference and sorting the nodes to be published by
their dependencies (topological sorting).

Fixes: NEOS-770

* Commit: `32044b9 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/32044b9440108ebf3e36846f45e138c7db7908bb>`_

[TASK] Disable testable security for AbstractNodeTest
-----------------------------------------------------------------------------------------

It's not needed by the test and causes delays with the new
entity privilege type.

* Commit: `bb09c3c <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/bb09c3ce495e16ff8bbe1b2047f8f9c6f0e05ac6>`_

[TASK] Adjust to new resource management
-----------------------------------------------------------------------------------------

Related: FLOW-108

* Commit: `c1fef80 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c1fef80a0f7fe5fe54fe3f8d5eab516f0784feaf>`_

[TASK] Remove leftover StepDefinitionsTrait
-----------------------------------------------------------------------------------------

This trait has been replaced by the new
NodeOperationsTrait, which has been introduced in
I39d53f10667002050d9ee58e4344fbfdc58f29ba.

Related: FLOW-102

* Commit: `95b1e51 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/95b1e5130f60efdba0e2936d2e69c6ac4f91db7c>`_

[BUGFIX] Allow importing/exporting DateTime properties
-----------------------------------------------------------------------------------------

Fixes: NEOS-727

* Commit: `095cbe9 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/095cbe9e3aab5e70f23fc012cb6cde49b8f87e8c>`_

[TASK] Adjust to Flow acl changes
-----------------------------------------------------------------------------------------

Related: FLOW-11

* Commit: `c1c234d <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c1c234dd5be237c5888ebbc7899a1b10405a3970>`_

[BUGFIX] Adjust code migration identifier pattern to contain the full timestamp
-----------------------------------------------------------------------------------------

Previously code migrations are expected to have a class name with the
pattern ``Version<YYYYMMDDhhmm>`` and the unique identifier was
determined extracting the last 12 characters of the class name (which
are expected to be the timestamp).

This change adjusts existing code migrations to return the old identifier
so that they won't be applied again.

Related: FLOW-110

* Commit: `fad5249 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/fad5249f100dbb8cdd2bd48d19816c71e0a371a9>`_

[TASK] Some code cleanup in NodeOperationsTrait
-----------------------------------------------------------------------------------------

* Commit: `1fb3125 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/1fb3125a2d1d96381b6e03b7f9f561eacc3389c3>`_

[TASK] Adjust behat feature context to Flow changes
-----------------------------------------------------------------------------------------

This adjusts the behat feature context to the changes
made in I7ba61a8e49d108b685394a70be8657550c4033aa.

Related: FLOW-102

* Commit: `2ca1c8b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/2ca1c8b69654b5f7eef7a05a8a98534a14bb2904>`_

[FEATURE] allow to copy content across dimensions, creating new variants
-----------------------------------------------------------------------------------------

When content is copied from one dimension to another one, a new node variant
should be created if the node variant does not yet exist in the target dimension(s).

When *Documents* are copied, we do not want to create any node variants, neither
for the document nodes themselves nor for their content nodes.

Note: On copying, we do not need to materialize the source node -- as the source
is not touched at all.

Resolves: NEOS-654

* Commit: `a6d6def <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/a6d6def4b9172d8fe98b45473f150d49fb5dbd77>`_

[TASK] Type cast integer properties to actual integers
-----------------------------------------------------------------------------------------

Related: NEOS-419

* Commit: `f2f1f30 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/f2f1f300514cb5bbe02fdff5d1e36f74e3a9fd2e>`_

[BUGFIX] Node type migration filter's ``withSubTypes`` option broken
-----------------------------------------------------------------------------------------

The node type node migration filter's ```withSubTypes`` option breaks
for unstructured nodes.

* Commit: `3196745 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/31967454951140c99bdd72d10a190ef507547945>`_

[FEATURE] Get node variants from a node or context by identifier
-----------------------------------------------------------------------------------------

Introduces two new public API methods to retrieve other node variants
of a node (with different dimension values) and to get all node variants
of an identifier from the context.

Resolves: NEOS-661

* Commit: `5931e7e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5931e7ea872179c999e5ba8d8638b13ce05d1b03>`_

[BUGFIX] Move partially translated subtrees consistently
-----------------------------------------------------------------------------------------

Change the strategy for moving nodes according to aggregate or
non-aggregate nodes. Subtrees of aggregate nodes are always moved
consistently by fetching all node variants with the original path
prefix.

Additionally cleanup the NodeInterface to remove recursive setPath
that is never called on Node. The path constraint in the
NodeDataRepository is updated to use the path hash to be consistent with
the parent path constraint.

Fixes: NEOS-660

* Commit: `53b4bc3 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/53b4bc371793aafa584780f7bb69d34eca747f21>`_

[TASK] Don't flush the complete routing cache for moved nodes
-----------------------------------------------------------------------------------------

With Ic131d828f491b8559d93647625298a5eccaeb131 only routing cache
entries for related nodes will be flushed.

Related: NEOS-296

* Commit: `f5a38bd <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/f5a38bd119a28cf76fe04e3d2dedfe0579ab6d93>`_

[BUGFIX] add aggregate property to NodeType schema
-----------------------------------------------------------------------------------------

This is a followup to I09223f24a80182596a99c9b4908773a990b9316a.

Related: NEOS-644

* Commit: `c1baaad <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c1baaad26866b62892e50b0d91b7879773cf5ef1>`_

[FEATURE] Independent paths for node variants of non-aggregate nodes
-----------------------------------------------------------------------------------------

A node with a non-aggregate node type (e.g. Content) should have the
possibility to have independent paths for each of its variants. This
allows to have content positions decoupled (e.g. in container elements).

The moving strategy of aggregate node types (e.g. Document) is not
touched by this.

Resolves: NEOS-648

* Commit: `c153a18 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c153a18c234de4e308364b46c74787b22bff9380>`_

[TASK] Add current node data to nodePathChanged signal
-----------------------------------------------------------------------------------------

This extends the signal ``nodePathChanged`` in the NodeData class that
is triggered whenever the path of a node is changed by adding the
changed node data instance as argument.

This is backwards compatible because exceeding arguments will be
ignored by the slot.

We currently need this to flush related routing caches only.

Related: NEOS-296

* Commit: `919ddd0 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/919ddd08e161bc406c2d0b43b35da6152b8a78de>`_

[TASK] Introduce signal for node property changes
-----------------------------------------------------------------------------------------

This adds a signal ``nodePropertyChanged`` to the Node class.
The signal is triggered whenever the property of a node is added
or changed.

We currently need this signal to flush related routing caches
whenever the "uriPathSegment" property of a node is modified.

Related: NEOS-296

* Commit: `fac5d38 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/fac5d384085b5563ffd490a77f30ad864ef77002>`_

[TASK] Add on cascade delete on NodeDimension NodeData property
-----------------------------------------------------------------------------------------

As a NodeDimension must have a NodeData relation, if we remove the
NodeData, we need to remove the NodeDimension. By using on cascade delete,
the database can handle this in a performant way.

Resolves: NEOS-531

* Commit: `4b01af3 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/4b01af3b2e9b951e1c22d2def70798d75c1cadd2>`_

[BUGFIX] adoptNode to context with different dimension and workspace
-----------------------------------------------------------------------------------------

Adopting a node to a different context that will also change the
workspace results in wrong dimension values that were persisted by
cloning the original NodeData. This change fixes the problem by creating
a new NodeData and using similarize. A Behat scenario reproduces the
problem.

Fixes: NEOS-651

* Commit: `38b2afb <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/38b2afb7a88d773163380ebf8b582c5ada35609e>`_

[TASK] Support recursive adoptNode in Context
-----------------------------------------------------------------------------------------

This change introduces a new paramter $recursive for the adoptNode
method in Context which adopts all non-aggregate descendant nodes to
the context recursively.

Resolves: NEOS-643

* Commit: `22e8622 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/22e8622e8a21d36c8961ddc197e82df2f67ce2e1>`_

[TASK] mark a Node Type as "aggregate"
-----------------------------------------------------------------------------------------

This change is the basis for further functionality changes when copying
nodes across dimensions.

Resolves: NEOS-644
Related: NEOS-633

* Commit: `336010f <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/336010fd25f4e8a2fba5818a900d89d6fa92d945>`_

[TASK] Make TYPO3CR independent of TYPO3.Media again
-----------------------------------------------------------------------------------------

This change removes a hard dependency of TYPO3.Media, to make TYPO3CR
usable again in projects that do not use TYPO3.Media.

* Commit: `7f66ec3 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/7f66ec32252fd6156b45ec37ecf3f407575455f5>`_

[!!!][TASK] Mark NodeInterface::getFullLabel deprecated
-----------------------------------------------------------------------------------------

Currently the NodeLabelGenerator has support for cropping and the method
NodeInterface::getFullLabel returns the label of the current node without
cropping. For consistancy and flexibility, the cropping should be done
in the view. Therefor Node::getLabel() will now return the full label
without cropping.

In this change, the method NodeInterface::getFullLabel is marked
deprecated since 1.2 but returns the same full label as before that is
now also returned by NodeInterface::getLabel.

This change is marked breaking because NodeInterface::getLabel now returns
labels of any length so you need to take care to shorten the labels
if needed and additionally because NodeInterface::getFullLabel is
considered deprecated and the NodeLabelGeneratorInterface no longer
mentions the $crop argument.

Resolves: NEOS-441

* Commit: `0894df2 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/0894df29dd18e28e94e9d6ac0c94018e407890a6>`_

[TASK] Move node related FlowQuery operations to TYPO3.TYPO3CR
-----------------------------------------------------------------------------------------

This adds all FlowQueryOperations from TYPO3.Neos in TYPO3.TYPO3CR
as they belong in the TYPO3CR package. For more information see
the change that removes the operations from TYPO3.Neos (available at
https://review.typo3.org/32746).

A code migration to automatically correct the updated namespace is
provided and can be applied with::

    ./flow core:migrate --package-key [PackageKey]

Resolves: NEOS-405

* Commit: `df3ca99 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/df3ca992cd0d34c86aa3a1371f08e5c5205586fe>`_

[TASK] Make isAccessible() in NodeData return TRUE without security context
-----------------------------------------------------------------------------------------

If the security context cannot be initialized, isAccessible() will return
TRUE unconditionally.

* Commit: `ed25766 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/ed25766fd3a568c186e1af338c29b651a395da05>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.TypoScript
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Add TypeHelper to default context
-----------------------------------------------------------------------------------------

Adds the new TypeHelper to the default TypoScript context.

Depends: If35e96c74dbf8c44485c829a4cebd3f12077f62d

* Commit: `ac60860 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/ac60860699b820efae3a370262b8c5737378fdad>`_

[TASK] Adjust dependencies for the 2.0 branch
-----------------------------------------------------------------------------------------

* Commit: `0395376 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/0395376e45142716f1caa807e9d411b07123169c>`_

[BUGFIX] Safeguard against non-existing context variables
-----------------------------------------------------------------------------------------

The correct handling of TS context for uncached segments (see change
http://review.typo3.org/38597) had the adverse side affect that in 1.2
rendering failed, because "account" was no longer defined. On master the
error does not become visible, since the account is no longer in the
context directly, but accessed via an Eel helper.

This change adds a safeguard against unset context variables and makes
them available with a value of NULL.

Fixes: NEOS-1217

* Commit: `84e3503 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/84e35037e3da26d9747bd6277047da210765a155>`_

[BUGFIX] Uncached segments should be able to override context
-----------------------------------------------------------------------------------------

This bug was only exposed after ``Iace3a6faf9752028ac219b7346a2546bdf0423cb``
got merged. Overrides need to happen after reducing the context to
only the cached variables, as otherwise you would be required to
name also all overriden variables in the cache configuration.

This change fixes the order and proves the correct behavior with
a functional test.

* Commit: `df030f1 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/df030f134285f16f16edadc5b046e7cc6475f569>`_

[BUGFIX] Uncached segment use configured context on first render
-----------------------------------------------------------------------------------------

Uncached segments need to define the rendering context they need, but
on first rendering they still had access to the full context which
made it harder to spot errors in the context configuration as they
only appeared on the second rendering.
Now the context is adjusted to the configuration even for the first
rendering.

Fixes: NEOS-1127

* Commit: `7975892 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/797589213561c71d6c320ac0d54329bce0c268fa>`_

[BUGFIX] Fix parse errors with TypoScript comments
-----------------------------------------------------------------------------------------

This commit fixes problems with parsing "comments in comments" in TypoScript

Example::

    # */ text meant as comment

Adds a unit test and a fixture that reproduces the parsing error.
Adds a unit test for the split pattern used to identify the "type of comment".
Refactors unit test for the TypoScript parser.

Resolves: NEOS-864

* Commit: `a0bf052 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/a0bf052ecb988a19c73ce777c6377ff371b126ba>`_

[BUGFIX] Fix error in TypoScript exception
-----------------------------------------------------------------------------------------

$configuration['__objectType'] might not be initialized when we composer the error message.

Resolves: NEOS-1102

* Commit: `8f245aa <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/8f245aa460c59958ca248c0209a7d5a8dc1908f3>`_

[TASK] Make exception messages more meaningful
-----------------------------------------------------------------------------------------

This change should give integrators some help when
they make common mistakes in TypoScript.

Resolves: NEOS-502
Resolves: NEOS-1102

* Commit: `4d6f841 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/4d6f8412cd80afe19a2eedb3659ddab5430140d4>`_

[FEATURE] Improve TypoScript Exception Message Rendering
-----------------------------------------------------------------------------------------

Changed rendering of error messages in Html Message Handler to improve
usability for the integrator.

We now show a detailed error message with a nice styling when an error
occurs during TypoScript rendering.

Resolves: NEOS-1106

* Commit: `c17b9f4 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/c17b9f4944d4485248ef8acf3d429d5d38f2b43f>`_

[TASK] Add configuration for Flow's Translate EelHelper
-----------------------------------------------------------------------------------------

This adds the respective configuration for the Translate
EelHelper introduced with
I88e753f25e7087e3e4cd2efa193ce89fa3aa8232.

Depends: I88e753f25e7087e3e4cd2efa193ce89fa3aa8232

* Commit: `064d2a5 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/064d2a549627222398356eeae33ca07a04f98ea7>`_

[BUGFIX] Exception causes fatal error in TypoScriptPathProxy __toString
-----------------------------------------------------------------------------------------

If an exception occurs during handling of a rendering exception a fatal
error is thrown due to __toString methods not being allowed to throw
exceptions. To prevent that we catch those exceptions and try to render
them with a context depenent exception handler instead. If that also
fails we fall back to a custom handling of the exception.

Fixes: NEOS-898

* Commit: `b31bf5e <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/b31bf5e1ac9783d9d2519c0b25b9aa7ee9bf1c79>`_

[TASK] Mark recent core migrations applied
-----------------------------------------------------------------------------------------

This commit doesn't contain any changes, it simply marks recent
migrations applied so that::

  ./flow flow:core:migrate --status

won't show any open migrations for this package.

* Commit: `5c883ec <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/5c883ecb1eb5e8aa375cc6e30848b6d1dd5012f9>`_

[FEATURE] Allow multi-line Eel expressions in TypoScript
-----------------------------------------------------------------------------------------

Resolves: NEOS-60

* Commit: `cad40ec <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/cad40ec6eff7f31ef603b0291a968dc1a630e178>`_

[TASK] Support NULL as simple type
-----------------------------------------------------------------------------------------

With this change NULL can be used in TypoScript::

  simpleTypes.null = Value {
    value = NULL
  }

* Commit: `174c7c6 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/174c7c616adcc2f3044a176ce638d082cfbba900>`_

[!!!][TASK] Throw exception for missing implementation class
-----------------------------------------------------------------------------------------

To help debugging broken TypoScript an exception should be thrown when
a object doesn't have a implementation class meta property (@class).

This can be breaking if relying on missing implementation classes
being silenced and returning NULL.

* Commit: `eea1c5c <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/eea1c5cf83acf75121e9148d62de7ef5c0c39fed>`_

[BUGFIX] Runtime needs to reset context if it was overriden
-----------------------------------------------------------------------------------------

Context overrides were just popped off the stack at the end of
the ``evaluateInteral`` method, but need to be removed always
before returning if override happened.

* Commit: `41e4d17 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/41e4d179feb1a0c910e8ba2c219142874d2cd380>`_

[BUGFIX] Fix merging of nested prototype property overrides
-----------------------------------------------------------------------------------------

This fixes the merging of processors with simple types
configured in the prototypes. Without this fix you can have
unpredictable behavior if you overwrite properties of nested
TypoScript objects.

Also fixes processors applied to values that where not set before.

Resolves: NEOS-1004

* Commit: `b611c3f <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/b611c3fdbe9a859792ab3e5fe6ff3893b0361c34>`_

[TASK] Add new SecurityHelper to global context
-----------------------------------------------------------------------------------------

The new SecurityHelper from the EEL package is made available
as ``Security`` in EEL expressions.

Related: NEOS-1012

* Commit: `07df64b <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/07df64b00c4377f9931a3caa8e2239d60ef74adb>`_

[BUGFIX] Adjust cache identifiers after security context hash addition
-----------------------------------------------------------------------------------------

As the security context hash is now added to cache identifiers the
compared identifiers in the functional test needs to be adapted.

* Commit: `565da95 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/565da9530a73fa83b9bbd36259a3c2e287a2344e>`_

[BUGFIX] Add missing mock securityContext to failing tests
-----------------------------------------------------------------------------------------

The content cache unit tests fail since the security context hash is
used in the cache identifier. This change adds a mock security context
to the content cache tests.

Resolves: NEOS-1006

* Commit: `67b0386 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/67b03864c4663a6abbaf3d5568780858f5217c5f>`_

[TASK] Respect "SecurityContextHash" in ContentCache
-----------------------------------------------------------------------------------------

Suffixes every content cache entry with the current
``SecurityContextHash`` in order to make sure that content is cached
depending on the currently authenticated roles.

Related: NEOS-433

* Commit: `d5fcb52 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/d5fcb52d79834f189995046d283862ebc29f321a>`_

[TASK] Allow ignoreProperties on all Array implementations
-----------------------------------------------------------------------------------------

The CaseImplementation allows for the special meta property
``@ignoreProperties`` to define keys that are not used in evaluation.
This functionality can be useful for other types of implementations
that iterate over the properties.
The functionality was extracted and to make sure it works on all
implementations of
``\\TYPO3\\TypoScript\\TypoScriptObjects\\AbstractArrayTypoScriptObject``
They have a new property "ignoreProperties" now that can be used in
own implementations.
Using "sortNestedTypoScriptKeys()" of the ArrayImplementation will
ignore those properties already.

* Commit: `3dbffe3 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/3dbffe3ce3a6b053ed6dbe8cfa5333b73cd947e8>`_

[TASK] Adjust to "Fluid: Consistent escaping behavior"
-----------------------------------------------------------------------------------------

Adds "escapeOutput" property to existing ViewHelpers to ensure
backwards-compatibility.

Depends: I1e4cd0942dcf7b0726f3d3892bf8713cba89e9a4

* Commit: `3eb86b4 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/3eb86b46e7d262ca2ce25a7438c70f632909dc0f>`_

[BUGFIX] Matcher with "renderer" should evaluate in own context
-----------------------------------------------------------------------------------------

A TypoScript (Case) Matcher configured with renderer should be
evaluated with itself as context object, so that the following
configuration works as expected::

  hasLayout {
    layout = ${q(node).property('layout')}
    condition = ${this.layout ? true : false}
    renderer = ${this.layout}
  }

Without this bugfix the ``renderer`` would fail as ``this``
was not set.

* Commit: `b442fcf <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/b442fcfacef4cdb12b273fb663d9a717a2a3befc>`_

[TASK] Use TypoScript object for cacheIdentifiers
-----------------------------------------------------------------------------------------

With this change the ``@cache.entryIdentifier`` is rendered as a
TypoScript object. If none is configured (as is with all current
cache configurations) it is assumed to be of the newly introduced
type ``TYPO3.TypoScript:GlobalCacheIdentifiers``.
This new prototype includes the ``baseUri`` and ``format`` keys
by default but can be extended as any other prototype.
This ensures that cached links always match the request format
and baseUri of the current rendering.

The baseUri includes the domain, http protocol and port.

Resolves: NEOS-852

* Commit: `ee6ec66 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/ee6ec66b05f1ac735832771f47701c958eb80fc4>`_

[BUGFIX] Don't catch SecurityExceptions
-----------------------------------------------------------------------------------------

This adjusts the method
``AbstractRenderingExceptionHandler::handleRenderingException()`` to
always rethrow exceptions of type ``TYPO3\\Flow\\Security\\Exception``.

Background:

If a security related exception is thrown, it must always bubble up.
Otherwise redirection to login forms won't work when an
``AuthenticationRequiredException`` is thrown in a sub request.

Related: FLOW-130

* Commit: `0da0781 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/0da07818bca2737641bb82962be6ab1a7d50626f>`_

[TASK] Adapt to EelUtility in TYPO3.EEL package
-----------------------------------------------------------------------------------------

Remove some duplicate code that is now available in the
TYPO3.EEL package centrally.

Also removes the context variable ``context`` that was
deprecated in sprint release 10 and should have been
removed some time ago already.

* Commit: `3dfe965 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/3dfe965701ec677c4b9228b5a3fe74403186d088>`_

[FEATURE] Allow quoting of TypoScript declarations
-----------------------------------------------------------------------------------------

TypoScript declarations (currently "namespace" and "include")
now allow quoting of the given values, so the example::

  include: NodeTypes/*

can now be rewritten as::

  include: "NodeTypes/*"

or::

  include: 'NodeTypes/*'

This prevents wrong detection of opening comments in IDEs.

Resolves: NEOS-831

* Commit: `b3af77a <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/b3af77adc4e8040c3aa59e5aa90e1ebe5d9ca898>`_

[BUGFIX] Support access to properties with "this" in @if expressions
-----------------------------------------------------------------------------------------

This is a missing case that was not tested and can easily be fixed.

Fixes: NEOS-835

* Commit: `a137c5f <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/a137c5fdea6383da988ec589386e87fd9cb87f3b>`_

[TASK] Adjust to new resource management
-----------------------------------------------------------------------------------------

Related: FLOW-108

* Commit: `70214cf <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/70214cf4493d63cf1d578f59d1633c81b3ab11f7>`_

[TASK] Remove leading backslash on use statement
-----------------------------------------------------------------------------------------

* Commit: `0e3b239 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/0e3b2399c3ac730d143174c52b56a71dadd4a6ea>`_

[TASK] Mark migration as merged
-----------------------------------------------------------------------------------------

This commit marks some migrations as merged that are not needed on this
package. This speeds up core:migrate and avoids potential errors.

* Commit: `ca9da06 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/ca9da06c49de2b41db262559d93ce65ce0435211>`_

[BUGFIX] Adjust code migration identifier pattern to contain the full timestamp
-----------------------------------------------------------------------------------------

Previously code migrations are expected to have a class name with the
pattern ``Version<YYYYMMDDhhmm>`` and the unique identifier was
determined extracting the last 12 characters of the class name (which
are expected to be the timestamp).

This change adjusts existing code migrations to return the old identifier
so that they won't be applied again.

Related: FLOW-110

* Commit: `1961e2a <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/1961e2aaf9057eaa5c3f6029e34ea9c5a9ada798>`_

[TASK] Wrap HTML message exception handler title
-----------------------------------------------------------------------------------------

Related: NEOS-344

* Commit: `cafe497 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/cafe497e56fe6a9c8da08ca8b89b1fb245678b62>`_

[FEATURE] TypoScript prototype to handle HTTP headers and response status
-----------------------------------------------------------------------------------------

This change add a new TypoScript prototype that can be used to generate
a standard HTTP head response::

    prototype(TYPO3.TypoScript:Http.ResponseHead) {
    	statusCode = 200
    	headers {
    		Content-Type = "application/json"
    	}
    }

This change also introduces another prototype ``TYPO3.TypoScript:Http.Message``
which extends ``TYPO3.TypoScript:Array`` and makes it easier to work with
HTTP messages. It is mostly a base prototype to render documents
that support setting HTTP header data.

Resolves: NEOS-449

* Commit: `aa82511 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/aa8251127f3fab9070885f1b8812281b034122c8>`_

[FEATURE] Implement TypoScript inclusion globbing
-----------------------------------------------------------------------------------------

The "include: " statement of TypoScript now allows normal and recursive
file globbing.

* ``*``  includes all of the ts2 files on that level
* ``**/*``  includes all of the ts2 files recursively starting with that
  level.

This works with relative and ``resource://`` links. Recursion is avoided
by not allowing to include the same .ts2 file as the one from which it
was called.

Example ``Root.ts2``::

  # Include all .ts2 files in NodeTypes and it's subfolders recursively
  include: NodeTypes/**/*

Resolves: NEOS-440

* Commit: `a7acc44 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/a7acc44bfc610b7f105bc995ec06fad513361e56>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.Media
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Adjust required versions in composer manifest
-----------------------------------------------------------------------------------------

This adjusts the Flow dependency to require ~3.0 and Imagine to ~2.0.
The requirement on PHP is removed (checked by Flow anyway).

Related: NEOS-1243

* Commit: `067a8f5 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/067a8f5124af225b48cab753b6d34bfc0648f8ae>`_

[BUGFIX] Outbound ratio is broken
-----------------------------------------------------------------------------------------

This change fix the outbound rendering. Before this change outbound work
like inbound rendering if the maximumWidth and the maximumHeight was
set. The regression was introduced by the new resource management.

* Commit: `d9f690b <https://git.typo3.org/Packages/TYPO3.Media.git/commit/d9f690b311c39971457c4c9be10727e4a2ec40ce>`_

[TASK] Remove slash escaping option from ImageInterfaceJsonSerializer
-----------------------------------------------------------------------------------------

This option was a workaround and the underlying bug is fixed with
NEOS-1245, so the workaround can be removed.

Related: NEOS-1245

* Commit: `8fe0e68 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/8fe0e68286891058b7eb6d0487c86be55bb82a05>`_

[TASK] CGL Cleanup
-----------------------------------------------------------------------------------------

This change is purely cosmetic and fixes CGL issues.

* Commit: `4c52090 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/4c5209049b450226e12899cb48a5cc5cd1131ae2>`_

[FEATURE] Asset collections for grouping assets/tags
-----------------------------------------------------------------------------------------

Introduces asset collections that can be used to group assets
and limit the tags available within a collection. This is useful
when having a lot of assets and the tags aren't enough to keep
things organized. Assets and tags can belong to multiple collections.
A new privilege for managing collections is introduced and given to
administrators. If no collections exists everything works like before
and only those with the privilege to create new collections see any
difference in form of a creation form.

Depends: Ic3c15ebe8beaf7a70a1fb0ff6aab0699a80d5ff1

Resolves: NEOS-251
Related: NEOS-1256

* Commit: `5c314db <https://git.typo3.org/Packages/TYPO3.Media.git/commit/5c314db379ad1ee2b5b1ef3ca07012258358d46f>`_

[TASK] Updated untagged count when tagging assets
-----------------------------------------------------------------------------------------

If an untagged asset is added to a tag the untagged counter
is updated accordingly.

Resolves: NEOS-1065

* Commit: `47a3dc0 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/47a3dc0081bd44b658cff1cd45c94197436fb9f5>`_

[TASK] Improve usability and allow clicking drop zone to upload
-----------------------------------------------------------------------------------------

- Enables clicking the dropzone to select files
- Removes unreliable hiding of drop zone
- Adds active/hover classes for styling to the drop zone
- Remove CSS stub

Resolves: NEOS-1077

* Commit: `395a965 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/395a96521abc2a297a18656dd917627bc8636c64>`_

[FEATURE] Confirmation dialog for deletion of assets
-----------------------------------------------------------------------------------------

Adds a confirmation dialog when deleting assets to prevent
deletion of wrong assets by mistake.

Additionally makes it possible to delete assets directly from
the thumbnail view like it is in the list view.

Resolves: NEOS-1025
Resolves: NEOS-1066

* Commit: `9d4f601 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/9d4f6016db6e2f2ef0ad6120b372e9a820d1b4d3>`_

[BUGFIX] AssetConverter should not automatically reuse assets
-----------------------------------------------------------------------------------------

The `AssetInterfaceConverter` checked if an uploaded `Resource` was
already available as `Asset` and would reuse the asset in this case.
This is not expected for developers using Assets as you would expect
that a new upload also creates a new object. This is fixed by adding
a new TypeConverter option to enable this special handling which is
needed for the Media browser itself for example. The default case
is now that uploaded `Resource` objects always result in new `Asset`
objects.

Fixes: FLOW-288

(cherry picked from commit edc8f1cdda1a2e1dc9976ea3dbf1bd77af4f7fb7)

* Commit: `33901c7 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/33901c759d9bf5214b627cae125aeade11c90f80>`_

[BUGFIX] Video object is not initialised correctly
-----------------------------------------------------------------------------------------

Remove "initialize" method and replaced it by "__construct" in order to
set the default values for width and height.

This fixes a missing initialisation of video objects. The "initialize"
function is never called and therefor width and height are not set. With 
no width and height set, validation of the object will fail, which prevents 
upload and import.

* Commit: `337b8fc <https://git.typo3.org/Packages/TYPO3.Media.git/commit/337b8fcaf3739eeb0c0dcd39c599370e6966446d>`_

[TASK] Prevent uploading of files exceeding maximum file size
-----------------------------------------------------------------------------------------

Adds JavaScript checks for the file size comparing with the maximum
allowed file size to be uploaded server side and display an error
if exceeded. Additionally improves the styling of the error
notifications by using the standard notifications in Neos if available.

Depends: I53e1d2f7c8ea421cede85b676aa1989cc8610aaf

Resolves: NEOS-1082

* Commit: `7131ac3 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/7131ac3768d6a55a3ae3c612ec7c1914736cd6a4>`_

[TASK] Check if the edit action is loaded in an iframe
-----------------------------------------------------------------------------------------

This change add a check in the Media browser edit action to execute JS
code only if the Media browser is loaded in an Secondary Inspector.

Related: NEOS-1084

* Commit: `9951644 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/9951644de99cc9fda08a4626b417294727227258>`_

[TASK] Create ImageVariant resource lazily
-----------------------------------------------------------------------------------------

Resources of ImageVariants are now created when needed and not
when the ImageVariant is created or refreshed.

This speeds up the site import as previously it would refresh
ImageVariants for each adjustment and generate all intermediate
resources.

Resolves: NEOS-1170

* Commit: `2544ecd <https://git.typo3.org/Packages/TYPO3.Media.git/commit/2544ecde63ee9e8d6d38c6bc3f65816dda8e71b5>`_

[TASK] Automatically select active tag in the new action
-----------------------------------------------------------------------------------------

When using the upload action the active tag is automatically selected
like it's done when uploading with drag & drop in the list views.

Resolves: NEOS-1073

* Commit: `87bb0d5 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/87bb0d5b93addaa8817bfd3c3a926f622e409d5c>`_

[TASK] Styled title tooltips for various buttons
-----------------------------------------------------------------------------------------

Adds styled tooltips instead of default browser ones for various
buttons for their title attribute.

Resolves: NEOS-1028

* Commit: `e32ce90 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/e32ce90e0c5732ebe50ec89a1c2786e5ba20780c>`_

[BUGFIX] Fix spelling error in error message
-----------------------------------------------------------------------------------------

Fixes: FLOW-112

* Commit: `af767b9 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/af767b9ec4fcd4972e512e6948532ab6e9413e71>`_

[TASK] Make image preview in detail view clickable
-----------------------------------------------------------------------------------------

For viewing the original file the image preview in the
detail view is made clickable since it's a natural
place to try to click.

Resolves: NEOS-1069

* Commit: `1a9b136 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/1a9b1363e2f8de44a44aa0947885039ea3f36786>`_

[TASK] Reintroduce "image" argument to ImageViewHelpers
-----------------------------------------------------------------------------------------

With the new Media Management
(Ieaaf6fa166d13c7cd0177ec381b4e74e2923c2ce) the deprecated "image"
argument has been removed from the ``image`` and ``uri.image``
ViewHelpers in favor of a new argument "asset".

This change reintroduces the "image" argument and deprecates the
"asset" argument.

Background:
The argument was called "image" originally, but it was renamed to
"asset" with I8769987d34ac54a3d36e6d3374040438edf30612.

Related: FLOW-108

* Commit: `6667321 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/6667321e46098f1c11bf5efcac24ee2260c31d7d>`_

[TASK] Optimize lists for lots of tags
-----------------------------------------------------------------------------------------

Use different layout when lots of tags are available.

Resolves: NEOS-641

* Commit: `fa3d9a7 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/fa3d9a7b15861cca35ede48a238167d1bc5dd2d8>`_

[TASK] Improve handling of tags
-----------------------------------------------------------------------------------------

- Support editing of tag labels
- Hides tag creation from until tag editing is enabled
- Show a confirmation prompt when deleting a tag

Resolves: NEOS-1074
Resolves: NEOS-1072
Resolves: NEOS-1070

* Commit: `54d403e <https://git.typo3.org/Packages/TYPO3.Media.git/commit/54d403ea9867a0dd4e630ce51b2dee758f59a36a>`_

[TASK] Show asset title in ThumbnailView
-----------------------------------------------------------------------------------------

This change also use asset.label in all Fluid templates.

* Commit: `a4b5311 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/a4b531159732d985c34c7c5d110b82dc54560b65>`_

[TASK] Change ViewHelper examples namespace from 'm:' to 'typo3.media:'
-----------------------------------------------------------------------------------------

This is done to use the new convention introduced with the automatic
namespace registering in ``I965cb54c3125f80e7a5ae46ede72ee9027ed006e``.

Related: NEOS-916

* Commit: `cf78396 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/cf78396c97a2986446e4308d893829c1752a2c0b>`_

[BUGFIX] Fix asset uploads in media browser
-----------------------------------------------------------------------------------------

This partly reverts commit ea3f824d4075c7a60e13902562c71dbb91020b19
which was merged as a quick fix. Now that the TypeConverters no longer
automatically persist media changes we need to do that in the controller
again.

Related: I1a4495a2d5ca19eec4cfb56a798871e8e9ca4fa5

* Commit: `8e0179a <https://git.typo3.org/Packages/TYPO3.Media.git/commit/8e0179aab00a95e915b9b7676e0cd781a966b211>`_

[TASK] Skip passing unnecessary arguments around
-----------------------------------------------------------------------------------------

It's not necessary to pass the view argument when switching to
"All" or "Untagged" since that information is stored in the
session.

Resolves: NEOS-1071

* Commit: `1a30a72 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/1a30a720f3ed6f0416610c463616a3a514c6e22f>`_

[TASK] Remove automatic persistence of assets in converter
-----------------------------------------------------------------------------------------

The AssetInterfaceConverter automatically persisted assets since
the resource changes as that was needed for TYPO3CR. With
I7b3404593daa0b83c0d1a5a678b4250d3bd639e9 this is no longer needed
and as it is not a good architectural decision this change removes
it again.

Related: I7b3404593daa0b83c0d1a5a678b4250d3bd639e9

* Commit: `d31c312 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/d31c312b94c9603b556fdfbd143584fcbf04a719>`_

[TASK] Add check for if tag label already exists
-----------------------------------------------------------------------------------------

Currently there is no check if a tag already exists, which can
result in multiple tags with the same label in the Media module.

* Commit: `3b7e81b <https://git.typo3.org/Packages/TYPO3.Media.git/commit/3b7e81b9ce27b03671ea4b3d40f6805727943b18>`_

[TASK] Bring ImageAdjustments in defined order
-----------------------------------------------------------------------------------------

ImageAdjustments need to be executed in order. Without this change
the order is chosen based on alphabetical order of adjustment
class name. With this change all adjustments have a position property
which defaults so that the correct order is guaranteed but allows for
manual sorting later on if that is needed.

* Commit: `cc43b9a <https://git.typo3.org/Packages/TYPO3.Media.git/commit/cc43b9a07afddc603bc865979bd9eb946da2c012>`_

[BUGFIX] Incorrect HTML output for search field
-----------------------------------------------------------------------------------------

For styling purposes the HTML structure of the search field
needs to be adjusted a little.

Related: NEOS-83

* Commit: `381f30c <https://git.typo3.org/Packages/TYPO3.Media.git/commit/381f30c28f977fad347eaed32e6a3b50d189f182>`_

[TASK] Improve tagging user experience in lists
-----------------------------------------------------------------------------------------

- Increment tag counter if asset was successfully added to tag
- Display indication when creating new tag
- Move cursor drag helper to be more intuitive
- Only revert dragged asset if drag not successful
- Ensure space between tags when adding more than one
- Display move-icon in list view

Related: NEOS-1018
Related: NEOS-336
Related: NEOS-454

* Commit: `f377c9d <https://git.typo3.org/Packages/TYPO3.Media.git/commit/f377c9d3c9bed9197fcebf9be37fab7c694a9c3c>`_

[FEATURE] Search field in sidebar for lists
-----------------------------------------------------------------------------------------

Adds a search filed in the sidebar of the lists to filter the assets
based on their filename, title, description or tags.

Resolves: NEOS-832

* Commit: `6189f20 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/6189f208019d3a1a8bff801a6abb3da456ed8810>`_

[FEATURE] Display file size and last modified information in list view
-----------------------------------------------------------------------------------------

Adds two new columns in the list view with file size and last modified
information. The last modified date is shown relative to the current
date, for easier distinguishment.

Additionally makes it possible to change the sorting by clicking the
name or the last modified table header.

Resolves: NEOS-1022

* Commit: `6eb9e55 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/6eb9e5550296c7f9d734106ab88409dd92a5ad4e>`_

[FEATURE] Sorting/filtering options in lists
-----------------------------------------------------------------------------------------

- Sort by last modified or filename
- Changed default sorting to last modified
- Filter by asset type (images, documents, video, audio)

Resolves: NEOS-1023

* Commit: `930d8a5 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/930d8a5115deb50eb7d9cb6ba918a50e3ecb3cc8>`_

[BUGFIX] Use original file if no adjustments necessary
-----------------------------------------------------------------------------------------

If none of the adjustments of an ImageVariant would change the
original resource it can be reused instead of letting Imagine
create a new file (with possibly worse compression).

Additionally reenables the ImageSizeCache which never was written.

Resolves: NEOS-969

* Commit: `35f731a <https://git.typo3.org/Packages/TYPO3.Media.git/commit/35f731a285b10584d4dac9f3814306641854b903>`_

[TASK] Improve flash messages in media browser/module
-----------------------------------------------------------------------------------------

Add the assets label to the flash messages to be more explicit

Resolves: NEOS-1024

* Commit: `16754df <https://git.typo3.org/Packages/TYPO3.Media.git/commit/16754df901d592dd5e13e1319158c27c56c69ccb>`_

[TASK] Preview of image thumbnails in list view
-----------------------------------------------------------------------------------------

Related: NEOS-1021

* Commit: `124ce9f <https://git.typo3.org/Packages/TYPO3.Media.git/commit/124ce9f222bf0cc17a970c7edf145c2574a54807>`_

[TASK] Show file name of selected file in new action
-----------------------------------------------------------------------------------------

Related: NEOS-877

* Commit: `cf577a7 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/cf577a7c292111a295b17c968bf524535bc283cd>`_

[BUGFIX] Replace Resource::getUri by getSha1 in Image
-----------------------------------------------------------------------------------------

The method getUri has been removed in the new resource management.

* Commit: `a429779 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/a429779cd2d1710a673daaad99448e2ae4a17501>`_

[TASK] Display upload progress in lists
-----------------------------------------------------------------------------------------

Related: NEOS-877

* Commit: `35a2145 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/35a21452c990aedec0e7a83c34835dfc84100af8>`_

[TASK] Mark recent core migrations applied
-----------------------------------------------------------------------------------------

This commit doesn't contain any changes, it simply marks recent
migrations applied so that::

  ./flow flow:core:migrate --status

won't show any open migrations for this package.

* Commit: `3c8acc0 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/3c8acc093c98d47dfd6311a166cb1f2dcd071312>`_

[BUGFIX] ImageVariant has getCaption
-----------------------------------------------------------------------------------------

The ImageVariant has a getTitle() method that returns the title
of the originalAsset, similarly the caption should be gettable
via getCaption() so users of the entities do not need to differ
between Image and ImageVariant in regard to title and caption.

* Commit: `cce019d <https://git.typo3.org/Packages/TYPO3.Media.git/commit/cce019d9b6ba7fd09b40070f7c77780079c6897c>`_

[BUGFIX] Class names should be resolved by TypeHandling
-----------------------------------------------------------------------------------------

As the ImageInterface could be a doctrine proxy we should not
rely on get_class but instead use TypeHandling to determine
the real class name for the given Asset.

* Commit: `4df8cc2 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/4df8cc215d28e045469bc35bf03a85c5fd9fba67>`_

[TASK] Remove unclosed li element in tags list
-----------------------------------------------------------------------------------------

* Commit: `0b9a7a7 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/0b9a7a703903af3a572ef3642f39e353b117c5ad>`_

[BUGFIX] Add missing inversedBy annotation attribute
-----------------------------------------------------------------------------------------

The Thumbnail class lacked an inverseBy attribute in the
ManyToOne annotation. That resulted in a bunch of errors for
the mapping validation of doctrine.

Resolves: NEOS-1001

* Commit: `ecc7cdd <https://git.typo3.org/Packages/TYPO3.Media.git/commit/ecc7cdd3c7f0db6cfbb7c7b0699f08f0f94588f9>`_

[BUGFIX] Fix asset uploads in media browser
-----------------------------------------------------------------------------------------

This finally adjusts uploads of assets to the new media management
and property mappers.

Depends: I33cfe41fc9493af0907625bb88b2f9c3fac968e9
Resolves: NEOS-833

* Commit: `ea3f824 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/ea3f824d4075c7a60e13902562c71dbb91020b19>`_

[BUGFIX] Broken configuration injection due to wrong argument
-----------------------------------------------------------------------------------------

The argument for the InjectConfiguration annotation is path not
setting.

* Commit: `cc6da5e <https://git.typo3.org/Packages/TYPO3.Media.git/commit/cc6da5e25a3eed1d712f472420da6745bfb04b6d>`_

[FEATURE] Asset mapping strategies
-----------------------------------------------------------------------------------------

Usually you have a resource that needs to be mapped to a media
domain model. This mapping shouldn't be hardcoded but rather
determined by the resource. TYPO3.Neos implemented its own
TypeConverter to do that. By adding a swappable strategy to
the media package this mapping can be configured and changed
as needed. By default we deliver a simple configuration based
strategy that determines a model by configured expressions that
are tested against the media type of the resource (which again is
extracted from the file extension).
The expressions can be ordered to give precedence by using a key
``position`` on the same level as the ``className``.

Resolves: NEOS-936

* Commit: `97cab27 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/97cab27b72c1f38904ca22696ccce35a35c8b692>`_

[!!!][TASK] Add charset and collation to all MySQL migrations
-----------------------------------------------------------------------------------------

This change set adds charset and collation to create table statements
in the existing migrations. This make sure the tables are set up
correctly independent of the database default configuration.

Also migrations generated contain this information since a while,
leading to problems on migration if the database is not using the same
charset and collation.

This is breaking if you have existing tables that do not use the utf8
charset and utf8_unicode_ci collation. To solve this you need to convert
the existing tables. This can be done using the command::

  ./flow database:setcharset

Related: NEOS-800

* Commit: `846fc7c <https://git.typo3.org/Packages/TYPO3.Media.git/commit/846fc7c98958ab050a6e744266fc8d089a85e115>`_

[BUGFIX] Down migration for PostgreSQL lacks type cast
-----------------------------------------------------------------------------------------

The down migration for Version20141118174901 lacks a type cast
and fails because of that. This change adds the type cast so the
migration runs smooth again.

This migration was introduced in I7c5a613abb8cc2417998e39b21c128f8ab775054
which is a fix change for the PostgreSQL migration which was
not updated before the new resource management was merged.
We don't have to care about moving or altering data in this migration
as migrating just one version up will not make sense as this
will be a broken state. Going one step further will drop the table
so we can safely do a simple cast to get the up and down migration
working.

* Commit: `ea8ff6a <https://git.typo3.org/Packages/TYPO3.Media.git/commit/ea8ff6a4d4c2374b5d8a0271172d0bfd78e4ba05>`_

[TASK] Add missing PostgreSQL migration
-----------------------------------------------------------------------------------------

For change Ia1ae5768fe84072f9b3c54fe5919d1e1af5647f6 the PostgreSQL
schema needs an additional migration. This change adds that migration.

Related: NEOS-978

* Commit: `494eae6 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/494eae65f08cddccaa16dd2809bcc3b6856f24c3>`_

[BUGFIX] Correctly define relations as not nullable
-----------------------------------------------------------------------------------------

Some required relations between media objects where not defined
as not nullable which lead doctrine to create additional migrations
for them to allow NULL values.
This changes fixes that by adding the correct annotations.

Resolves: NEOS-978

* Commit: `e7977dd <https://git.typo3.org/Packages/TYPO3.Media.git/commit/e7977ddb57d2bbcfa0386cf6379164ea9aa1b45b>`_

[BUGFIX] Order image adjustments before applying them
-----------------------------------------------------------------------------------------

This change sorts adjustments by classname, to avoid resize being done
before crop - which would break, if the image is resized to be smaller
and the crop area start coordinates would end up outside the bounding
box.

This is a quick fix, a proper solution for adjustment precedence needs
to be found and implemented.

* Commit: `b6b0d1f <https://git.typo3.org/Packages/TYPO3.Media.git/commit/b6b0d1f56a436cf0f7c6da64672ac1c57dc420f9>`_

[BUGFIX] Correctly set persistence identifier on adjustments
-----------------------------------------------------------------------------------------

When converting from array with the persistence identifier being set,
the identifier was set incorrect on created adjustments, to a property
named persistence_object_identitifer. This changes corrects that.

* Commit: `3190e95 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/3190e95edf66c8d190ec8370bc2d1bf3883dc87f>`_

[BUGFIX] Inject missing class property to ImageInterfaceConverter
-----------------------------------------------------------------------------------------

If old processing instructions on an ImageVariant are encountered, they
are to be converted to adjustments. The converted used to do this must
actually be injected for this to work, though.

* Commit: `d657e46 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/d657e46854b5957910b6136efd99683961280c0f>`_

[TASK] Use unicode-safe pathinfo() function in ImageService
-----------------------------------------------------------------------------------------

``pathinfo()`` function is not unicode-friendly, thus ImageService
destroys non-Latin characters in filename of resized resource.

Related: FLOW-101

* Commit: `b60ecc1 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/b60ecc1f34a0e1a64fcf7c01174bd9d5762f2879>`_

[BUGFIX] Asset identifier should be property mapped
-----------------------------------------------------------------------------------------

Asset identifier are now exposed when converting assets to
arrays and also taken into account and set when converting
from array to Asset.

This is important for integrity of imports/exports of Assets.

* Commit: `5b36e7b <https://git.typo3.org/Packages/TYPO3.Media.git/commit/5b36e7b8b7bcb3cc8ab87cc2310bebad6c90c578>`_

[BUGFIX] Adjustment conversion should follow normal formats
-----------------------------------------------------------------------------------------

* Commit: `2db3ebc <https://git.typo3.org/Packages/TYPO3.Media.git/commit/2db3ebc95c976e072e1b91b6ce548aaefeffb926>`_

[BUGFIX] ArrayConverter should be used by default
-----------------------------------------------------------------------------------------

The ``ImageInterfaceArrayPresenter`` used for generating basic
information for an Image was used instead of the ArrayConverter
in some instances. This should be avoided as the ArrayPresenter
is just for specific cases that need limited information.

* Commit: `7e0a96e <https://git.typo3.org/Packages/TYPO3.Media.git/commit/7e0a96ea81bc1dc7169c41b220b861bd5e2e3113>`_

[BUGFIX] ratio mode has wrong type on PostgreSQL
-----------------------------------------------------------------------------------------

The ratio mode column was integer in the beginning, but must hold string
values. This was fixed in the MySQL migration before the change was
merged; this change fixes it for PostgreSQL.

See https://review.typo3.org/24484 for the origin of this issue.

Related: NEOS-639

* Commit: `163f2da <https://git.typo3.org/Packages/TYPO3.Media.git/commit/163f2da4319e7d11282e19cb2dfdfb47e24b8adb>`_

[BUGFIX] importResourcesCommand uses removed DB column
-----------------------------------------------------------------------------------------

The "fileextension" column on the Flow Resource object has been removed.
But "mediatype" has been added and ResourcePointer should no longer
be used.

Additionally ``Resources`` of  ``Thumbnail`` objects should not
be imported.

* Commit: `1e9f75a <https://git.typo3.org/Packages/TYPO3.Media.git/commit/1e9f75a7fab19e5f3b87e4f11bf19c1dd7bff9d2>`_

[TASK] Tweak some type hints
-----------------------------------------------------------------------------------------

* Commit: `63245a0 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/63245a0d9127478e1b8ae58dfe952ba822f606c7>`_

[TASK] Use same resource collection as parent resource
-----------------------------------------------------------------------------------------

The ImageService that creates Resource objects for ImageVariants
and Thumbnails should store them in the same collection than
the parent resource is stored in.

* Commit: `dd564dd <https://git.typo3.org/Packages/TYPO3.Media.git/commit/dd564dd61c466e1ae05b604f24d6df6281af3749>`_

[BUGFIX] Fix broken thumbnail query
-----------------------------------------------------------------------------------------

Regression from I00dbf4309b14561797f8bcad4d069a9e2e6c1de9

* Commit: `af5c6f8 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/af5c6f81522fb492ac0f99688acb644c9321e0b4>`_

[BUGFIX] ThumbnailRepository should not throw exceptions
-----------------------------------------------------------------------------------------

The method ``findOneByAssetAndDimensions`` should query with
a limit so no exception is raised even if there should be
multiple results for the given arguments. Additionally the
ratioMode of the thumbnail is considered now.

Resolves: NEOS-818

* Commit: `9399101 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/93991019dd516a9b15922800198ee2088f5bc9ce>`_

[TASK] Use getQueryBuilder in AssetRepository
-----------------------------------------------------------------------------------------

Simply use the public getter instead of ObjectAccess, now that we can.

* Commit: `b70179e <https://git.typo3.org/Packages/TYPO3.Media.git/commit/b70179e3beafa6cdad321915211fc8e0ca9b228f>`_

[!!!][TASK] Move ImageTag and ImageUri TypoScript objects to TYPO3.Neos
-----------------------------------------------------------------------------------------

This moves the ImageTag and ImageUri TypoScript objects to the Neos
package to avoid a dependency on TypoScript in TYPO3.Media.

This is breaking if you already used the newly introduced objects,
in that case you have to replace ``TYPO3.Media`` with ``TYPO3.Neos``.

Fixes: NEOS-745

* Commit: `6690778 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/66907789e7367caf13ece99289b8ec08f05e0067>`_

[BUGFIX] Uri image view helper broken
-----------------------------------------------------------------------------------------

Ieaaf6fa166d13c7cd0177ec381b4e74e2923c2ce introduced a regression,
where the uri image view helper is using an undefined method in
the asset service.

Related: NEOS-639

* Commit: `c04f900 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/c04f90032ccea0c9fd7faa910f80628c3f598f4e>`_

[!!!][FEATURE] A whole new media management
-----------------------------------------------------------------------------------------

A new API and mechanism, based on the new Flow resource
management.

Resolves: NEOS-639
Related: FLOW-108

* Commit: `9030a68 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/9030a68150d0e4e8e9aea218c56d4db23c8bbb0c>`_

[BUGFIX] Fix name of ManageAssets privilege target
-----------------------------------------------------------------------------------------

* Commit: `f1e51ea <https://git.typo3.org/Packages/TYPO3.Media.git/commit/f1e51ea2bab01ed815707a31d6399b037248b0f2>`_

[TASK] Mark migrations as merged
-----------------------------------------------------------------------------------------

This commit marks some migrations as merged that are not needed on this
package. This speeds up core:migrate and avoids potential errors.

* Commit: `b4bfc70 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/b4bfc701d5be1f5434cfb9dfd497c8cea61669c0>`_

[TASK] Adjust to acl changes in Flow
-----------------------------------------------------------------------------------------

Related: FLOW-11

* Commit: `c5f648d <https://git.typo3.org/Packages/TYPO3.Media.git/commit/c5f648d65127aea3c99b63b7e3ee35821d9c2b26>`_

[FEATURE] ImageTag and ImageUri TypoScript objects
-----------------------------------------------------------------------------------------

Extracts some duplicate code into the ImageViewService and provides
TypoScript counterparts of the image and uri.image view helpers.

``ImageTag`` example::

  # Create an img tag with alt attribute for 100*100 cropped image
  exampleImageTag = TYPO3.Media:ImageTag {
  	asset = ${q(node).property('image')}
  	maximumWidth = 100
  	maximumHeight = 100
  	allowCropping = TRUE
  	allowUpScaling = TRUE
  	attributes.alt = 'Do not forget the alt text'
  }

``ImageUri`` example::

  # Create an image URI for 100*100 cropped image
  exampleImageUri = TYPO3.Media:ImageUri {
  	asset = ${q(node).property('image')}
  	maximumWidth = 100
  	maximumHeight = 100
  	allowCropping = TRUE
  	allowUpScaling = TRUE
  }

Resolves: NEOS-491

* Commit: `477d20b <https://git.typo3.org/Packages/TYPO3.Media.git/commit/477d20b63ceb867d90bac7f247c63ef3dbe46e25>`_

[TASK] Throw correct exceptions in view helpers
-----------------------------------------------------------------------------------------

Throw actual view helper exceptions so Fluid
can handle them properly.

Additionally adds missing unique exception codes.

* Commit: `3968aac <https://git.typo3.org/Packages/TYPO3.Media.git/commit/3968aac67dce366221a76b2b11163e6f67bc3838>`_

[TASK] Optimize the asset repository's countByTag method
-----------------------------------------------------------------------------------------

Optimizes the count by tag query by a factor 400-500% by not joining all
the subtype tables and tag table on, which doctrines does on its own.

This is needed because when having lots of tags results in long load
times for all media browser views where all the tags are displayed.
This is due to the count for each tag takes quite some time (16-30 ms),
which is a lot when multiplied by 100+.

Fixes: NEOS-642

* Commit: `d338bbd <https://git.typo3.org/Packages/TYPO3.Media.git/commit/d338bbd6819a202a13355ea5ae62000732b1c857>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.NeosDemoTypo3Org
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Require ~1.0 of TYPO3.Neos.Seo
-----------------------------------------------------------------------------------------

Related: NEOS-1243

* Commit: `a2f1adb <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/a2f1adb6e0630830f4cfaa05c5313fef56767d43>`_

[TASK] Adjust node type config to new super type configuration format
-----------------------------------------------------------------------------------------

Depends: I6b5c89f5c88339db99f4a81c5e6b74ec5e7ceee9

Related: NEOS-1253

* Commit: `8f516b1 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/8f516b1fb3a9e70e94dd7af13dc02e7bcc2a6bba>`_

[TASK] Constraint carousel item possibilities
-----------------------------------------------------------------------------------------

Limits the possible content elements that can be inserted into carousel
elements.

* Commit: `74fb772 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/74fb7729d14bc4c09bf21619c52e48b61ba05234>`_

[TASK] New frontpage splash image & introduction headline
-----------------------------------------------------------------------------------------

Replaces the splash image on the frontpage with a new one together
with a new introduction headline for the upcoming release.

* Commit: `cb5a6ff <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/cb5a6ffa491992346466cdb0d03b1c95b6e8217d>`_

[TASK] New Demo site export
-----------------------------------------------------------------------------------------

This is a fresh export of the demo site for 2.0 with adjusted resources
and Sites.xml with lowercase paths.

Releaes: 2.0

* Commit: `2b10238 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/2b1023857a1d609c5c40f7a6fe6d42913a3b0458>`_

[BUGFIX] ContentCollection iterator has a different TypoScript
-----------------------------------------------------------------------------------------

The change `I06ba604f562685e3a1d5ee844a8adaec7eda20f5` introduced a
backwards incompatible change to the TypoScript paths of
`ContentCollections`. Before it was possible to set the
`iterationName` directly on the `ContentCollection`. With the newly
introduced `TYPO3.Neos:ContentCollectionRenderer` the path for this
moved to `content.iterationName` breaking the image carousel example
on the demo site.

* Commit: `faad3b2 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/faad3b2e02653c8bf9665be530d14bdae2158e32>`_

[TASK] Adjust dependencies for the 2.0 branch
-----------------------------------------------------------------------------------------

* Commit: `6f224b2 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/6f224b25b0775fef6f7391f0f3cc4a05c2f80940>`_

[TASK] Pin Flowpack.Neos.FrontendLogin to 1.x
-----------------------------------------------------------------------------------------

This adjusts the composer dependency to the
``flowpack/neos-frontendlogin`` package by specifying a version number.

Related: NEOS-433

* Commit: `6055a9e <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/6055a9ef6ab1da221e026651c9fd4a9cd9095995>`_

[FEATURE] Frontend Login
-----------------------------------------------------------------------------------------

This adds a simple *Frontend User Login* form to the site demonstrating
the advanced security features introduced with Neos 2.0.

This adds a dependency to the ``flowpack/neos-frontendlogin`` composer
package that comes with two plugins:

* ``Flowpack.Neos.FrontendLogin:LoginForm`` serving both, a *login*
  form for anonymous users and a *logout* form for authenticated
  Frontend Users
* ``Flowpack.Neos.FrontendLogin:Profile`` posing a very basic way to
  allow users to change their details

Note: There is no technical difference between the "Backend User" that
can login to Neos and a "Frontend User" that is usually a visitor of
your Website. But for the sake of simplicity the FE Login plugin comes
with a dedicated role ``Flowpack.Neos.FrontendLogin:User`` that will
make it easier to distinguish the two cases.

To create a "Frontend User" you can use the provided command:

  ./flow frontenduser:create <username> <password> <first-name> <last-name>

Resolves: NEOS-433

* Commit: `c08ed55 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/c08ed550b5d54729deb79c369b96b8eb97b0701b>`_

[TASK] Update exported site
-----------------------------------------------------------------------------------------

This is an export done on latest master after a clean setup and running
node:repair.

Timestamps are removed since to ensure new dates when imported.

Additionally it's output with the ``tidy`` option to track actual
changes of the export in the future.

Also fixes the issue with unwrapped text paragraphs that trigger a save
on the first click.

* Commit: `991e716 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/991e716589334a815907619fe21e8117bec433b8>`_

[TASK] Remove blank line in Root.ts2
-----------------------------------------------------------------------------------------

* Commit: `9733920 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/9733920877b1da115c1028b76fa602ae1b3aa74d>`_

[TASK] Mark recent core migrations applied
-----------------------------------------------------------------------------------------

This commit doesn't contain any changes, it simply marks recent
migrations applied so that::

  ./flow flow:core:migrate --status

won't show any open migrations for this package.

* Commit: `318ed78 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/318ed783d6f7dd638f09a1ebeb6fcc84d1ee280a>`_

[!!!][TASK] Add charset and collation to all MySQL migrations
-----------------------------------------------------------------------------------------

This change set adds charset and collation to create table statements
in the existing migrations. This make sure the tables are set up
correctly independent of the database default configuration.

Also migrations generated contain this information since a while,
leading to problems on migration if the database is not using the same
charset and collation.

This is breaking if you have existing tables that do not use the utf8
charset and utf8_unicode_ci collation. To solve this you need to convert
the existing tables. This can be done using the command::

  ./flow database:setcharset

Related: NEOS-800

* Commit: `5d1d12e <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/5d1d12eb6cc3a2fe99503779eb29d7ba57f564a4>`_

[BUGFIX] Language selector broken in iOS Safari (touch)
-----------------------------------------------------------------------------------------

Due to the language selector relying on hover state for displaying,
it's not working on iOS Safari. This can be solved by using the pointer
cursor.

Fixes: NEOS-971

* Commit: `f1a94f7 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/f1a94f78e3adcf0d378fda3f941ae666b7f79eb0>`_

[BUGFIX] Link on logo should be to home
-----------------------------------------------------------------------------------------

The link on the Neos logo is supposed to go to the home page.
In the template a link to the variable ``site`` is created, but
as this variable is never set the link is to the current page.
This change adds the variable to the template, fixing the link.

* Commit: `5afddca <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/5afddca0cb45de18326b743031172debc12f6371>`_

[TASK] Follow-up to "Apply migration TYPO3.Neos-20141212183900"
-----------------------------------------------------------------------------------------

This is a follow-up to I4c4c3931d14073298a9a2e397159ef7763892ad0 that
failed to adjust the "chapterImage" property of the Chapter node type.

Related: NEOS-883

* Commit: `d571bf9 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/d571bf9292162d9fbd64efe187661f35755e0d67>`_

[TASK] Mark recent code migrations applied
-----------------------------------------------------------------------------------------

This just marks recent migrations executed in order to prevent them
from being executed again when running the ``./flow core:migrate``
command.

* Commit: `d50559a <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/d50559ab7dfd5480d39aecb28536efb14fc4af98>`_

[TASK] Apply migration TYPO3.Neos-20141212183900
-----------------------------------------------------------------------------------------

This commit contains the result of applying migration
TYPO3.Neos-20141212183900 to this package.

Resolves: NEOS-883

* Commit: `23f8792 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/23f87927a670501986ff9798c5ef628ffce4fd21>`_

[TASK] Remove unnecessary TypoScript for main menu
-----------------------------------------------------------------------------------------

* Commit: `89f1356 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/89f1356e2f0280dfcadd2f4f711c9cdc2b34f1ef>`_

[TASK] Translate homepage header in available languages
-----------------------------------------------------------------------------------------

Related: NEOS-1

* Commit: `80a1e62 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/80a1e622fea939aac92d9e67f0793d5e824ada79>`_

[FEATURE] Full width & height banner image
-----------------------------------------------------------------------------------------

- Add the possibility to insert full width & height banner images
- Update site export with default banner image for root page
- Change background color of header area
- Fixes issues with 768px widths (broken menu)
- Makes sure all navigation items fits in one line
- Make the header more transparent

Resolves: NEOS-846

* Commit: `3b1957d <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/3b1957d091b2663f024522af00493dba350fc99f>`_

[TASK] List styles for different Aloha list types
-----------------------------------------------------------------------------------------

Resolves: NEOS-854

* Commit: `90e3c0b <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/90e3c0b9e21ee4022f3c7a64cb549594e9b7945e>`_

Revert "Revert [TASK] Remove title tag rendering customization"
-----------------------------------------------------------------------------------------

Package is now available via packagist, so the dependency can go in.

This reverts commit 100d6ceb86b1e1168e49d40f250058240073691a.

* Commit: `f19725a <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/f19725aba6dbf4a5b436b9bac71a0c0338e423cc>`_

Revert "[TASK] Remove title tag rendering customization"
-----------------------------------------------------------------------------------------

This reverts commit 9a0e1be6e64aa2a175a8f03646d0d2eb66b85428.
The commit adds a depdendency on TYPO3.Neos.Seo which is not
yet available via composer, until then this commit shouldnt be merged.

* Commit: `100d6ce <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/100d6ceb86b1e1168e49d40f250058240073691a>`_

[TASK] Remove title tag rendering customization
-----------------------------------------------------------------------------------------

This is now the default rendering when using TYPO3.Neos.Seo.

Related: NEOS-707

* Commit: `9a0e1be <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/9a0e1be6e64aa2a175a8f03646d0d2eb66b85428>`_

[TASK] Adjust to new Resource management
-----------------------------------------------------------------------------------------

Related: FLOW-108

* Commit: `c6daa5b <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/c6daa5bb25bca132275610559e8fe682f1c508dd>`_

[BUGFIX] Fix position of menu node on "Shortcuts" page
-----------------------------------------------------------------------------------------

This is a follow-up to the previous commit
I4786908d68f99050a7a7f935e7c02b472c07f3f3 that fixes the positioning of
the shortcut menu on the "Shortcuts" page

Related: NEOS-564

* Commit: `c78c6f9 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/c78c6f9d89dab2c050c96a5cf59cf4871ef44586>`_

[TASK] Add examples for the different shortcut node types
-----------------------------------------------------------------------------------------

Renames the page "Shortcut" to "Shortcuts" and adds four sub-nodes
of the currently supported shortcut node types:

* Shortcut to first child node
* Shortcut to parent node
* Shortcut to selected target
* Shortcut to external URI

Related: NEOS-564

* Commit: `dc8a355 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/dc8a35550219814cfbf6d3f38463ac599e12edd6>`_

[TASK] Partly revert recent migrations
-----------------------------------------------------------------------------------------

In I8da1b6d0e8593af127dc2c18ea35e46e9ec90896 some changes were applied
that are not needed and make things harder to read.

* Commit: `584ad70 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/584ad70643bf3660ef509f693ec694e16a10bf64>`_

[TASK] Styling adjustments to language menu
-----------------------------------------------------------------------------------------

* Commit: `dc6eafa <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/dc6eafa934326890f97f0abcbad1bc90bfc23b84>`_

[FEATURE] Language menu
-----------------------------------------------------------------------------------------

* Commit: `2df76db <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/2df76dbeaa4807fd8efc29b68c3e431eeaa7b629>`_

[TASK] Apply recent migrations
-----------------------------------------------------------------------------------------

This applies following code migrations to the demo site:

* TYPO3.Flow-201212051340

   Change entity resource definitions from using _ to \\

* TYPO3.TYPO3CR-130523180140

   Adjust to removed TYPO3.TYPO3CR:Folder node type by replacing it
   with unstructured. In a Neos context, you probably want to replace
   it with TYPO3.Neos:Document instead!

* TYPO3.Flow-20141113121400

   Adjust "Policy.yaml" to new syntax

* Commit: `d5bbdcf <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/d5bbdcfa57743d2a46e1090adf586152c2ff2b83>`_

[TASK] Re-export Sites.xml with tidy option
-----------------------------------------------------------------------------------------

This simply is a re-export of the site using the --tidy option to keep
the XML more readable.

This got lost with change I862b2b21e7a3da5cb07f825959e02cd08232fea1.

Also some unused resources are removed.

* Commit: `6731c96 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/6731c96212e075142acadfe81b094964b7cfb642>`_

[BUGFIX] disable language fallbacks for most languages on demo site
-----------------------------------------------------------------------------------------

Now as NEOS-633 is merged, we can disable the language fallbacks to
combinations which do not make sense.

Related: NEOS-633

* Commit: `d48666b <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/d48666b312e834118bccb91602d3c069a3b62232>`_

[TASK] Simplify NodeTypes TS inclusion
-----------------------------------------------------------------------------------------

Uses the new TS include globbing to simplify the inclusion of the
NodeTypes TS files.

Related: NEOS-440

* Commit: `65048c3 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/65048c311d74aa0a89b47cf44bde1271d6532dd0>`_

[FEATURE] Turn into a multi-lingual website
-----------------------------------------------------------------------------------------

This configures a "language" content dimension with some presets and
includes an updated Sites.xml export. The translation of the actual
content will be part of a separate change.

As Neos 1.2 will only support fallback based translation, all languages
are based on a default "en_US" language.

Resolves: NEOS-168

* Commit: `76c7ea4 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/76c7ea4dd4e4bdc15554d553733fa9ac00ebcbda>`_

[TASK] Adjust to layout properties change
-----------------------------------------------------------------------------------------

* Commit: `b1038d8 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/b1038d88c55776589bfea2f3866e9b1287ae5517>`_

[TASK] Migrate Sites.xml to translatable URIs
-----------------------------------------------------------------------------------------

Updated the Sites.xml dump using the "node:repair" command.

Related: NEOS-296

* Commit: `c0f5175 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/c0f5175acc2cf34676dcb567adaad2ec412c179c>`_

[TASK] Adapt after the NodeInterface::getFullLabel removal
-----------------------------------------------------------------------------------------

Related: NEOS-441

* Commit: `3d020e5 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/3d020e5a50b86c62780fb564af1fe2e4d3a4457a>`_

