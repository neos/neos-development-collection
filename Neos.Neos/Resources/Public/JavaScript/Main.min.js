(()=>{"use strict";class DropDownMenu{constructor(e){this._root=e,this._button=this._root.querySelectorAll(".neos-dropdown-toggle"),this._menu=this._root.querySelectorAll(".neos-dropdown-menu"),this._setupEventListeners()}_setupEventListeners(){this._button.forEach((e=>{e.addEventListener("click",this._toggle.bind(this))}))}_toggle(e){this._changeToogleIcon(),this._root.classList.toggle("neos-dropdown-open")}_changeToogleIcon(){const e=this._root.querySelector(".fa-chevron-down"),t=this._root.querySelector(".fa-chevron-up");e&&e.classList.replace("fa-chevron-down","fa-chevron-up"),t&&t.classList.replace("fa-chevron-up","fa-chevron-down")}}class Expandable{constructor(e,t,s,o){this._root=e,this._trigger=this._root.querySelectorAll(t),this._onStateChange=s,this._setupEventListeners(),this._initialize(o)}_setupEventListeners(){this._trigger.forEach((e=>{e.addEventListener("click",this._toggle.bind(this))}))}_initialize(e){this._root.querySelector("[aria-expanded]").setAttribute("aria-expanded",String(e)),e&&(this._root.classList.add("neos-open"),this._changeToogleIcon())}_toggle(){this._changeToogleIcon(),this._root.classList.toggle("neos-open"),this._toogleAriaExpandable()}_toogleAriaExpandable(){const e=this._root.querySelector("[aria-expanded]"),t=this._root.classList.contains("neos-open");if(e.setAttribute("aria-expanded",String(t)),"function"==typeof this._onStateChange){const e=this._root.getAttribute("data-key");this._onStateChange(e,t)}}_changeToogleIcon(){const e=this._root.querySelector(".fa-chevron-circle-down"),t=this._root.querySelector(".fa-chevron-circle-up");e&&e.classList.replace("fa-chevron-circle-down","fa-chevron-circle-up"),t&&t.classList.replace("fa-chevron-circle-up","fa-chevron-circle-down")}}const Helper_isNil=e=>null==e,Helper_getCollectionValueByPath=(e,t)=>Helper_isNil(e)?null:t.split(".").reduce(((e,t)=>Helper_isNil(e)?null:e[t]),e),Helper_createCollectionByPath=(e,t,s)=>{e="object"==typeof e?e:{};const o=Array.isArray(t)?t:t.split(".");let n=e;for(let e=0;e<o.length-1;e++){const t=o[e];if(!n[t]&&!Object.prototype.hasOwnProperty.call(n,t)){const s=o[e+1],r=/^\+?(0|[1-9]\d*)$/.test(s);n[t]=r?[]:{}}n=n[t]}return n[o[o.length-1]]=s,e},e="persistedState",getStorage=()=>{const t=localStorage.getItem(e),s=JSON.parse(t);return Helper_isNil(s)?{}:s},loadStorageData=e=>{const t=getStorage();return Helper_getCollectionValueByPath(t,e)},saveStorageData=(t,s)=>{const o=getStorage(),n=Helper_createCollectionByPath(o,t,s);Helper_isNil(n)||localStorage.setItem(e,JSON.stringify(n))},t="ui.drawer.collapsedMenuGroups";class MenuPanel{constructor(e){this._root=e,this._button=this._root.querySelectorAll(".neos-menu-button"),this._panel=this._root.querySelectorAll(".neos-menu-panel"),this._menuSectionStates=this._loadMenuSectionStates(),this._setupEventListeners(),this._panel&&this._initializeMenuSections()}_initializeMenuSections(){this._panel.forEach((e=>{const t=e.querySelectorAll(".neos-menu-section"),s=this._menuSectionStates;t.forEach((e=>{const t=e.getAttribute("data-key"),o=!s.includes(t);new Expandable(e,".neos-menu-panel-toggle",this._onMenuSectionStateChange.bind(this),o)}))}))}_setupEventListeners(){this._button.forEach((e=>{e.addEventListener("click",this._toggle.bind(this))}))}_loadMenuSectionStates(){const e=loadStorageData(t);return Array.isArray(e)?e:[]}_saveMenuSectionStates(){Array.isArray(this._menuSectionStates)&&saveStorageData(t,this._menuSectionStates)}_onMenuSectionStateChange(e,t){this._menuSectionStates.includes(e)&&!0===t&&(this._menuSectionStates=this._menuSectionStates.filter((t=>t!==e))),this._menuSectionStates.includes(e)||!1!==t||this._menuSectionStates.push(e),this._saveMenuSectionStates()}_toggle(e){this._button.forEach((e=>{e.classList.toggle("neos-pressed")})),document.body.classList.toggle("neos-menu-panel-open")}}const Helper_isEmpty=e=>!Helper_isNil(e)&&(!Object.getOwnPropertySymbols(e).length&&!Object.getOwnPropertyNames(e).length);class Tree{constructor(e){this._root=e,this._type=this._root.getAttribute("data-type"),this._treeBranchStates=this._loadTreeBranchStates(!0),this._nodes=this._root.querySelectorAll(".neos-tree-node"),this._initializeTree(),this._setupEventListeners()}_initializeTree(){this._nodes.forEach((e=>{"ul"!==e.firstChild.nodeName.toLowerCase()&&this._wrapElementWithNodeTitle(e.firstChild);const t=e.querySelectorAll(".neos-tree-node");if(this._isFolder(e)&&!Helper_isNil(t)&&t.length>0){const t=this._createExpandIcon();e.insertBefore(t,e.firstChild)}}))}_initializeTreeState(e){Array.isArray(e)&&e.forEach((e=>{const t=this._root.querySelector(`[title="${e}"`);Helper_isNil(t)||t.classList.add("neos-tree-open")}))}_setupEventListeners(){this._nodes.forEach((e=>{e.addEventListener("click",this._onNodeClick.bind(this))}))}_onNodeClick(e){e.preventDefault(),e.stopPropagation();const t=e.target.closest(".neos-tree-node");Helper_isNil(t)||(this._deselectCurrentActiveNode(),t.classList.toggle("neos-tree-active")),this._isFolder(t)&&this._toggle(t)}_deselectCurrentActiveNode(){this._root.querySelectorAll(".neos-tree-active").forEach((e=>{e.classList.remove("neos-tree-active")}))}_createExpandIcon(){const e=document.createElement("span");return e.classList.add("neos-tree-expander"),e}_wrapElementWithNodeTitle(e){const t=document.createElement("span");t.classList.add("neos-tree-title"),e.parentNode.insertBefore(t,e),t.appendChild(e)}_isFolder(e){return!Helper_isNil(e)&&e.classList.contains("neos-tree-folder")}_toggle(e){e.classList.toggle("neos-tree-open"),this._changeTreeBranchState(e.getAttribute("title"),e.classList.contains("neos-tree-open"))}_getPathForType(){return("module.configuration"+(Helper_isEmpty(this._type)?"":"."+this._type)).toLowerCase()}_loadTreeBranchStates(e){const t=this._getPathForType(),s=loadStorageData(t);return Helper_isNil(e)||!0!==e||this._initializeTreeState(s),this._treeBranchStates=Array.isArray(s)?s:[],this._treeBranchStates}_saveTreeBranchStates(){const e=this._getPathForType();Array.isArray(this._treeBranchStates)&&saveStorageData(e,this._treeBranchStates)}_changeTreeBranchState(e){!Helper_isEmpty(e)&&Array.isArray(this._treeBranchStates)&&(this._treeBranchStates.includes(e)?this._treeBranchStates=this._treeBranchStates.filter((t=>t!==e)):this._treeBranchStates.push(e),this._saveTreeBranchStates())}}document.querySelectorAll(".neos-user-menu").forEach((e=>{new DropDownMenu(e)}));document.querySelectorAll(".neos-menu").forEach((e=>{new MenuPanel(e)}));document.querySelectorAll(".neos-tree-container").forEach((e=>{new Tree(e)}))})();